[replace_code]
<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ulus SimÃ¼latÃ¶rÃ¼</title>
    <style>
        :root {
            --bg-color: #ecf0f1;
            --container-bg: #fff;
            --text-color: #2c3e50;
            --primary-color: #3498db;
            --secondary-color: #1abc9c;
            --danger-color: #e74c3c;
            --warning-color: #f39c12;
            --success-color: #2ecc71;
            --panel-bg: #f5f7fa;
            --border-color: #dfe4ea;
            --accent-color: #5D5CDE;
            --header-color: #1abc9c;
            --input-bg: #ecf0f1;
            --tab-active-color: #5D5CDE;
        }

        .dark {
            --bg-color: #181818;
            --container-bg: #2c3e50;
            --text-color: #ecf0f1;
            --primary-color: #5D5CDE;
            --secondary-color: #1abc9c;
            --danger-color: #e74c3c;
            --warning-color: #f39c12;
            --success-color: #2ecc71;
            --panel-bg: #34495e;
            --border-color: #4e6a83;
            --header-color: #1abc9c;
            --input-bg: #4e6a83;
            --tab-active-color: #5D5CDE;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            box-sizing: border-box;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        .game-container {
            background-color: var(--container-bg);
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            padding: 20px;
            width: 95%;
            max-width: 1200px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            transition: background-color 0.3s ease;
        }

        h1 {
            text-align: center;
            color: var(--header-color);
            margin-bottom: 20px;
        }

        /* Sekme Navigasyonu */
        .tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 10px;
            gap: 10px; /* Sekmeler arasÄ± boÅŸluk */
            flex-wrap: wrap; /* KÃ¼Ã§Ã¼k ekranlarda sarmalama */
        }

        .tab-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 5px 5px 0 0; /* Ãœst kÃ¶ÅŸeleri yuvarlak */
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.2s ease, transform 0.1s ease;
            flex-grow: 1; /* Esnek bÃ¼yÃ¼me */
            min-width: 120px; /* Minimum geniÅŸlik */
        }

        @media (max-width: 768px) {
            .tab-btn {
                min-width: 90px;
                padding: 10px 12px;
                font-size: 0.9em;
            }
        }

        .tab-btn:hover {
            background-color: var(--primary-color);
            opacity: 0.9;
            transform: translateY(-2px); /* Hafif yukarÄ± kalkma efekti */
        }

        .tab-btn.active {
            background-color: var(--tab-active-color); /* Aktif sekme rengi */
            font-weight: bold;
            border-bottom: 2px solid var(--tab-active-color); /* Aktif sekmede alt Ã§izgi */
            transform: translateY(0); /* Sabit konum */
        }

        /* TÃ¼m ekranlarÄ± gizle */
        .game-screen {
            display: none;
            background-color: var(--container-bg); /* TÃ¼m ekranlar iÃ§in ortak arka plan */
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            min-height: 500px; /* Ekranlar arasÄ± boÅŸluÄŸu korumak iÃ§in */
            overflow-y: auto; /* Ä°Ã§erik taÅŸarsa kaydÄ±rma */
        }

        /* Ana oyun ekranÄ±nÄ±n dÃ¼zenini korumak iÃ§in */
        #main-screen {
            display: grid; /* Flexbox ile ana konteyneri yÃ¶nettik, iÃ§ini grid ile */
            grid-template-columns: 1fr 1.5fr;
            grid-template-rows: auto 1fr; /* Ä°statistikler ve eylemler Ã¼stte, log ve canvas altta */
            gap: 20px;
            grid-template-areas:
                "stats actions"
                "log canvas";
        }

        @media (max-width: 768px) {
            #main-screen {
                grid-template-columns: 1fr;
                grid-template-areas:
                    "stats"
                    "actions"
                    "log"
                    "canvas";
            }

            .game-container {
                padding: 15px;
                width: 98%;
            }
        }

        #main-screen.active {
            display: grid;
        }

        .stats-panel {
            grid-area: stats;
            background-color: var(--panel-bg);
            padding: 20px;
            border-radius: 6px;
            border-left: 5px solid var(--secondary-color);
        }

        .stats-panel p {
            margin: 10px 0;
            font-size: 1.1em;
        }

        .stats-panel span {
            font-weight: bold;
            color: var(--text-color);
        }

        .actions-panel {
            grid-area: actions;
            background-color: var(--panel-bg);
            padding: 20px;
            border-radius: 6px;
            border-left: 5px solid var(--warning-color);
        }

        .actions-panel h2 {
            color: var(--warning-color);
            margin-top: 0;
            margin-bottom: 15px;
        }

        .action-category {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px dashed var(--border-color);
        }

        .action-category:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }

        .action-category h3 {
            color: var(--warning-color);
            margin-top: 0;
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 15px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.95em;
            transition: background-color 0.2s ease;
        }

        button:hover {
            background-color: var(--primary-color);
            opacity: 0.9;
        }

        button:disabled {
            background-color: #7f8c8d;
            cursor: not-allowed;
            opacity: 0.7;
        }

        .log-panel {
            grid-area: log;
            background-color: var(--panel-bg);
            padding: 20px;
            border-radius: 6px;
            border-left: 5px solid #9b59b6;
            overflow-y: auto;
            max-height: 300px; /* Log paneli iÃ§in maksimum yÃ¼kseklik */
        }

        .log-panel h2 {
            color: #9b59b6;
            margin-top: 0;
            margin-bottom: 15px;
        }

        #game-log {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        #game-log li {
            background-color: var(--container-bg);
            padding: 8px 12px;
            margin-bottom: 5px;
            border-radius: 4px;
            font-size: 0.9em;
        }

        #gameCanvas {
            grid-area: canvas;
            background-color: var(--panel-bg);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            width: 100%;
            height: 300px; /* Canvas boyutu */
        }

        /* Yeni EkranlarÄ±n Genel Stili */
        .game-screen h2 {
            color: var(--warning-color); /* SarÄ±msÄ± baÅŸlÄ±k rengi */
            margin-bottom: 20px;
            text-align: center;
        }

        .game-screen ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .game-screen li {
            background-color: var(--panel-bg);
            padding: 10px 15px;
            margin-bottom: 8px;
            border-radius: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 1.05em;
        }
         .game-screen li div { /* ButonlarÄ± saÄŸa yaslamak iÃ§in */
            display: flex;
            gap: 5px;
            flex-wrap: wrap; /* Butonlar sÄ±ÄŸmazsa alt satÄ±ra geÃ§sin */
        }


        .game-screen .cabinet-actions,
        .game-screen .parliament-propose,
        .game-screen .security-actions,
        .game-screen .foreign-actions,
        .game-screen .opposition-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
            justify-content: center; /* ButonlarÄ± ortala */
            margin-bottom: 15px;
        }


        .game-screen input[type="text"],
        .game-screen input[type="number"],
        .game-screen select {
            padding: 10px;
            border-radius: 5px;
            border: 1px solid var(--border-color);
            background-color: var(--input-bg);
            color: var(--text-color);
            font-size: 1em;
            flex-grow: 1;
            min-width: 150px;
        }

        .game-screen .parliament-note,
        .game-screen .security-note {
            font-style: italic;
            font-size: 0.9em;
            color: #bdc3c7;
            margin-top: 10px;
            text-align: center;
        }

        /* Oyun Sonu EkranÄ± */
        #game-over-screen {
            display: flex; /* Flexbox ile ortalama */
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            min-height: 500px;
        }

        #game-over-screen h1 {
            color: var(--danger-color);
            margin-bottom: 20px;
        }

        #game-over-screen p {
            font-size: 1.2em;
            margin-bottom: 10px;
        }

        #game-over-screen button {
            background-color: var(--danger-color);
            padding: 15px 30px;
            font-size: 1.2em;
            margin-top: 30px;
        }

        #game-over-screen button:hover {
            background-color: var(--danger-color);
            opacity: 0.9;
        }

        /* Meclis Action butonlarÄ± */
        .parliament-action-btn {
            padding: 8px 12px;
            margin-left: 5px;
            font-size: 0.85em;
        }

        .parliament-action-btn[data-action="approve"] {
            background-color: var(--success-color);
        }
        .parliament-action-btn[data-action="approve"]:hover {
            background-color: var(--success-color);
            opacity: 0.9;
        }
        .parliament-action-btn[data-action="reject"] {
            background-color: var(--danger-color);
        }
        .parliament-action-btn[data-action="reject"]:hover {
            background-color: var(--danger-color);
            opacity: 0.9;
        }

        /* DÄ±ÅŸ Ä°liÅŸkiler listesi */
        #country-relations-list button, #summit-invitation-list button {
            padding: 6px 10px;
            font-size: 0.8em;
            margin-left: 5px;
        }

        #country-relations-list li, #summit-invitation-list li {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap; /* KÃ¼Ã§Ã¼k ekranlarda sarmalama */
        }


        /* Dark Mode Toggle */
        .theme-toggle {
            position: absolute;
            top: 15px;
            right: 15px;
            background-color: transparent;
            border: none;
            cursor: pointer;
            font-size: 1.5rem;
            color: var(--text-color);
            z-index: 100;
        }

        /* Chart styles */
        #reportChartCanvas {
            background-color: var(--panel-bg);
            border-radius: 6px;
            max-width: 100%;
            height: auto;
            margin-top: 20px;
        }

        /* Yeni Ã¶zellikler iÃ§in stiller */
        .slider-container {
            margin: 15px 0;
        }

        .slider-container label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .slider-container input[type="range"] {
            width: 100%;
            height: 10px;
            border-radius: 5px;
            background: var(--panel-bg);
            outline: none;
            -webkit-appearance: none;
        }

        .slider-container input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--accent-color);
            cursor: pointer;
        }

        .flex-row {
            display: flex;
            gap: 10px;
            align-items: center;
            margin: 10px 0;
            flex-wrap: wrap;
        }

        .input-with-buttons {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .input-with-buttons input {
            width: 100px;
            text-align: center;
        }

        .input-with-buttons button {
            padding: 8px 12px;
            font-size: 1em;
        }

        .minister-advice {
            background-color: var(--panel-bg);
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
            border-left: 5px solid var(--accent-color);
        }

        .minister-advice h3 {
            margin-top: 0;
            color: var(--accent-color);
        }

        .policy-slider {
            margin: 15px 0;
        }

        .policy-slider-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 5px;
        }

        .policy-value {
            font-weight: bold;
        }

        /* Tooltip styles */
        .tooltip {
            position: relative;
            display: inline-block;
            margin-left: 5px;
            cursor: help;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: rgba(0, 0, 0, 0.8);
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.9em;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        @media (max-width: 480px) {
            button {
                padding: 8px 12px;
                font-size: 0.85em;
                margin: 3px;
            }
            
            .stats-panel p, .actions-panel h3 {
                font-size: 0.95em;
            }
             .game-screen li div {
                justify-content: flex-start; /* Mobil iÃ§in butonlarÄ± sola yasla */
            }
        }
    </style>
</head>
<body>
    <button id="theme-toggle" class="theme-toggle" aria-label="Toggle dark/light mode">ğŸŒ“</button>
    <div class="game-container">
        <h1>Ulus SimÃ¼latÃ¶rÃ¼</h1>

        <div class="tabs">
            <button class="tab-btn active" data-tab="main-screen">Ana Ekran</button>
            <button class="tab-btn" data-tab="cabinet-screen">Kabine</button>
            <button class="tab-btn" data-tab="parliament-screen">Meclis & Siyaset</button>
            <button class="tab-btn" data-tab="foreign-affairs-screen">DÄ±ÅŸ Ä°liÅŸkiler & Zirveler</button>
            <button class="tab-btn" data-tab="security-screen">GÃ¼venlik & Ordu</button>
            <button class="tab-btn" data-tab="reports-screen">Raporlar</button>
        </div>

        <div id="main-screen" class="game-screen active">
            <div class="stats-panel">
                <p>Hafta: <span id="current-week">1</span></p>
                <p>NÃ¼fus: <span id="population">10,000,000</span></p>
                <p>GSYÄ°H: $<span id="gdp">1,000,000,000</span></p>
                <p>Enflasyon: <span id="inflation">2</span>%</p>
                <p>Halk Memnuniyeti: <span id="satisfaction">70</span>%</p>
                <p>BÃ¼tÃ§e: $<span id="budget">100,000,000</span></p>
                <p>Vergi OranÄ±: <span id="tax-rate">10</span>%</p>
                <p>Siyasi Sistem: <span id="political-system">Demokrasi</span></p>
                <p>Siyasi Ä°stikrar: <span id="political-stability">70</span>%</p>
                <p>DÄ±ÅŸ Ä°liÅŸkiler Skoru: <span id="foreign-relations-score">50</span></p>
                <p>Ordu BÃ¼yÃ¼klÃ¼ÄŸÃ¼: <span id="army-size-display">50000</span></p>
            </div>

            <div class="actions-panel">
                <h2>Kararlar</h2>
                <div class="action-category">
                    <h3>Vergi AyarlarÄ±</h3>
                    <div class="slider-container">
                        <label for="tax-slider">Vergi OranÄ±: <span id="tax-slider-value">10</span>%</label>
                        <input type="range" id="tax-slider" min="5" max="30" step="0.1" value="10">
                    </div>
                    <button id="apply-tax">Vergi OranÄ±nÄ± Uygula</button>
                </div>
                
                <div class="action-category">
                    <h3>Ekonomi</h3>
                    <div class="flex-row">
                        <label for="economy-investment">Ekonomiye YatÄ±rÄ±m ($M):</label>
                        <div class="input-with-buttons">
                            <button id="decrease-economy-investment">-</button>
                            <input type="number" id="economy-investment" value="10" min="1" max="100">
                            <button id="increase-economy-investment">+</button>
                        </div>
                        <button id="invest-economy">YatÄ±rÄ±m Yap</button>
                    </div>
                </div>
                
                <div class="action-category">
                    <h3>Sosyal Politikalar</h3>
                    <div class="flex-row">
                        <label for="education-investment">EÄŸitime YatÄ±rÄ±m ($M):</label>
                        <div class="input-with-buttons">
                            <button id="decrease-education-investment">-</button>
                            <input type="number" id="education-investment" value="5" min="1" max="50">
                            <button id="increase-education-investment">+</button>
                        </div>
                        <button id="invest-education">YatÄ±rÄ±m Yap</button>
                    </div>
                    
                    <div class="flex-row">
                        <label for="health-investment">SaÄŸlÄ±ÄŸa YatÄ±rÄ±m ($M):</label>
                        <div class="input-with-buttons">
                            <button id="decrease-health-investment">-</button>
                            <input type="number" id="health-investment" value="7" min="1" max="50">
                            <button id="increase-health-investment">+</button>
                        </div>
                        <button id="invest-health">YatÄ±rÄ±m Yap</button>
                    </div>
                    
                    <div class="flex-row">
                        <label for="culture-investment">KÃ¼ltÃ¼re YatÄ±rÄ±m ($M):</label>
                        <div class="input-with-buttons">
                            <button id="decrease-culture-investment">-</button>
                            <input type="number" id="culture-investment" value="3" min="1" max="30">
                            <button id="increase-culture-investment">+</button>
                        </div>
                        <button id="promote-culture">YatÄ±rÄ±m Yap</button>
                    </div>
                    
                    <button id="declare-holiday">Yeni Tatil Ä°lan Et ($2M)</button>
                </div>
                 <div class="action-category">
                    <h3>Yeni Politikalar</h3>
                    <button id="invest-green-energy">YeÅŸil Enerjiye YatÄ±rÄ±m Yap ($20M)</button>
                    <button id="develop-defense-industry">Savunma Sanayii GeliÅŸtir ($50M)</button>
                </div>
                <button id="end-week-btn">HaftayÄ± Bitir</button>
            </div>

            <div class="log-panel">
                <h2>Olay GÃ¼nlÃ¼ÄŸÃ¼</h2>
                <ul id="game-log"></ul>
            </div>

            <canvas id="gameCanvas"></canvas>
        </div>

        <div id="cabinet-screen" class="game-screen">
            <h2>Kabine YÃ¶netimi</h2>
            <p>Mevcut Kabine Ãœyeleri:</p>
            <ul id="cabinet-list">
            </ul>
            
            <div class="minister-advice" id="cabinet-advice">
                <h3>Bakan RaporlarÄ±</h3>
                <div id="economy-minister-advice">
                    <p><strong>Ekonomi BakanÄ±:</strong> <span id="economy-advice-text">HenÃ¼z rapor verilmedi.</span></p>
                </div>
                <div id="education-minister-advice">
                    <p><strong>EÄŸitim BakanÄ±:</strong> <span id="education-advice-text">HenÃ¼z rapor verilmedi.</span></p>
                </div>
                <div id="health-minister-advice">
                    <p><strong>SaÄŸlÄ±k BakanÄ±:</strong> <span id="health-advice-text">HenÃ¼z rapor verilmedi.</span></p>
                </div>
                <div id="foreign-minister-advice">
                    <p><strong>DÄ±ÅŸiÅŸleri BakanÄ±:</strong> <span id="foreign-advice-text">HenÃ¼z rapor verilmedi.</span></p>
                </div>
                <div id="interior-minister-advice">
                    <p><strong>Ä°Ã§iÅŸleri BakanÄ±:</strong> <span id="interior-advice-text">HenÃ¼z rapor verilmedi.</span></p>
                </div>
                <div id="justice-minister-advice">
                    <p><strong>Adalet BakanÄ±:</strong> <span id="justice-advice-text">HenÃ¼z rapor verilmedi.</span></p>
                </div>
                 <div id="defense-minister-advice">
                    <p><strong>Savunma BakanÄ±:</strong> <span id="defense-advice-text">HenÃ¼z rapor verilmedi.</span></p>
                </div>
            </div>
            
            <h3>Bakan AtamalarÄ± / DeÄŸiÅŸiklikleri</h3>
            <div class="cabinet-actions">
                <select id="minister-type-select">
                    <option value="economy">Ekonomi BakanÄ±</option>
                    <option value="education">EÄŸitim BakanÄ±</option>
                    <option value="health">SaÄŸlÄ±k BakanÄ±</option>
                    <option value="foreign">DÄ±ÅŸiÅŸleri BakanÄ±</option>
                    <option value="interior">Ä°Ã§iÅŸleri BakanÄ±</option>
                    <option value="justice">Adalet BakanÄ±</option>
                    <option value="defense">Savunma BakanÄ±</option>
                </select>
                <input type="text" id="minister-name-input" placeholder="Yeni Bakan AdÄ± (isteÄŸe baÄŸlÄ±)">
                <button id="appoint-minister-btn">Bakan Ata / DeÄŸiÅŸtir ($500K)</button>
            </div>
            <p>Kabine kararlarÄ± haftalÄ±k sÃ¼reÃ§leri etkiler.</p>
        </div>

        <div id="parliament-screen" class="game-screen">
            <h2>Meclis & Siyaset</h2>
            <p>Meclis DesteÄŸi: <span id="parliament-support"></span></p>
            <p>Muhalefet GÃ¼cÃ¼: <span id="opposition-strength-display"></span></p>
            
            <div class="policy-slider">
                <div class="policy-slider-header">
                    <h3>Sosyal Politikalar</h3>
                    <span class="policy-value" id="social-policy-value">5</span>
                </div>
                <input type="range" id="social-policy-slider" min="1" max="10" value="5">
                <div class="tooltip">â„¹ï¸
                    <span class="tooltiptext">Sosyal politikalarÄ± artÄ±rmak halk memnuniyetini artÄ±rÄ±r ancak bÃ¼tÃ§eye yÃ¼k getirir.</span>
                </div>
                <button id="apply-social-policy">Uygula</button>
            </div>
            
            <div class="policy-slider">
                <div class="policy-slider-header">
                    <h3>Ekonomi PolitikalarÄ±</h3>
                    <span class="policy-value" id="economic-policy-value">5</span>
                </div>
                <input type="range" id="economic-policy-slider" min="1" max="10" value="5">
                <div class="tooltip">â„¹ï¸
                    <span class="tooltiptext">Ekonomi politikalarÄ±nÄ± deÄŸiÅŸtirmek GSYÄ°H ve enflasyonu etkiler.</span>
                </div>
                <button id="apply-economic-policy">Uygula</button>
            </div>
            
            <h3>GÃ¼ndemdeki Yasalar / Talepler</h3>
            <ul id="parliament-agenda">
            </ul>
            <h3>Sizin Teklifleriniz</h3>
            <div class="parliament-propose">
                <input type="text" id="proposal-input" placeholder="Yeni yasa teklifi">
                <button id="propose-law-btn">Yasa Teklif Et</button>
            </div>
            <h3>Muhalefet Ä°liÅŸkileri</h3>
            <div class="opposition-actions">
                <button id="meet-opposition-closed-btn">Muhalefetle KapalÄ± GÃ¶rÃ¼ÅŸ ($500K)</button>
                <button id="meet-opposition-open-btn">Muhalefetle AÃ§Ä±k GÃ¶rÃ¼ÅŸ ($200K)</button>
            </div>
            <h3>Radikal Kararlar</h3>
            <div class="parliament-propose">
                 <button id="call-elections">Erken SeÃ§im Ã‡aÄŸrÄ±sÄ± Yap ($10M)</button>
                 <button id="declare-dictatorship">DiktatÃ¶rlÃ¼k Ä°lan Et</button>
                 <button id="dissolve-parliament-btn">Meclisi Feshet</button>
            </div>
            <p class="parliament-note">Meclisi feshetmek veya diktatÃ¶rlÃ¼k ilan etmek ciddi sonuÃ§lar doÄŸurabilir.</p>
        </div>

        <div id="foreign-affairs-screen" class="game-screen">
            <h2>DÄ±ÅŸ Ä°liÅŸkiler & Zirveler</h2>
            <p>Genel DÄ±ÅŸ Ä°liÅŸkiler PuanÄ±: <span id="foreign-relations-display"></span></p>
            
            <div class="policy-slider">
                <div class="policy-slider-header">
                    <h3>Diplomatik YaklaÅŸÄ±m</h3>
                    <span class="policy-value" id="diplomatic-approach-value">5</span>
                </div>
                <input type="range" id="diplomatic-approach-slider" min="1" max="10" value="5">
                <div class="tooltip">â„¹ï¸
                    <span class="tooltiptext">1: Agresif, 10: UzlaÅŸmacÄ±. Diplomatik yaklaÅŸÄ±mÄ±nÄ±z dÄ±ÅŸ iliÅŸkileri ve ticari fÄ±rsatlarÄ± etkiler.</span>
                </div>
                <button id="apply-diplomatic-approach">Uygula</button>
            </div>
            
            <h3>Ãœlkelerle Ä°liÅŸkiler</h3>
            <ul id="country-relations-list">
            </ul>

            <h3>Zirve YÃ¶netimi</h3>
            <div class="foreign-actions">
                 <button id="create-summit-btn">Zirve DÃ¼zenle ($15M)</button>
            </div>
            <p>Zirveye davet edilecek Ã¼lkeler (En fazla 5):</p>
            <ul id="summit-invitation-list"></ul>
            <div class="foreign-actions">
                <button id="send-summit-invitations-btn" disabled>Davetleri GÃ¶nder</button>
            </div>


            <h3>Gelen Davetler / Olaylar</h3>
            <ul id="foreign-events-list">
            </ul>
            <h3>Genel Diplomatik Eylemler</h3>
            <div class="foreign-actions">
                <button id="global-summit-btn">UluslararasÄ± Zirveye KatÄ±l ($10M)</button>
                <button id="sign-trade-deal">Ticaret AnlaÅŸmasÄ± Ä°mzala (Uygun Ãœlkeyle - $3M)</button>
                <button id="improve-relations">DÄ±ÅŸ Ä°liÅŸkileri GeliÅŸtir (Genel - $2M)</button>
                <button id="declare-war">SavaÅŸ Ä°lan Et (En KÃ¶tÃ¼ Ä°liÅŸkili Ãœlkeye)</button>
            </div>
        </div>

        <div id="security-screen" class="game-screen">
            <h2>GÃ¼venlik & Ordu</h2>
            <p>SuÃ§ OranÄ±: <span id="crime-rate">5</span>%</p>
            <p>HalkÄ±n GÃ¼venlik AlgÄ±sÄ±: <span id="security-perception">75</span>%</p>
            <p>Ordu BÃ¼yÃ¼klÃ¼ÄŸÃ¼: <span id="army-size-security">50000</span></p>
            <p>Askeri GÃ¼Ã§ Endeksi: <span id="military-strength-index">50</span></p>
            <p>Ordu Sadakati: <span id="army-loyalty-display">YÃ¼ksek</span></p>
            
            <div class="policy-slider">
                <div class="policy-slider-header">
                    <h3>GÃ¼venlik Seviyesi (Ä°Ã§ Polisaj)</h3>
                    <span class="policy-value" id="security-level-value">5</span>
                </div>
                <input type="range" id="security-level-slider" min="1" max="10" value="5">
                <div class="tooltip">â„¹ï¸
                    <span class="tooltiptext">GÃ¼venlik seviyesini artÄ±rmak suÃ§larÄ± azaltabilir ancak Ã¶zgÃ¼rlÃ¼kleri kÄ±sÄ±tlayabilir.</span>
                </div>
                <button id="apply-security-level">Uygula</button>
            </div>
            
            <h3>Emniyet / Adalet KararlarÄ±</h3>
            <div class="flex-row">
                <label for="police-budget">Polis BÃ¼tÃ§esi ($M):</label>
                <div class="input-with-buttons">
                    <button id="decrease-police-budget">-</button>
                    <input type="number" id="police-budget" value="3" min="1" max="20">
                    <button id="increase-police-budget">+</button>
                </div>
                <button id="increase-police-budget-btn">Uygula</button>
            </div>
            <div class="security-actions">
                <button id="reform-justice">Adalet Sistemini Reforme Et ($5M)</button>
                <button id="surveillance-program">GÃ¶zetim ProgramÄ± BaÅŸlat ($4M)</button>
                <button id="crackdown-dissent" title="Sadece DiktatÃ¶rlÃ¼kte etkili">Muhalefeti BastÄ±r ($2M+)</button>
            </div>
            <p class="security-note">GÃ¶zetim programlarÄ± ve muhalefeti bastÄ±rma, suÃ§ oranÄ±nÄ± dÃ¼ÅŸÃ¼rebilir ancak halk memnuniyetini ve siyasi istikrarÄ± ciddi ÅŸekilde etkileyebilir.</p>

            <h3>Askeri Kararlar</h3>
             <div class="flex-row">
                <label for="recruit-soldiers">Asker AlÄ±mÄ± (x1000 kiÅŸi):</label>
                <div class="input-with-buttons">
                    <button id="decrease-recruits">-</button>
                    <input type="number" id="recruit-soldiers-input" value="5" min="1" max="50">
                    <button id="increase-recruits">+</button>
                </div>
                <button id="recruit-soldiers-btn">Asker Al ($1M/1000 asker)</button>
            </div>
            <div class="security-actions">
                <button id="plan-war-btn">SavaÅŸ PlanlamasÄ± Yap ($5M)</button>
                <button id="military-exercise-btn">Askeri Tatbikat DÃ¼zenle ($10M+)</button>
                <button id="military-council-meeting-btn">Askeri Åura ile ToplantÄ± ($1M)</button>
            </div>
        </div>

        <div id="reports-screen" class="game-screen">
            <h2>Raporlar</h2>
            
            <div class="minister-advice">
                <h3>Ekonomi BakanlÄ±ÄŸÄ± Raporu</h3>
                <p>GSYÄ°H DeÄŸiÅŸimi (HaftalÄ±k): <span id="gdp-change-report-display">-</span></p>
                <p>Enflasyon DeÄŸiÅŸimi (HaftalÄ±k): <span id="inflation-change-report-display">-</span></p>
                <p id="economy-report-inflation">Enflasyon Analizi: <span id="inflation-analysis">HenÃ¼z analiz yapÄ±lmadÄ±.</span></p>
                <p id="economy-report-gdp">GSYÄ°H Durumu: <span id="gdp-analysis">HenÃ¼z analiz yapÄ±lmadÄ±.</span></p>
                <p id="economy-report-advice">Ã–neriler: <span id="economy-recommendations">HenÃ¼z Ã¶neri bulunmuyor.</span></p>
            </div>
            
            <div class="minister-advice">
                <h3>Sosyal Politikalar Raporu</h3>
                <p>EÄŸitim Kalitesi: <span id="education-quality-report">Yetersiz</span></p>
                <p>SaÄŸlÄ±k Hizmetleri Kalitesi: <span id="health-quality-report">Yetersiz</span></p>
                <p>Ulusal Bayram SayÄ±sÄ±: <span id="holiday-count-report">0</span></p>
                <p>Ã–neriler: <span id="social-recommendations">HenÃ¼z Ã¶neri bulunmuyor.</span></p>
            </div>
            
            <div class="minister-advice">
                <h3>Siyasi Rapor</h3>
                <p>HÃ¼kÃ¼met DesteÄŸi (Memnuniyet): <span id="government-support-report">70%</span></p>
                <p>Meclis DesteÄŸi: <span id="parliament-support-report">70%</span></p>
                <p>Siyasi Ä°stikrar: <span id="political-stability-report">70%</span></p>
                <p>Ã–neriler: <span id="political-recommendations">HenÃ¼z Ã¶neri bulunmuyor.</span></p>
            </div>
             <div class="minister-advice">
                <h3>Askeri Durum Raporu</h3>
                <p>Ordu HazÄ±rlÄ±k Seviyesi: <span id="army-readiness-report">Orta</span></p>
                <p>Ordu Sadakati: <span id="army-loyalty-report">YÃ¼ksek</span></p>
                <p>Genelkurmay DeÄŸerlendirmesi: <span id="military-assessment-report">Durum stabil.</span></p>
            </div>
            
            <h3>Ekonomi Verileri (Son 10 Hafta)</h3>
            <canvas id="reportChartCanvas" width="600" height="300"></canvas>
        </div>

        <div id="game-over-screen" class="game-screen">
            <h1>Oyun Bitti!</h1>
            <p id="game-over-reason"></p>
            <p>Son Hafta: <span id="final-week"></span></p>
            <p>Son NÃ¼fus: <span id="final-population"></span></p>
            <p>Son GSYÄ°H: <span id="final-gdp"></span></p>
            <button id="restart-game-btn">Tekrar Oyna</button>
        </div>

    </div>

    <script>
        // --- Oyun DeÄŸiÅŸkenleri ---
        let week = 1;
        let population = 10000000;
        let gdp = 1000000000;
        let inflation = 2; // %
        let satisfaction = 70; // %
        let budget = 100000000; // $
        let taxes = 10; // Vergi oranÄ± (%)
        let educationSpending = 0; 
        let healthSpending = 0; 
        let cultureSpending = 0; 
        let crimeRate = 5; // %
        let securityPerception = 75; // %
        let politicalSystem = 'Demokrasi'; // 'Demokrasi', 'DiktatÃ¶rlÃ¼k'
        let politicalStability = 70; // % Siyasi istikrar
        let parliamentSupport = 70; // % Meclis desteÄŸi
        let foreignRelationsScore = 50; // Genel dÄ±ÅŸ iliÅŸkiler puanÄ± (0-100)
        let nationalHolidays = 0; 
        let armySize = 50000; 
        let militaryStrengthIndex = 50; // Askeri gÃ¼Ã§ (0-100)
        let armyUpkeepCostPerSoldier = 50; 
        let armyLoyalty = 80; // Ordu sadakati (0-100)


        // Politika deÄŸiÅŸkenleri
        let socialPolicyLevel = 5; // 1-10 arasÄ±
        let economicPolicyLevel = 5; // 1-10 arasÄ±
        let diplomaticApproachLevel = 5; // 1-10 arasÄ± (1: Agresif, 10: UzlaÅŸmacÄ±)
        let securityLevel = 5; // 1-10 arasÄ± (Ä°Ã§ polisaj)

        // Tarih verilerini tutmak iÃ§in diziler
        const historicalData = {
            weeks: [],
            gdp: [],
            satisfaction: [],
            inflation: [],
            politicalStability: []
        };
        // GeÃ§ici haftalÄ±k etki depolayÄ±cÄ±larÄ±
        let weeklyBudgetChange = 0;
        let weeklySatisfactionChange = 0;
        let weeklyGdpChangeFactor = 1; 
        let weeklyInflationChange = 0;
        let weeklyPopulationChangeFactor = 1; 
        let weeklyForeignRelationsChange = 0;
        let weeklyCrimeRateChange = 0;
        let weeklySecurityPerceptionChange = 0;
        let weeklyMilitaryStrengthChange = 0;
        let weeklyPoliticalStabilityChange = 0;
        let weeklyArmyLoyaltyChange = 0;


        // Kabine Ãœyeleri
        const cabinet = {
            economy: { name: 'BoÅŸ', efficiency: 0.5, corruption: 0.1 },
            education: { name: 'BoÅŸ', efficiency: 0.5, corruption: 0.1 },
            health: { name: 'BoÅŸ', efficiency: 0.5, corruption: 0.1 },
            foreign: { name: 'BoÅŸ', efficiency: 0.5, corruption: 0.1 },
            interior: { name: 'BoÅŸ', efficiency: 0.5, corruption: 0.1 },
            justice: { name: 'BoÅŸ', efficiency: 0.5, corruption: 0.1 },
            defense: { name: 'BoÅŸ', efficiency: 0.5, corruption: 0.1 } // Savunma BakanÄ± eklendi
        };
        // Ãœlkelerle Ä°liÅŸkiler
        const countries = {
            'Yunanistan': { relation: 40, tradeDeal: false, summitInvited: false, summitAccepted: false, militaryPower: 45 },
            'Bulgaristan': { relation: 55, tradeDeal: false, summitInvited: false, summitAccepted: false, militaryPower: 35 },
            'GÃ¼rcistan': { relation: 60, tradeDeal: true, summitInvited: false, summitAccepted: false, militaryPower: 30 },
            'Ermenistan': { relation: 20, tradeDeal: false, summitInvited: false, summitAccepted: false, militaryPower: 25 },
            'Azerbaycan': { relation: 75, tradeDeal: true, summitInvited: false, summitAccepted: false, militaryPower: 50 },
            'Ä°ran': { relation: 30, tradeDeal: false, summitInvited: false, summitAccepted: false, militaryPower: 65 },
            'Irak': { relation: 25, tradeDeal: false, summitInvited: false, summitAccepted: false, militaryPower: 40 },
            'Suriye': { relation: 15, tradeDeal: false, summitInvited: false, summitAccepted: false, militaryPower: 20 }, // Ä°Ã§ savaÅŸta olduÄŸu iÃ§in dÃ¼ÅŸÃ¼k
            'Rusya': { relation: 45, tradeDeal: false, summitInvited: false, summitAccepted: false, militaryPower: 90 },
            'Ukrayna': { relation: 50, tradeDeal: false, summitInvited: false, summitAccepted: false, militaryPower: 60 }
        };
        // Meclis GÃ¼ndemi
        const parliamentAgenda = []; 
        let summitPlanned = false;
        let summitInvitationsSent = false;

        // --- DOM Elementleri ---
        const themeToggleBtn = document.getElementById('theme-toggle');
        const tabButtons = document.querySelectorAll('.tab-btn');
        const gameScreens = document.querySelectorAll('.game-screen');
        const currentWeekEl = document.getElementById('current-week');
        const populationEl = document.getElementById('population');
        const gdpEl = document.getElementById('gdp');
        const inflationEl = document.getElementById('inflation');
        const satisfactionEl = document.getElementById('satisfaction');
        const budgetEl = document.getElementById('budget');
        const taxRateEl = document.getElementById('tax-rate');
        const politicalSystemEl = document.getElementById('political-system');
        const politicalStabilityEl = document.getElementById('political-stability');
        const foreignRelationsScoreEl = document.getElementById('foreign-relations-score');
        const armySizeDisplayEl = document.getElementById('army-size-display');
        const gameLogEl = document.getElementById('game-log');
        const gameCanvas = document.getElementById('gameCanvas');
        const ctx = gameCanvas.getContext('2d');
        const taxSlider = document.getElementById('tax-slider');
        const taxSliderValue = document.getElementById('tax-slider-value');
        const applyTaxBtn = document.getElementById('apply-tax');
        const economyInvestmentInput = document.getElementById('economy-investment');
        const investEconomyBtn = document.getElementById('invest-economy');
        const educationInvestmentInput = document.getElementById('education-investment');
        const investEducationBtn = document.getElementById('invest-education');
        const healthInvestmentInput = document.getElementById('health-investment');
        const investHealthBtn = document.getElementById('invest-health');
        const cultureInvestmentInput = document.getElementById('culture-investment');
        const promoteCultureBtn = document.getElementById('promote-culture');
        const declareHolidayBtn = document.getElementById('declare-holiday');
        const endWeekBtn = document.getElementById('end-week-btn');
        const investGreenEnergyBtn = document.getElementById('invest-green-energy');
        const developDefenseIndustryBtn = document.getElementById('develop-defense-industry');
        const socialPolicySlider = document.getElementById('social-policy-slider');
        const socialPolicyValue = document.getElementById('social-policy-value');
        const applySocialPolicyBtn = document.getElementById('apply-social-policy');
        const economicPolicySlider = document.getElementById('economic-policy-slider');
        const economicPolicyValue = document.getElementById('economic-policy-value');
        const applyEconomicPolicyBtn = document.getElementById('apply-economic-policy');
        const diplomaticApproachSlider = document.getElementById('diplomatic-approach-slider');
        const diplomaticApproachValue = document.getElementById('diplomatic-approach-value');
        const applyDiplomaticApproachBtn = document.getElementById('apply-diplomatic-approach');
        const securityLevelSlider = document.getElementById('security-level-slider');
        const securityLevelValue = document.getElementById('security-level-value');
        const applySecurityLevelBtn = document.getElementById('apply-security-level');
        const policeBudgetInput = document.getElementById('police-budget');
        const increasePoliceBudgetBtnApply = document.getElementById('increase-police-budget-btn');
        const crimeRateEl = document.getElementById('crime-rate');
        const securityPerceptionEl = document.getElementById('security-perception');
        const armySizeSecurityEl = document.getElementById('army-size-security');
        const militaryStrengthIndexEl = document.getElementById('military-strength-index');
        const armyLoyaltyDisplayEl = document.getElementById('army-loyalty-display');
        const reformJusticeBtn = document.getElementById('reform-justice');
        const surveillanceProgramBtn = document.getElementById('surveillance-program');
        const crackdownDissentBtn = document.getElementById('crackdown-dissent');
        const recruitSoldiersInput = document.getElementById('recruit-soldiers-input');
        const recruitSoldiersBtn = document.getElementById('recruit-soldiers-btn');
        const planWarBtn = document.getElementById('plan-war-btn');
        const militaryExerciseBtn = document.getElementById('military-exercise-btn');
        const militaryCouncilMeetingBtn = document.getElementById('military-council-meeting-btn');
        const cabinetListEl = document.getElementById('cabinet-list');
        const ministerTypeSelect = document.getElementById('minister-type-select');
        const ministerNameInput = document.getElementById('minister-name-input');
        const appointMinisterBtn = document.getElementById('appoint-minister-btn');
        const economyAdviceText = document.getElementById('economy-advice-text');
        const educationAdviceText = document.getElementById('education-advice-text');
        const healthAdviceText = document.getElementById('health-advice-text');
        const foreignAdviceText = document.getElementById('foreign-advice-text');
        const interiorAdviceText = document.getElementById('interior-advice-text');
        const justiceAdviceText = document.getElementById('justice-advice-text');
        const defenseAdviceText = document.getElementById('defense-advice-text');
        const inflationAnalysisEl = document.getElementById('inflation-analysis');
        const gdpAnalysisEl = document.getElementById('gdp-analysis');
        const economyRecommendationsEl = document.getElementById('economy-recommendations');
        const socialRecommendationsEl = document.getElementById('social-recommendations');
        const politicalRecommendationsEl = document.getElementById('political-recommendations');
        const parliamentSupportEl = document.getElementById('parliament-support');
        const oppositionStrengthDisplayEl = document.getElementById('opposition-strength-display');
        const parliamentAgendaList = document.getElementById('parliament-agenda');
        const proposalInput = document.getElementById('proposal-input');
        const proposeLawBtn = document.getElementById('propose-law-btn');
        const callElectionsBtn = document.getElementById('call-elections');
        const declareDictatorshipBtn = document.getElementById('declare-dictatorship');
        const dissolveParliamentBtn = document.getElementById('dissolve-parliament-btn');
        const meetOppositionClosedBtn = document.getElementById('meet-opposition-closed-btn');
        const meetOppositionOpenBtn = document.getElementById('meet-opposition-open-btn');
        const foreignRelationsDisplayEl = document.getElementById('foreign-relations-display');
        const countryRelationsList = document.getElementById('country-relations-list');
        const foreignEventsList = document.getElementById('foreign-events-list');
        const globalSummitBtn = document.getElementById('global-summit-btn');
        const signTradeDealBtn = document.getElementById('sign-trade-deal');
        const improveRelationsBtn = document.getElementById('improve-relations');
        const declareWarBtn = document.getElementById('declare-war');
        const createSummitBtn = document.getElementById('create-summit-btn');
        const summitInvitationListEl = document.getElementById('summit-invitation-list');
        const sendSummitInvitationsBtn = document.getElementById('send-summit-invitations-btn');
        const gdpChangeReportDisplayEl = document.getElementById('gdp-change-report-display');
        const inflationChangeReportDisplayEl = document.getElementById('inflation-change-report-display');
        const educationQualityReportEl = document.getElementById('education-quality-report');
        const healthQualityReportEl = document.getElementById('health-quality-report');
        const holidayCountReportEl = document.getElementById('holiday-count-report');
        const governmentSupportReportEl = document.getElementById('government-support-report');
        const parliamentSupportReportEl = document.getElementById('parliament-support-report');
        const politicalStabilityReportEl = document.getElementById('political-stability-report');
        const oppositionStrengthReportEl = document.getElementById('opposition-strength-report'); // Bu ID HTML'de yok, Meclis ekranÄ±ndaki ile aynÄ± olabilir.
        const armyReadinessReportEl = document.getElementById('army-readiness-report');
        const armyLoyaltyReportEl = document.getElementById('army-loyalty-report');
        const militaryAssessmentReportEl = document.getElementById('military-assessment-report');
        const reportChartCanvas = document.getElementById('reportChartCanvas');
        const reportChartCtx = reportChartCanvas.getContext('2d');
        const gameOverScreen = document.getElementById('game-over-screen');
        const gameOverReasonEl = document.getElementById('game-over-reason');
        const finalWeekEl = document.getElementById('final-week');
        const finalPopulationEl = document.getElementById('final-population');
        const finalGdpEl = document.getElementById('final-gdp');
        const restartGameBtn = document.getElementById('restart-game-btn');
        
        // --- Dark Mode KontrolÃ¼ ---
        function initTheme() {
            if (localStorage.getItem('theme') === 'dark') {
                document.documentElement.classList.add('dark');
                themeToggleBtn.textContent = 'â˜€ï¸';
            } else {
                 document.documentElement.classList.remove('dark');
                themeToggleBtn.textContent = 'ğŸŒ™';
            }
        }

        themeToggleBtn.addEventListener('click', () => {
            if (document.documentElement.classList.contains('dark')) {
                document.documentElement.classList.remove('dark');
                themeToggleBtn.textContent = 'ğŸŒ™';
                localStorage.setItem('theme', 'light');
            } else {
                document.documentElement.classList.add('dark');
                themeToggleBtn.textContent = 'â˜€ï¸';
                localStorage.setItem('theme', 'dark');
            }
            drawCanvasStats(); // Tema deÄŸiÅŸince canvas renkleri de gÃ¼ncellenmeli
            drawReportChart();
        });
        // --- YardÄ±mcÄ± Fonksiyonlar ---

        function showScreen(screenId) {
            gameScreens.forEach(screen => {
                screen.style.display = 'none';
            });
            const targetScreen = document.getElementById(screenId);
            if (targetScreen) {
                 targetScreen.style.display = screenId === 'main-screen' ? 'grid' : 'block';
            }

            tabButtons.forEach(btn => {
                if (btn.dataset.tab === screenId) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
            if (screenId === 'reports-screen') {
                updateReports(); // Bu zaten updateMinisterReports ve drawReportChart'Ä± Ã§aÄŸÄ±rÄ±yor
            } else if (screenId === 'cabinet-screen') {
                updateMinisterAdvice();
            } else if (screenId === 'foreign-affairs-screen') {
                updateForeignRelationsDisplay();
                updateSummitInvitationList();
            } else if (screenId === 'security-screen') {
                armySizeSecurityEl.textContent = armySize.toLocaleString();
                militaryStrengthIndexEl.textContent = militaryStrengthIndex.toFixed(0);
                armyLoyaltyDisplayEl.textContent = getArmyLoyaltyStatus();
            } else if (screenId === 'parliament-screen') {
                oppositionStrengthDisplayEl.textContent = `${(politicalSystem === 'Demokrasi' ? (100 - parliamentSupport) : 0).toFixed(0)}%`;
            }
        }
        
        function getArmyLoyaltyStatus() {
            if (armyLoyalty >= 80) return "Ã‡ok YÃ¼ksek";
            if (armyLoyalty >= 60) return "YÃ¼ksek";
            if (armyLoyalty >= 40) return "Orta";
            if (armyLoyalty >= 20) return "DÃ¼ÅŸÃ¼k";
            return "Ã‡ok DÃ¼ÅŸÃ¼k";
        }


        function resizeCanvas() {
            const container = gameCanvas.parentElement;
            if (container) { 
                 gameCanvas.width = container.offsetWidth;
                 gameCanvas.height = 300; 
                 drawCanvasStats();

                 const reportContainer = reportChartCanvas.parentElement;
                 if (reportContainer) {
                    reportChartCanvas.width = reportContainer.offsetWidth * 0.98; 
                    reportChartCanvas.height = 300; 
                    drawReportChart(); 
                 }
            }
        }
        window.addEventListener('resize', resizeCanvas);


        function resetGame() {
            week = 1;
            population = 10000000;
            gdp = 1000000000;
            inflation = 2;
            satisfaction = 70;
            budget = 100000000;
            taxes = 10;
            educationSpending = 0;
            healthSpending = 0;
            cultureSpending = 0;
            crimeRate = 5;
            securityPerception = 75;
            politicalSystem = 'Demokrasi';
            politicalStability = 70;
            parliamentSupport = 70;
            foreignRelationsScore = 50;
            nationalHolidays = 0;
            armySize = 50000;
            militaryStrengthIndex = 50;
            armyLoyalty = 80;
            summitPlanned = false;
            summitInvitationsSent = false;
            
            socialPolicyLevel = 5;
            economicPolicyLevel = 5;
            diplomaticApproachLevel = 5;
            securityLevel = 5;
            
            taxSlider.value = taxes;
            taxSliderValue.textContent = taxes;
            socialPolicySlider.value = socialPolicyLevel;
            socialPolicyValue.textContent = socialPolicyLevel;
            economicPolicySlider.value = economicPolicyLevel;
            economicPolicyValue.textContent = economicPolicyLevel;
            diplomaticApproachSlider.value = diplomaticApproachLevel;
            diplomaticApproachValue.textContent = diplomaticApproachLevel;
            securityLevelSlider.value = securityLevel;
            securityLevelValue.textContent = securityLevel;

            weeklyBudgetChange = 0; weeklySatisfactionChange = 0; weeklyGdpChangeFactor = 1;
            weeklyInflationChange = 0; weeklyPopulationChangeFactor = 1; weeklyForeignRelationsChange = 0;
            weeklyCrimeRateChange = 0; weeklySecurityPerceptionChange = 0; weeklyMilitaryStrengthChange = 0;
            weeklyPoliticalStabilityChange = 0; weeklyArmyLoyaltyChange = 0;

            historicalData.weeks = []; historicalData.gdp = []; historicalData.satisfaction = [];
            historicalData.inflation = []; historicalData.politicalStability = [];

            for (const type in cabinet) {
                cabinet[type] = { name: 'BoÅŸ', efficiency: 0.5 + (Math.random()-0.5)*0.2, corruption: 0.1 + (Math.random()-0.5)*0.1 };
            }
            updateCabinetDisplay();
            const initialCountries = {
                'Yunanistan': { relation: 30 + Math.floor(Math.random()*21)-10, tradeDeal: false, summitInvited: false, summitAccepted: false, militaryPower: 40 + Math.floor(Math.random()*11)-5 },
                'Bulgaristan': { relation: 45 + Math.floor(Math.random()*21)-10, tradeDeal: false, summitInvited: false, summitAccepted: false, militaryPower: 30 + Math.floor(Math.random()*11)-5 },
                'GÃ¼rcistan': { relation: 50 + Math.floor(Math.random()*21)-10, tradeDeal: Math.random() < 0.3, summitInvited: false, summitAccepted: false, militaryPower: 25 + Math.floor(Math.random()*11)-5 },
                'Ermenistan': { relation: 15 + Math.floor(Math.random()*21)-10, tradeDeal: false, summitInvited: false, summitAccepted: false, militaryPower: 20 + Math.floor(Math.random()*11)-5 },
                'Azerbaycan': { relation: 65 + Math.floor(Math.random()*21)-10, tradeDeal: Math.random() < 0.5, summitInvited: false, summitAccepted: false, militaryPower: 45 + Math.floor(Math.random()*11)-5 },
                'Ä°ran': { relation: 25 + Math.floor(Math.random()*21)-10, tradeDeal: false, summitInvited: false, summitAccepted: false, militaryPower: 60 + Math.floor(Math.random()*11)-5 },
                'Irak': { relation: 20 + Math.floor(Math.random()*21)-10, tradeDeal: false, summitInvited: false, summitAccepted: false, militaryPower: 35 + Math.floor(Math.random()*11)-5 },
                'Suriye': { relation: 10 + Math.floor(Math.random()*21)-10, tradeDeal: false, summitInvited: false, summitAccepted: false, militaryPower: 15 + Math.floor(Math.random()*11)-5 },
                'Rusya': { relation: 40 + Math.floor(Math.random()*21)-10, tradeDeal: false, summitInvited: false, summitAccepted: false, militaryPower: 85 + Math.floor(Math.random()*11)-5 },
                'Ukrayna': { relation: 45 + Math.floor(Math.random()*21)-10, tradeDeal: false, summitInvited: false, summitAccepted: false, militaryPower: 55 + Math.floor(Math.random()*11)-5 }
            };
             for (const countryName in countries) { 
                if (initialCountries[countryName]) {
                    countries[countryName].relation = Math.max(0, Math.min(100, initialCountries[countryName].relation));
                    countries[countryName].tradeDeal = initialCountries[countryName].tradeDeal;
                    countries[countryName].militaryPower = initialCountries[countryName].militaryPower;
                    countries[countryName].summitInvited = false;
                    countries[countryName].summitAccepted = false;
                }
            }
            updateForeignRelationsDisplay();
            updateSummitInvitationList();

            parliamentAgenda.length = 0; 
            updateParliamentDisplay();
            foreignEventsList.innerHTML = ''; 
            gameLogEl.innerHTML = ''; 
            
            addLog('Ulus SimÃ¼latÃ¶rÃ¼ BaÅŸladÄ±! Yeni bir oyun...');
            updateGameStats(); 
            updateMinisterAdvice(); 
            updateReports();
            resizeCanvas(); // Canvas'Ä± ilk aÃ§Ä±lÄ±ÅŸta doÄŸru boyutlandÄ±r
            enableAllActionButtons(); // ButonlarÄ± oyun durumuna gÃ¶re ayarla
            showScreen('main-screen'); 
        }

        function updateGameStats() {
            currentWeekEl.textContent = week;
            populationEl.textContent = population.toLocaleString();
            gdpEl.textContent = gdp.toLocaleString();
            inflationEl.textContent = inflation.toFixed(1);
            satisfactionEl.textContent = satisfaction.toFixed(1);
            budgetEl.textContent = budget.toLocaleString();
            taxRateEl.textContent = taxes.toFixed(1);
            politicalSystemEl.textContent = politicalSystem;
            politicalStabilityEl.textContent = politicalStability.toFixed(1) + '%';
            foreignRelationsScoreEl.textContent = foreignRelationsScore.toFixed(0);
            armySizeDisplayEl.textContent = armySize.toLocaleString(); 
            armySizeSecurityEl.textContent = armySize.toLocaleString(); 
            militaryStrengthIndexEl.textContent = militaryStrengthIndex.toFixed(0);
            armyLoyaltyDisplayEl.textContent = getArmyLoyaltyStatus();

            crimeRateEl.textContent = crimeRate.toFixed(1);
            securityPerceptionEl.textContent = securityPerception.toFixed(1);

            drawCanvasStats(); 
            updateReports(); 
        }

        function addLog(message, type = 'info') {
            const listItem = document.createElement('li');
            listItem.textContent = `Hafta ${week}: ${message}`;
            if (type === 'warning') listItem.style.color = 'var(--warning-color)';
            else if (type === 'danger') listItem.style.color = 'var(--danger-color)';
            else if (type === 'success') listItem.style.color = 'var(--success-color)';
            else if (type === 'event') { listItem.style.color = 'var(--accent-color)'; listItem.style.fontWeight = 'bold';}
            gameLogEl.prepend(listItem); 
            
            if (gameLogEl.children.length > 70) { // Log limiti arttÄ±rÄ±ldÄ±
                gameLogEl.removeChild(gameLogEl.lastChild);
            }
        }

        function drawCanvasStats() {
            if (!gameCanvas || !ctx) return;
            ctx.clearRect(0, 0, gameCanvas.width, gameCanvas.height);
            const barHeight = 20;
            const barWidth = Math.max(50, gameCanvas.width - 130); // GeniÅŸlik ayarlandÄ±
            const startX = 110; // X pozisyonu ayarlandÄ±
            let currentY = 30;
            const textColor = getComputedStyle(document.documentElement).getPropertyValue('--text-color');
            const borderColor = getComputedStyle(document.documentElement).getPropertyValue('--border-color');
            ctx.font = '14px Arial'; // Font boyutu ayarlandÄ±

            function drawBar(label, value, maxValue, colorFunc) {
                ctx.fillStyle = textColor;
                ctx.fillText(label, 10, currentY + barHeight / 2 + 5);
                const fillWidth = (value / maxValue) * barWidth;
                ctx.fillStyle = colorFunc(value, maxValue);
                ctx.fillRect(startX, currentY, fillWidth, barHeight);
                ctx.strokeStyle = borderColor;
                ctx.strokeRect(startX, currentY, barWidth, barHeight);
                ctx.fillStyle = textColor;
                ctx.fillText(`${value.toFixed(1)}%`, startX + barWidth + 5, currentY + barHeight / 2 + 5);
                currentY += barHeight + 15; // AralÄ±k ayarlandÄ±
            }

            drawBar('Memnuniyet:', satisfaction, 100, (val) => `rgb(${255 - (val * 2.55)}, ${val * 2.55}, 0)`);
            drawBar('Enflasyon:', Math.min(inflation, 25), 25, (val, max) => `rgb(${(val/max) * 255}, ${255 - ((val/max) * 255)}, 0)`); // Max 25 gÃ¶ster
            drawBar('DÄ±ÅŸ Ä°liÅŸkiler:', foreignRelationsScore, 100, (val) => `rgb(0, ${val * 1.5}, ${255 - (val * 1.5)})`); // Renk ayarlandÄ±
            drawBar('SuÃ§ OranÄ±:', Math.min(crimeRate, 25), 25, (val, max) => `rgb(${(val/max) * 255}, ${150 - ((val/max) * 150)}, 0)`); // Renk ayarlandÄ±, max 25 gÃ¶ster
            drawBar('Ä°stikrar:', politicalStability, 100, (val) => `rgb(${val*0.5}, ${val * 2}, ${255 - val * 2})`);
        }

        function drawReportChart() {
            if (!reportChartCanvas || !reportChartCtx) return;
            reportChartCtx.clearRect(0, 0, reportChartCanvas.width, reportChartCanvas.height);
             const textColor = getComputedStyle(document.documentElement).getPropertyValue('--text-color');
            const borderColor = getComputedStyle(document.documentElement).getPropertyValue('--border-color');

            if (historicalData.weeks.length < 2) {
                reportChartCtx.font = '16px Arial';
                reportChartCtx.fillStyle = textColor;
                reportChartCtx.textAlign = 'center';
                reportChartCtx.fillText('Veri henÃ¼z yetersiz. En az 2 hafta gerekli.', reportChartCanvas.width / 2, reportChartCanvas.height / 2);
                return;
            }

            const padding = 40;
            const chartWidth = reportChartCanvas.width - (padding * 2);
            const chartHeight = reportChartCanvas.height - (padding * 2);
            
            if (chartWidth <= 0 || chartHeight <= 0) return; 

            reportChartCtx.beginPath();
            reportChartCtx.strokeStyle = borderColor;
            reportChartCtx.moveTo(padding, padding);
            reportChartCtx.lineTo(padding, reportChartCanvas.height - padding);
            reportChartCtx.lineTo(reportChartCanvas.width - padding, reportChartCanvas.height - padding);
            reportChartCtx.stroke();
            const dataPoints = Math.min(historicalData.weeks.length, 10);
            const startIndex = Math.max(0, historicalData.weeks.length - dataPoints);
            
            reportChartCtx.font = '12px Arial';
            reportChartCtx.fillStyle = textColor;
            reportChartCtx.textAlign = 'center';
            
            if (dataPoints > 1) { 
                for (let i = 0; i < dataPoints; i++) {
                    const x = padding + (i * (chartWidth / (dataPoints - 1)));
                    reportChartCtx.fillText(historicalData.weeks[startIndex + i].toString(), x, reportChartCanvas.height - padding + 20);
                }
            } else if (dataPoints === 1) { 
                 const x = padding + chartWidth / 2;
                 reportChartCtx.fillText(historicalData.weeks[startIndex].toString(), x, reportChartCanvas.height - padding + 20);
            }

            function drawLine(dataArray, color, maxValue = 100, normalize = false) {
                if (dataPoints === 0) return;
                reportChartCtx.beginPath();
                reportChartCtx.strokeStyle = color;
                reportChartCtx.lineWidth = 2;
                
                let valuesToNormalize = dataArray.slice(startIndex, startIndex + dataPoints);
                let minVal = 0, range = maxValue;

                if (normalize && valuesToNormalize.length > 0) {
                    minVal = Math.min(...valuesToNormalize);
                    let maxVal = Math.max(...valuesToNormalize);
                    range = maxVal - minVal;
                    if (range === 0) range = 1; // BÃ¶lme hatasÄ±nÄ± Ã¶nle
                }


                for (let i = 0; i < dataPoints; i++) {
                    const x = padding + (dataPoints > 1 ? (i * (chartWidth / (dataPoints - 1))) : chartWidth / 2);
                    let value = dataArray[startIndex + i];
                    let normalizedValue;

                    if (normalize) {
                        normalizedValue = (value - minVal) / range;
                    } else {
                        normalizedValue = Math.min(value, maxValue) / maxValue;
                    }
                    
                    const y = reportChartCanvas.height - padding - (normalizedValue * chartHeight);

                    if (i === 0) reportChartCtx.moveTo(x, y);
                    else reportChartCtx.lineTo(x, y);
                }
                reportChartCtx.stroke();
            }
            
            drawLine(historicalData.satisfaction, 'rgb(46, 204, 113)'); // Memnuniyet
            drawLine(historicalData.inflation, 'rgb(231, 76, 60)', 25); // Enflasyon (max 25%)
            drawLine(historicalData.gdp, 'rgb(52, 152, 219)', 0, true); // GSYÄ°H (normalize edilecek)
            drawLine(historicalData.politicalStability, 'rgb(155, 89, 182)', 100); // Siyasi Ä°stikrar


            reportChartCtx.font = '12px Arial'; // Lejant fontu kÃ¼Ã§Ã¼ltÃ¼ldÃ¼
            reportChartCtx.textAlign = 'left'; 
            reportChartCtx.fillStyle = 'rgb(46, 204, 113)';
            reportChartCtx.fillText('Memnuniyet', padding + 5, padding - 5);
            reportChartCtx.fillStyle = 'rgb(231, 76, 60)';
            reportChartCtx.fillText('Enflasyon', padding + 95, padding - 5);
            reportChartCtx.fillStyle = 'rgb(52, 152, 219)';
            reportChartCtx.fillText('GSYÄ°H', padding + 180, padding - 5);
             reportChartCtx.fillStyle = 'rgb(155, 89, 182)';
            reportChartCtx.fillText('Ä°stikrar', padding + 245, padding - 5);
        }

        function updateMinisterAdvice() {
            economyAdviceText.textContent = cabinet.economy.name === 'BoÅŸ' ? "AtanmadÄ±." : 
                (inflation > 15 ? "KRÄ°TÄ°K ENFLASYON! Acil sÄ±kÄ± para politikasÄ± ve mali disiplin!" : 
                (inflation > 8 ? "YÃ¼ksek enflasyon endiÅŸe verici. HarcamalarÄ± kontrol altÄ±na alÄ±n." : 
                (gdp < gdp * 0.05 && weeklyGdpChangeFactor < 1) ? "Ekonomik daralma var. TeÅŸvikleri dÃ¼ÅŸÃ¼nÃ¼n." : "Ekonomi stabil, mevcut politikalar sÃ¼rdÃ¼rÃ¼lebilir."));

            educationAdviceText.textContent = cabinet.education.name === 'BoÅŸ' ? "AtanmadÄ±." :
                (educationSpending < population * 0.2 ? "EÄŸitim yatÄ±rÄ±mlarÄ± yetersiz. Kalite dÃ¼ÅŸÃ¼yor, halk tepkili." :
                (educationSpending < population * 0.5 ? "EÄŸitim bÃ¼tÃ§esi artÄ±rÄ±lmalÄ±. GeleceÄŸe yatÄ±rÄ±m Ã¶nemli." : "EÄŸitim yatÄ±rÄ±mlarÄ± iyi durumda."));

            healthAdviceText.textContent = cabinet.health.name === 'BoÅŸ' ? "AtanmadÄ±." :
                (healthSpending < population * 0.3 ? "SaÄŸlÄ±k sistemi Ã§Ã¶kme noktasÄ±nda! Acil kaynak aktarÄ±n." :
                (healthSpending < population * 0.7 ? "SaÄŸlÄ±k hizmetleri geliÅŸtirilmeli. Halk saÄŸlÄ±ÄŸÄ± Ã¶nceliÄŸimiz." : "SaÄŸlÄ±k altyapÄ±mÄ±z gÃ¼Ã§lÃ¼."));
            
            foreignAdviceText.textContent = cabinet.foreign.name === 'BoÅŸ' ? "AtanmadÄ±." :
                (foreignRelationsScore < 25 ? "UluslararasÄ± izolasyonla karÅŸÄ± karÅŸÄ±yayÄ±z! Acil diplomatik aÃ§Ä±lÄ±m ÅŸart." :
                (foreignRelationsScore < 50 ? "DÄ±ÅŸ iliÅŸkilerimiz zayÄ±f. KomÅŸularla ve mÃ¼ttefiklerle iliÅŸkileri gÃ¼Ã§lendirin." : "Diplomatik konumumuz iyi. Mevcut stratejiyi koruyun."));

            interiorAdviceText.textContent = cabinet.interior.name === 'BoÅŸ' ? "AtanmadÄ±." :
                (crimeRate > 12 ? "SuÃ§ oranlarÄ± kontrolden Ã§Ä±ktÄ±! Emniyet teÅŸkilatÄ±nÄ± gÃ¼Ã§lendirin." :
                (securityPerception < 40 ? "Halk kendini gÃ¼vende hissetmiyor. GÃ¼venlik algÄ±sÄ±nÄ± artÄ±racak adÄ±mlar atÄ±n." : "Ä°Ã§ gÃ¼venlik durumu stabil."));

            justiceAdviceText.textContent = cabinet.justice.name === 'BoÅŸ' ? "AtanmadÄ±." :
                (politicalStability < 40 && crimeRate > 8 ? "Adalet sistemi iÅŸlemiyor, kaos kapÄ±da! Acil reform ve caydÄ±rÄ±cÄ±lÄ±k." :
                (crimeRate > 8 ? "Hukukun Ã¼stÃ¼nlÃ¼ÄŸÃ¼ zayÄ±f. YargÄ± reformu ve polis desteÄŸi gerekli." : "Adalet sistemi gÃ¶revini yapÄ±yor."));
            
            defenseAdviceText.textContent = cabinet.defense.name === 'BoÅŸ' ? "AtanmadÄ±." :
                (militaryStrengthIndex < 35 ? "Ordumuz zayÄ±f! Modernizasyon ve personel takviyesi acil ihtiyaÃ§." :
                (armyLoyalty < 50 ? "Ordu iÃ§inde huzursuzluk var! Sadakati artÄ±racak Ã¶nlemler alÄ±nmalÄ±." :
                (foreignRelationsScore < 30 && countries[Object.keys(countries).find(c => countries[c].relation < 15 && countries[c].militaryPower > militaryStrengthIndex*0.8)]) ? "SÄ±nÄ±rda gerginlik yÃ¼ksek, olasÄ± bir saldÄ±rÄ±ya karÅŸÄ± hazÄ±rlÄ±klÄ± olunmalÄ±!" :
                 "Savunma kapasitemiz yeterli. Ordunun moralini yÃ¼ksek tutun."));
        }

        function updateMinisterReports() {
            // Ekonomi Raporu
            inflationAnalysisEl.textContent = cabinet.economy.name === 'BoÅŸ' ? "AtanmadÄ±." : 
                (inflation > 15 ? "AÅŸÄ±rÄ± yÃ¼ksek enflasyon, hiperenflasyon riski! Acil mÃ¼dahale gerekli." : 
                 inflation > 8 ? "Ã‡ift haneli enflasyon, alÄ±m gÃ¼cÃ¼ dÃ¼ÅŸÃ¼yor, sosyal huzursuzluk artabilir." : 
                 inflation > 4 ? "Enflasyon hedefin Ã¼zerinde, dikkatli olunmalÄ±." : 
                 inflation < 1 ? "Deflasyon riski, ekonomik durgunluÄŸa yol aÃ§abilir." : "Enflasyon kontrol altÄ±nda.");
            gdpAnalysisEl.textContent = cabinet.economy.name === 'BoÅŸ' ? "AtanmadÄ±." :
                (gdp < population * 80 ? "Ciddi ekonomik kriz. GSYÄ°H Ã§ok dÃ¼ÅŸÃ¼k." :
                 (gdp < population * 120 && weeklyGdpChangeFactor < 1) ? "Ekonomik durgunluk veya hafif daralma." :
                 (weeklyGdpChangeFactor > 1.01) ? "GÃ¼Ã§lÃ¼ ekonomik bÃ¼yÃ¼me kaydediliyor." : "Ekonomi stabil veya yavaÅŸ bÃ¼yÃ¼yor.");
            economyRecommendationsEl.textContent = cabinet.economy.name === 'BoÅŸ' ? "AtanmadÄ±." : 
                (inflation > 10 && budget < 0 ? "Mali disiplin ÅŸart, vergileri artÄ±rÄ±p harcamalarÄ± kÄ±sÄ±n." : 
                 gdp < population*100 && inflation < 3 ? "Ekonomiyi canlandÄ±rmak iÃ§in teÅŸvikler ve yatÄ±rÄ±mlar dÃ¼ÅŸÃ¼nÃ¼lebilir." : "Dengeli politikalar sÃ¼rdÃ¼rÃ¼lmeli.");

            // Sosyal Politikalar
            educationQualityReportEl.textContent = educationSpending > population * 0.8 ? 'Ã‡ok Ä°yi' : educationSpending > population * 0.4 ? 'Ä°yi' : educationSpending > population * 0.1 ? 'Orta' : 'Yetersiz';
            healthQualityReportEl.textContent = healthSpending > population * 1 ? 'Ã‡ok Ä°yi' : healthSpending > population * 0.5 ? 'Ä°yi' : healthSpending > population * 0.2 ? 'Orta' : 'Yetersiz';
            holidayCountReportEl.textContent = nationalHolidays;
            socialRecommendationsEl.textContent = (educationQualityReportEl.textContent === 'Yetersiz' || healthQualityReportEl.textContent === 'Yetersiz') ? "Sosyal harcamalar artÄ±rÄ±lmalÄ±." : "Sosyal denge gÃ¶zetiliyor.";
            
            // Siyasi Rapor
            governmentSupportReportEl.textContent = `${satisfaction.toFixed(1)}%`;
            parliamentSupportReportEl.textContent = `${politicalSystem === 'Demokrasi' ? parliamentSupport.toFixed(1) : 'N/A'}%`;
            politicalStabilityReportEl.textContent = `${politicalStability.toFixed(1)}%`;
            politicalRecommendationsEl.textContent = politicalStability < 40 ? "Siyasi istikrarsÄ±zlÄ±k had safhada, acil uzlaÅŸÄ± ve reform gerekli." : "Siyasi ortam gÃ¶receli sakin.";
            
            // Askeri Rapor
            armyReadinessReportEl.textContent = militaryStrengthIndex > 70 ? "Ã‡ok YÃ¼ksek" : militaryStrengthIndex > 50 ? "YÃ¼ksek" : militaryStrengthIndex > 30 ? "Orta" : "DÃ¼ÅŸÃ¼k";
            armyLoyaltyReportEl.textContent = getArmyLoyaltyStatus();
            militaryAssessmentReportEl.textContent = cabinet.defense.name === 'BoÅŸ' ? "AtanmadÄ±." : "Genelkurmay, durumu deÄŸerlendiriyor. Detaylar iÃ§in Askeri Åura toplantÄ±sÄ± talep edin.";

            if(gdpChangeReportDisplayEl) gdpChangeReportDisplayEl.textContent = `${((weeklyGdpChangeFactor -1)*100).toFixed(2)}%`;
            if(inflationChangeReportDisplayEl) inflationChangeReportDisplayEl.textContent = `${weeklyInflationChange.toFixed(2)}%`;
        }

        function enableAllActionButtons(forceEnable = false) { // forceEnable parametresi eklendi
            const allButtons = document.querySelectorAll('button:not(.tab-btn):not(#restart-game-btn):not(#theme-toggle)');
            
            allButtons.forEach(button => {
                if (forceEnable) {
                    button.disabled = false;
                } else {
                    // Genel kural: BÃ¼tÃ§e yetersizse Ã§oÄŸu maliyetli buton pasif olmalÄ± (bu kontrol her butonun kendi iÃ§inde de var ama genel bir Ã¶nlem)
                    // Ã–rneÄŸin, butonun text iÃ§eriÄŸinden maliyetini alÄ±p kontrol edebiliriz (daha karmaÅŸÄ±k)
                    // Åimdilik genel mantÄ±k devam ediyor.
                    button.disabled = false; // VarsayÄ±lan olarak aktif
                }
            });
            
            // Siyasi sisteme Ã¶zel durumlar (forceEnable deÄŸilse geÃ§erli)
            if (!forceEnable) {
                if (politicalSystem === 'Demokrasi') {
                    declareDictatorshipBtn.disabled = satisfaction < 30 && armyLoyalty < 50; // DiktatÃ¶rlÃ¼k iÃ§in koÅŸullar zorlaÅŸtÄ±rÄ±ldÄ±
                    crackdownDissentBtn.disabled = true; 
                } else { // DiktatÃ¶rlÃ¼k
                    declareDictatorshipBtn.disabled = true; 
                    callElectionsBtn.disabled = true;
                    dissolveParliamentBtn.disabled = true; 
                    meetOppositionClosedBtn.disabled = true; 
                    meetOppositionOpenBtn.disabled = true;
                    proposeLawBtn.disabled = true; // Yasalar kararname ile
                }
            }
            sendSummitInvitationsBtn.disabled = !summitPlanned || summitInvitationsSent || getSelectedSummitInvitees().length === 0;
            createSummitBtn.disabled = summitPlanned; // Zirve planlÄ±ysa tekrar planlanamaz
        }


        function gameOver(reason, type = 'normal') { // type eklendi: normal, coup, civil_war
            addLog(`Oyun Bitti! ${reason}`, 'danger');
            enableAllActionButtons(false); 
            endWeekBtn.disabled = true;
            gameOverReasonEl.textContent = reason;
            finalWeekEl.textContent = week;
            finalPopulationEl.textContent = population.toLocaleString();
            finalGdpEl.textContent = gdp.toLocaleString();

            if (type === 'coup') {
                 gameOverReasonEl.innerHTML += "<br>Ordu yÃ¶netime el koydu!";
            } else if (type === 'civil_war') {
                 gameOverReasonEl.innerHTML += "<br>Ãœlke iÃ§ savaÅŸa sÃ¼rÃ¼klendi ve bÃ¶lÃ¼ndÃ¼!";
            }
            showScreen('game-over-screen');
        }

        function endWeek() {
            week++;
            historicalData.weeks.push(week);
            historicalData.gdp.push(gdp);
            historicalData.satisfaction.push(satisfaction);
            historicalData.inflation.push(inflation);
            historicalData.politicalStability.push(politicalStability);
            
            // --- BÃ¼tÃ§e ve Harcamalar ---
            let revenue = (population * gdp * (taxes / 520000) * (1 - cabinet.economy.corruption*0.5)); // Yolsuzluk vergiyi etkiler
            budget += revenue;
            let totalSpending = 0;
            totalSpending += (educationSpending * (1 + cabinet.education.corruption*0.8)); // Yolsuz bakanlar harcamayÄ± ÅŸiÅŸirir
            totalSpending += (healthSpending * (1 + cabinet.health.corruption*0.8));
            totalSpending += (cultureSpending * (1 + cabinet.economy.corruption*0.8)); // KÃ¼ltÃ¼r de yolsuzluktan etkilensin
            totalSpending += (socialPolicyLevel * 500000 * (1 + socialPolicyLevel/20)); // Daha yÃ¼ksek seviye daha maliyetli
            const armyMaintenance = armySize * armyUpkeepCostPerSoldier * (1 + (militaryStrengthIndex - 50) / 150) * (1 - cabinet.defense.efficiency*0.1 + cabinet.defense.corruption*0.3); // Verimsiz/yolsuz bakan maliyeti artÄ±rÄ±r
            totalSpending += armyMaintenance;
            budget -= totalSpending;
            weeklyBudgetChange = revenue - totalSpending;

            // --- Ekonomi ---
            let gdpGrowthFactor = (1 + (Math.random() - 0.45) * 0.004 * cabinet.economy.efficiency); // Ortalama bÃ¼yÃ¼me biraz daha pozitif
            gdpGrowthFactor *= (1 + (economicPolicyLevel - 5) * 0.0015);
            gdpGrowthFactor *= (1 - inflation/500); // YÃ¼ksek enflasyon bÃ¼yÃ¼meyi yavaÅŸlatÄ±r
            gdpGrowthFactor *= weeklyGdpChangeFactor;
            gdp *= gdpGrowthFactor;
            weeklyGdpChangeFactor = 1; 

            let inflationChange = (weeklyBudgetChange / gdp * 100) * 0.0003; // BÃ¼tÃ§e etkisi azaltÄ±ldÄ±
            inflationChange += (Math.random() - 0.5) * 0.08; 
            inflationChange += weeklyInflationChange;
            if (economicPolicyLevel > 6) inflationChange += (economicPolicyLevel - 6) * 0.15;
            else if (economicPolicyLevel < 4) inflationChange -= (4 - economicPolicyLevel) * 0.08;
            inflation += inflationChange;
            inflation = Math.max(0.05, Math.min(50, inflation)); // Max enflasyon arttÄ±
            weeklyInflationChange = 0;

            // --- NÃ¼fus ---
            let populationGrowthFactor = (1 + (satisfaction / 150000) - (inflation / 70000) + (healthSpending / gdp * 0.0002));
            populationGrowthFactor *= weeklyPopulationChangeFactor;
            population = Math.round(population * populationGrowthFactor);
            weeklyPopulationChangeFactor = 1;

            // --- Sosyal Durumlar ---
            let satisfactionDelta = weeklySatisfactionChange;
            satisfactionDelta -= (taxes / 60); 
            satisfactionDelta += (educationSpending / 600000 * cabinet.education.efficiency) + (healthSpending / 600000 * cabinet.health.efficiency) + (cultureSpending / 400000);
            satisfactionDelta += (socialPolicyLevel - 5) * 0.6;
            if (inflation > 6) satisfactionDelta -= (inflation - 6) * 0.25;
            if (crimeRate > 6) satisfactionDelta -= crimeRate * 0.6;
            if (securityLevel > 7 && politicalSystem === 'Demokrasi') satisfactionDelta -= (securityLevel - 7) * 0.4; // Demokraside daha tepki Ã§eker
            if (politicalSystem === 'DiktatÃ¶rlÃ¼k') satisfactionDelta -= 0.8; 
            satisfaction += satisfactionDelta;
            
            weeklySatisfactionChange = 0; 

            // --- Siyasi Ä°stikrar ---
            let stabilityDelta = weeklyPoliticalStabilityChange;
            stabilityDelta += (satisfaction - 60) / 20; // Memnuniyet istikrarÄ± etkiler
            stabilityDelta -= Math.abs(parliamentSupport - 50) / 25; // KutuplaÅŸmÄ±ÅŸ meclis istikrarÄ± bozar (Demokraside)
            if (politicalSystem === 'Demokrasi' && parliamentSupport < 30) stabilityDelta -= 2;
            if (politicalSystem === 'DiktatÃ¶rlÃ¼k') stabilityDelta += (armyLoyalty - 60) / 15; // DiktatÃ¶rlÃ¼kte ordu sadakati Ã¶nemli
            else if (politicalSystem === 'Demokrasi') stabilityDelta += (armyLoyalty - 70) / 25; // Demokraside de ordu huzuru Ã¶nemli
            if (crimeRate > 10) stabilityDelta -= (crimeRate - 10) * 0.3;
            politicalStability += stabilityDelta;
            politicalStability = Math.max(0, Math.min(100, politicalStability));
            weeklyPoliticalStabilityChange = 0;


            // --- GÃ¼venlik ---
            let crimeDelta = weeklyCrimeRateChange;
            crimeDelta -= (securityLevel - 4) * 0.12; 
            crimeDelta -= (militaryStrengthIndex / 1200); 
            crimeDelta += (100 - politicalStability) / 300; // Ä°stikrarsÄ±zlÄ±k suÃ§u artÄ±rÄ±r
            crimeRate += crimeDelta;
            crimeRate = Math.max(0.1, Math.min(30, crimeRate)); 
            weeklyCrimeRateChange = 0;
            
            let perceptionDelta = weeklySecurityPerceptionChange;
            perceptionDelta += (securityLevel - 5) * 0.6;
            perceptionDelta += (militaryStrengthIndex / 600);
            perceptionDelta -= crimeRate / 3; // YÃ¼ksek suÃ§ algÄ±yÄ± dÃ¼ÅŸÃ¼rÃ¼r
            securityPerception += perceptionDelta;
            securityPerception = Math.max(0, Math.min(100, securityPerception));
            weeklySecurityPerceptionChange = 0;

            // --- Askeri ---
            militaryStrengthIndex += weeklyMilitaryStrengthChange;
            militaryStrengthIndex = Math.max(10, Math.min(100, militaryStrengthIndex)); 
            weeklyMilitaryStrengthChange = 0;

            let loyaltyDelta = weeklyArmyLoyaltyChange;
            loyaltyDelta += (militaryStrengthIndex - 50) / 20; // GÃ¼Ã§lÃ¼ ordu daha sadÄ±k olabilir
            loyaltyDelta -= (100-politicalStability)/30; // Siyasi istikrarsÄ±zlÄ±k sadakati azaltÄ±r
            loyaltyDelta += (budget > 0 ? (armyMaintenance / budget * 5) : -5 ); // BÃ¼tÃ§eden pay ve bÃ¼tÃ§e durumu
            if (politicalSystem === 'DiktatÃ¶rlÃ¼k' && satisfaction < 30) loyaltyDelta -= 2; // HalkÄ± mutsuz diktatÃ¶re sadakat azalÄ±r
            armyLoyalty += loyaltyDelta;
            armyLoyalty = Math.max(0, Math.min(100, armyLoyalty));
            weeklyArmyLoyaltyChange = 0;


            // --- DÄ±ÅŸ Ä°liÅŸkiler ---
            let frDelta = weeklyForeignRelationsChange;
            frDelta += (diplomaticApproachLevel - 5) * 0.4; 
            if (politicalSystem === 'DiktatÃ¶rlÃ¼k') frDelta -= 0.2;
            foreignRelationsScore += frDelta;
            foreignRelationsScore = Math.max(0, Math.min(100, foreignRelationsScore));
            weeklyForeignRelationsChange = 0;

            // BakanlarÄ±n yolsuzluk etkisi bÃ¼tÃ§eye yansÄ±tÄ±ldÄ±, verimlilikleri de bazÄ± haftalÄ±k etkilere eklenebilir.
            satisfaction = Math.max(0, Math.min(100, satisfaction)); // Her zaman sÄ±nÄ±rla

            // --- Rastgele Olaylar ---
            if (Math.random() < 0.20) { // Ä°htimal arttÄ±
                triggerRandomEvent();
            }
            if (politicalSystem === 'Demokrasi' && Math.random() < 0.08 && week > 10) { 
                const meetingType = Math.random() < 0.5 ? 'kapalÄ±' : 'aÃ§Ä±k';
                if (confirm(`Muhalefet liderleri sizinle ${meetingType} bir gÃ¶rÃ¼ÅŸme talep ediyor. Kabul ediyor musunuz? (Ä°ptal etmek reddetmek anlamÄ±na gelir)`)) {
                    handleOppositionMeeting(false, meetingType === 'kapalÄ±'); 
                } else {
                    addLog("Muhalefetin gÃ¶rÃ¼ÅŸme talebini reddettiniz. Siyasi tansiyon arttÄ±.", "warning");
                    parliamentSupport = Math.max(0, parliamentSupport - 5);
                    weeklyPoliticalStabilityChange -= 3;
                    weeklySatisfactionChange -=2;
                }
            }

            // --- SeÃ§imler ---
            if (politicalSystem === 'Demokrasi' && week > 10 && week % (48 + Math.floor(Math.random()*9)) === 0 ) { // Ortalama 4 yÄ±lda bir (52 hafta)
                addLog('SEÃ‡Ä°M ZAMANI!', 'event');
                conductElections();
            }
            
            // Zirve SonuÃ§larÄ±
            if (summitPlanned && summitInvitationsSent && !endWeekBtn.disabled) { // Oyun bitmediyse
                let participatingCount = 0;
                let totalRelationBoostFromSummit = 0;
                getSelectedSummitInvitees().forEach(countryName => {
                     if (countries[countryName].summitAccepted) {
                        participatingCount++;
                        countries[countryName].relation = Math.min(100, countries[countryName].relation + 5 + Math.floor(diplomaticApproachLevel/2));
                        totalRelationBoostFromSummit += (2 + Math.floor(diplomaticApproachLevel/3));
                    } else {
                         countries[countryName].relation = Math.max(0, countries[countryName].relation - 2); // Reddedenle iliÅŸki hafif bozulur
                    }
                });

                if (participatingCount >= Math.max(1, getSelectedSummitInvitees().length / 2)) { 
                    addLog(`DÃ¼zenlediÄŸiniz zirve ${participatingCount} Ã¼lkenin katÄ±lÄ±mÄ±yla baÅŸarÄ±lÄ± oldu! DÄ±ÅŸ itibarÄ±nÄ±z ve iliÅŸkileriniz gÃ¼Ã§lendi.`, "success");
                    foreignRelationsScore = Math.min(100, foreignRelationsScore + 5 + totalRelationBoostFromSummit);
                    weeklySatisfactionChange += 3;
                    weeklyPoliticalStabilityChange += 2;
                } else if (participatingCount > 0) {
                    addLog(`DÃ¼zenlediÄŸiniz zirveye sadece ${participatingCount} Ã¼lke katÄ±ldÄ±. SÄ±nÄ±rlÄ± bir diplomatik etki yarattÄ±.`, "info");
                    foreignRelationsScore = Math.min(100, foreignRelationsScore + 2 + totalRelationBoostFromSummit/2);
                    weeklySatisfactionChange += 1;
                } else {
                    addLog("DÃ¼zenlediÄŸiniz zirveye hiÃ§bir Ã¼lke katÄ±lmadÄ±! Bu bÃ¼yÃ¼k bir diplomatik fiyasko.", "danger");
                    foreignRelationsScore = Math.max(0, foreignRelationsScore - 5 - getSelectedSummitInvitees().length); // BaÅŸarÄ±sÄ±zlÄ±k daha maliyetli
                    weeklySatisfactionChange -= 2;
                    weeklyPoliticalStabilityChange -=3;
                }
                summitPlanned = false; summitInvitationsSent = false;
                for (const countryName in countries) { countries[countryName].summitInvited = false; countries[countryName].summitAccepted = false; }
                updateSummitInvitationList(); createSummitBtn.disabled = false; sendSummitInvitationsBtn.disabled = true;
            }


            // --- Oyun Sonu KoÅŸullarÄ± (Daha detaylÄ±) ---
            if (satisfaction < 5 && politicalStability < 10 && week > 15) {
                gameOver('Halk isyan etti ve hÃ¼kÃ¼met devrildi! Ãœlkede kaos hakim.', 'normal'); return;
            }
            if (budget < -1500000000 && week > 25) {
                gameOver('Ãœlke iflas etti! UluslararasÄ± kuruluÅŸlar yÃ¶netime el koydu.', 'normal'); return;
            }
             if (population < 200000 && week > 20) { 
                gameOver('NÃ¼fus kritik seviyenin altÄ±na dÃ¼ÅŸtÃ¼. Ãœlke hayalet bir diyara dÃ¶ndÃ¼!', 'normal'); return;
            }
            if (politicalSystem === 'DiktatÃ¶rlÃ¼k' && armyLoyalty < 20 && politicalStability < 30 && week > 20) {
                 if (Math.random() < 0.6) { // %60 darbe ihtimali
                    gameOver('Ordu yÃ¶netime el koydu! DiktatÃ¶rlÃ¼ÄŸÃ¼nÃ¼z sona erdi.', 'coup'); return;
                 } else {
                     addLog("Ordu iÃ§inde ciddi bir huzursuzluk var, darbe sÃ¶ylentileri yayÄ±lÄ±yor!", "danger");
                     armyLoyalty = Math.max(0, armyLoyalty -10); // BaÅŸarÄ±sÄ±z darbe giriÅŸimi gibi
                 }
            }
            if (politicalStability < 5 && satisfaction < 15 && week > 20) {
                if (Math.random() < 0.4) { // %40 iÃ§ savaÅŸ ihtimali
                     gameOver('Ãœlke iÃ§ savaÅŸa sÃ¼rÃ¼klendi! FarklÄ± gruplar kontrolÃ¼ ele geÃ§irmeye Ã§alÄ±ÅŸÄ±yor.', 'civil_war'); return;
                } else {
                    addLog("Ãœlkede bÃ¼yÃ¼k Ã§aplÄ± protestolar ve Ã§atÄ±ÅŸmalar yaÅŸanÄ±yor. Ä°Ã§ savaÅŸ riski Ã§ok yÃ¼ksek!", "danger");
                    population -= Math.floor(population * 0.01); // Ã‡atÄ±ÅŸmalarda kayÄ±p
                    gdp *= 0.95; // Ekonomi zarar gÃ¶rÃ¼r
                }
            }
            if (foreignRelationsScore < 5 && week > 30 && politicalStability < 20) {
                let hostileNeighbor = Object.keys(countries).find(c => countries[c].relation < 10 && countries[c].militaryPower > militaryStrengthIndex * 0.7);
                if (hostileNeighbor && Math.random() < 0.25) { 
                    addLog(`${hostileNeighbor} Ã¼lkesi, iÃ§ karÄ±ÅŸÄ±klÄ±klarÄ±nÄ±zdan faydalanarak savaÅŸ ilan etti!`, 'danger');
                    simulateWar(hostileNeighbor, false, true); // isPlayerInitiated = false, isSurpriseAttack = true
                    return; // SavaÅŸ sonucu oyunu bitirebilir
                }
            }
            if (week >= 260 && politicalSystem === 'Demokrasi') { // YaklaÅŸÄ±k 5 yÄ±l
                addLog("Uzun ve baÅŸarÄ±lÄ± bir dÃ¶nem yÃ¶nettiniz. Halk sizi takdir ediyor. ArtÄ±k emekli olma zamanÄ±!", "success");
                gameOver("BaÅŸarÄ±yla emekli oldunuz!", "retirement"); return;
            }
             if (week >= 156 && politicalSystem === 'DiktatÃ¶rlÃ¼k' && satisfaction > 60 && politicalStability > 70) { // 3 yÄ±l baÅŸarÄ±lÄ± diktatÃ¶rlÃ¼k
                addLog("MutlakiyetÃ§i rejiminiz Ã¼lkeye istikrar getirdi. Ancak tarih sizi nasÄ±l yazacak?", "event");
                gameOver("SaltanatÄ±nÄ±zÄ± pekiÅŸtirdiniz.", "dictator_win"); return;
            }


            // HaftalÄ±k etkileri sÄ±fÄ±rla
            for (let key of Object.keys(globalThis).filter(k => k.startsWith('weekly') && typeof globalThis[k] === 'number')) {
                if(key !== 'weeklyGdpChangeFactor' && key !== 'weeklyPopulationChangeFactor') globalThis[key] = 0;
                else globalThis[key] = 1;
            }
            
            updateGameStats();
            updateMinisterAdvice();
            enableAllActionButtons(); 
        }

        function triggerRandomEvent() {
            const currentEvents = [
                { id:1, desc: 'BÃ¼yÃ¼k bir deprem Ã¼lkeyi sarstÄ±. AltyapÄ± hasar gÃ¶rdÃ¼, can kayÄ±plarÄ± var.', type: 'danger', effect: () => { budget -= population * 3 * (1-cabinet.interior.efficiency*0.3); weeklySatisfactionChange -= 10; weeklyGdpChangeFactor *= 0.97; population -= Math.floor(population*0.001); weeklyPoliticalStabilityChange -= 5;} },
                { id:2, desc: 'Bilim insanlarÄ±mÄ±z Ã§Ä±ÄŸÄ±r aÃ§an bir buluÅŸ yaptÄ±! UluslararasÄ± patent gelirleri bekleniyor.', type: 'success', effect: () => { weeklyGdpChangeFactor *= 1.01; weeklySatisfactionChange += 5; budget += 25000000; foreignRelationsScore +=2; } },
                { id:3, desc: `Kritik bir bakanlÄ±kta (${Object.keys(cabinet)[Math.floor(Math.random()*Object.keys(cabinet).length)]}) bÃ¼yÃ¼k bir yolsuzluk skandalÄ± patlak verdi! Halk Ã¶fkeli.`, type: 'danger', effect: () => { weeklySatisfactionChange -= 15; weeklyPoliticalStabilityChange -= 10; budget -= 15000000; foreignRelationsScore -=5; parliamentSupport = Math.max(10, parliamentSupport-10); } },
                { id:4, desc: 'KomÅŸu bir Ã¼lkeyle yapÄ±lan ortak tatbikat iliÅŸkileri gÃ¼Ã§lendirdi.', type: 'success', effect: () => { let friendlyNeighbor = Object.keys(countries).find(c => countries[c].relation > 60); if(friendlyNeighbor) {countries[friendlyNeighbor].relation = Math.min(100, countries[friendlyNeighbor].relation + 10); addLog(`${friendlyNeighbor} ile ortak tatbikat baÅŸarÄ±lÄ± geÃ§ti.`);} weeklyForeignRelationsChange += 5; militaryStrengthIndex +=1; } },
                { id:5, desc: 'Turizm sezonu beklenenden iyi geÃ§ti, dÃ¶viz girdisi arttÄ±.', type: 'success', effect: () => { budget += gdp * 0.005; weeklyGdpChangeFactor *= 1.003; weeklySatisfactionChange += 2;} },
                { id:6, desc: 'KÃ¼resel bir resesyon kapÄ±da. Ä°hracat gelirleri dÃ¼ÅŸebilir.', type: 'warning', effect: () => { weeklyGdpChangeFactor *= 0.985; weeklyInflationChange -= 0.2; weeklySatisfactionChange -=3;} },
                { id:7, desc: 'Ã–nemli bir ticaret yolu Ã¼zerinde tansiyon yÃ¼kseldi, ithalat maliyetleri arttÄ±.', type: 'warning', effect: () => { weeklyInflationChange += 0.8; budget -= population * 0.5; } },
                { id:8, desc: 'ÃœnlÃ¼ bir sanatÃ§Ä±nÄ±z uluslararasÄ± Ã¶dÃ¼l kazandÄ±, Ã¼lke tanÄ±tÄ±mÄ±na katkÄ± saÄŸladÄ±.', type: 'success', effect: () => { weeklySatisfactionChange += 4; cultureSpending += 500000; foreignRelationsScore +=3;} },
                { id:9, desc: 'Hackerlar devlet sÄ±rlarÄ±nÄ± sÄ±zdÄ±rdÄ±! GÃ¼venlik aÃ§Ä±ÄŸÄ± ve uluslararasÄ± kriz.', type: 'danger', effect: () => { weeklySecurityPerceptionChange -= 15; weeklyForeignRelationsChange -= 10; weeklyPoliticalStabilityChange -= 8; if(cabinet.interior.efficiency < 0.5) budget -= 10000000;} },
                { id:10, desc: 'GenÃ§ler arasÄ±nda popÃ¼ler olan yeni bir sosyal medya akÄ±mÄ±, toplumsal bilinci artÄ±rdÄ±.', type: 'info', effect: () => { weeklySatisfactionChange += 2; educationSpending += 300000;} },
                { id:11, desc: 'Nadir bir maden yataÄŸÄ± keÅŸfedildi! Ä°ÅŸlenmesi zaman alacak ama potansiyel bÃ¼yÃ¼k.', type: 'event', effect: () => { addLog("Yeni maden yataÄŸÄ± iÃ§in yatÄ±rÄ±m seÃ§enekleri deÄŸerlendiriliyor.", "info"); /* Sonraki haftalarda yatÄ±rÄ±m butonu aktif edilebilir */ weeklyGdpChangeFactor *=1.001; } },
                { id:12, desc: 'Bir grup ayrÄ±lÄ±kÃ§Ä± terÃ¶r saldÄ±rÄ±sÄ± dÃ¼zenledi. Halk paniÄŸe kapÄ±ldÄ±.', type: 'danger', effect: () => { weeklySatisfactionChange -=12; weeklySecurityPerceptionChange -=10; weeklyCrimeRateChange +=3; weeklyPoliticalStabilityChange -=7; armyLoyalty -=2; } },

            ];
            const randomEvent = currentEvents[Math.floor(Math.random() * currentEvents.length)];
            randomEvent.effect();
            addLog(`[OLAY] ${randomEvent.desc}`, randomEvent.type);
        }

        function conductElections() {
            if (politicalSystem !== 'Demokrasi') return;
            addLog('SeÃ§imler yapÄ±lÄ±yor... Oy verme iÅŸlemi tamamlandÄ±, sonuÃ§lar bekleniyor.', 'info');
            let electionOutcomeModifier = (politicalStability - 50) / 5; // Ä°stikrar sonucu etkiler
            electionOutcomeModifier += (cabinet.justice.efficiency - 0.5) * 10; // Adil seÃ§im algÄ±sÄ±
            
            // Son dÃ¶nemdeki bÃ¼yÃ¼k baÅŸarÄ±lar/baÅŸarÄ±sÄ±zlÄ±klar iÃ§in olay bazlÄ± bonus/ceza eklenebilir

            const effectiveSatisfaction = satisfaction + electionOutcomeModifier;

            if (effectiveSatisfaction >= 50 + Math.random()*10) { // Kazanma eÅŸiÄŸi biraz dinamik
                addLog('HalkÄ±n bÃ¼yÃ¼k Ã§oÄŸunluÄŸunun desteÄŸiyle seÃ§imleri kazandÄ±nÄ±z! GÃ¼ven tazelediniz.', 'success');
                parliamentSupport = Math.min(100, Math.max(50, parliamentSupport + 10 + Math.floor(Math.random()*15))); 
                satisfaction = Math.min(100, satisfaction + Math.floor(Math.random()*5)+2); 
                politicalStability = Math.min(100, politicalStability + 10 + Math.floor(Math.random()*10));
            } else if (effectiveSatisfaction >= 30 + Math.random()*10) {
                addLog('SeÃ§im sonuÃ§larÄ± belirsiz. Koalisyon gÃ¶rÃ¼ÅŸmeleri baÅŸladÄ± veya az farkla kazandÄ±nÄ±z. Meclis aritmetiÄŸi zorlu olacak.', 'warning');
                parliamentSupport = Math.max(25, Math.min(75, parliamentSupport - 5 - Math.floor(Math.random()*10))); 
                 politicalStability = Math.max(0, politicalStability - 5 - Math.floor(Math.random()*5));
            } else {
                addLog('AÄŸÄ±r bir seÃ§im yenilgisi aldÄ±nÄ±z. Halk deÄŸiÅŸim istedi ve iktidardan dÃ¼ÅŸtÃ¼nÃ¼z!', 'danger');
                gameOver('SeÃ§imleri kaybettiniz!');
                return;
            }
            updateGameStats();
        }


        function updateCabinetDisplay() {
            cabinetListEl.innerHTML = '';
            for (const type in cabinet) {
                const minister = cabinet[type];
                const listItem = document.createElement('li');
                listItem.innerHTML = `<strong>${capitalizeFirstLetter(type)} BakanÄ±:</strong> ${minister.name} (V: ${minister.efficiency.toFixed(1)}, Y: ${minister.corruption.toFixed(1)})`;
                cabinetListEl.appendChild(listItem);
            }
        }

        function capitalizeFirstLetter(string) {
            return string.charAt(0).toUpperCase() + string.slice(1);
        }

        function updateParliamentDisplay() {
            parliamentSupportEl.textContent = `${politicalSystem === 'Demokrasi' ? parliamentSupport.toFixed(0)+'%' : 'N/A'}`;
            oppositionStrengthDisplayEl.textContent = `${(politicalSystem === 'Demokrasi' ? (100 - parliamentSupport) : 0).toFixed(0)}%`;
            parliamentAgendaList.innerHTML = '';

            if (parliamentAgenda.length === 0 && politicalSystem === 'Demokrasi') {
                parliamentAgendaList.innerHTML = '<li>GÃ¼ndemde yeni bir yasa teklifi yok.</li>';
            } else if (politicalSystem === 'DiktatÃ¶rlÃ¼k') {
                parliamentAgendaList.innerHTML = '<li>Meclis etkisizleÅŸtirildi. Yasalar kararname ile Ã§Ä±karÄ±lÄ±r.</li>';
            }
            else {
                parliamentAgenda.forEach((item, index) => {
                    const listItem = document.createElement('li');
                    listItem.innerHTML = `<p>${item.description} (Red: ${item.rejectionCount || 0}/2)</p>
                                        <div>
                                          <button class="parliament-action-btn" data-action="approve" data-index="${index}">Onayla</button>
                                          <button class="parliament-action-btn" data-action="reject" data-index="${index}">Reddet</button>
                                        </div>`;
                    parliamentAgendaList.appendChild(listItem);
                });
            }

            document.querySelectorAll('.parliament-action-btn').forEach(btn => {
                btn.onclick = handleParliamentAction;
            });
        }

        function handleParliamentAction(event) {
            const index = parseInt(event.target.dataset.index);
            const action = event.target.dataset.action;
            const proposal = parliamentAgenda[index];

            if (!proposal || politicalSystem === 'DiktatÃ¶rlÃ¼k') return;

            let logMsg = "";
            if (action === 'approve') {
                const Ğ¿Ğ¾Ğ»Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ°ÑĞ’Ğ¾Ğ»Ñ = parliamentSupport + (politicalStability - 50)/5 - (proposal.rejectionCount * 15); // Siyasi irade
                const roll = Math.random() * 100;
                if (roll < Ğ¿Ğ¾Ğ»Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ°ÑĞ’Ğ¾Ğ»Ñ) {
                    proposal.onApprove();
                    logMsg = `Meclis, "${proposal.description}" yasasÄ±nÄ± onayladÄ±.`; addLog(logMsg, 'success');
                    parliamentSupport = Math.min(100, parliamentSupport + 5); 
                    politicalStability = Math.min(100, politicalStability + 3);
                    parliamentAgenda.splice(index, 1); 
                } else {
                    logMsg = `Meclis, "${proposal.description}" yasasÄ±nÄ± onaylamadÄ±. Muhalefet gÃ¼Ã§lÃ¼ Ã§Ä±ktÄ± veya yeterli destek bulunamadÄ±.`; addLog(logMsg, 'warning');
                    parliamentSupport = Math.max(0, parliamentSupport - 7); 
                    politicalStability = Math.max(0, politicalStability - 5);
                    proposal.rejectionCount = (proposal.rejectionCount || 0) + 1;
                    if (proposal.rejectionCount >= 2) {
                        addLog(`"${proposal.description}" yasasÄ± ikinci kez reddedildiÄŸi iÃ§in kesin olarak gÃ¼ndemden dÃ¼ÅŸtÃ¼! Bu durum siyasi kriz yaratabilir.`, 'danger');
                        parliamentAgenda.splice(index, 1);
                        weeklySatisfactionChange -=3; weeklyPoliticalStabilityChange -=5; // BaÅŸarÄ±sÄ±z yasa teklifi
                    }
                }
            } else { // Reject
                proposal.rejectionCount = (proposal.rejectionCount || 0) + 1;
                proposal.onReject();
                logMsg = `"${proposal.description}" yasasÄ± meclis tarafÄ±ndan reddedildi. Red SayÄ±sÄ±: ${proposal.rejectionCount}.`; addLog(logMsg, 'info');
                parliamentSupport = Math.max(0, parliamentSupport - 4); 
                 politicalStability = Math.max(0, politicalStability - 2);
                if (proposal.rejectionCount >= 2) {
                     addLog(`"${proposal.description}" yasasÄ± ikinci kez reddedildiÄŸi iÃ§in kesin olarak gÃ¼ndemden dÃ¼ÅŸtÃ¼!`, 'danger');
                     parliamentAgenda.splice(index, 1); 
                     weeklySatisfactionChange -=2; weeklyPoliticalStabilityChange -=4;
                }
            }
            updateParliamentDisplay();
            updateGameStats();
        }
        
        function handleOppositionMeeting(isPlayerInitiated, isClosed) {
            if (politicalSystem !== 'Demokrasi') {
                addLog("DiktatÃ¶rlÃ¼kte muhalefetle gÃ¶rÃ¼ÅŸme sÃ¶z konusu olamaz.", "danger");
                return;
            }
            const cost = isClosed ? 500000 : 200000;
            if(budget < cost && isPlayerInitiated) {
                addLog("Muhalefetle gÃ¶rÃ¼ÅŸme iÃ§in yeterli bÃ¼tÃ§e yok.", "warning");
                return;
            }
            if(isPlayerInitiated) { budget -= cost; weeklyBudgetChange -= cost; }

            let outcomeLog = `Muhalefet liderleriyle ${isClosed ? 'kapalÄ± kapÄ±lar ardÄ±nda' : 'kamuoyuna aÃ§Ä±k bir ÅŸekilde'} bir gÃ¶rÃ¼ÅŸme gerÃ§ekleÅŸtirdiniz. `;
            let satisfactionChange = 0;
            let supportChange = 0; // Meclis desteÄŸi
            let stabilityChange = 0;

            const rand = Math.random();
            // Muhalefetle gÃ¶rÃ¼ÅŸme senaryolarÄ±
            if (politicalStability < 30 || satisfaction < 30) { // Ãœlke zaten karÄ±ÅŸÄ±ksa
                if (rand < 0.6) { // KÃ¶tÃ¼ye gitme ihtimali yÃ¼ksek
                    outcomeLog += "Ancak mevcut kriz ortamÄ±nda gÃ¶rÃ¼ÅŸmeden bir sonuÃ§ Ã§Ä±kmadÄ±, aksine tansiyon daha da yÃ¼kseldi. Muhalefet sizi istifaya Ã§aÄŸÄ±rdÄ±.";
                    satisfactionChange = isClosed ? -3 : -5;
                    supportChange = isClosed ? -4 : -6;
                    stabilityChange = -7;
                } else {
                    outcomeLog += "Zorlu koÅŸullara raÄŸmen, bazÄ± konularda geÃ§ici bir ateÅŸkes saÄŸlanmÄ±ÅŸ gibi gÃ¶rÃ¼nÃ¼yor. Ancak gÃ¼vensizlik devam ediyor.";
                    satisfactionChange = isClosed ? 1 : 0;
                    supportChange = isClosed ? 2 : 1;
                    stabilityChange = 2;
                }
            } else { // Daha stabil bir ortamda
                 if (rand < 0.2) { 
                    outcomeLog += "GÃ¶rÃ¼ÅŸme beklenmedik bir ÅŸekilde Ã§ok sert geÃ§ti. Muhalefet uzlaÅŸmaz bir tavÄ±r sergiledi.";
                    satisfactionChange = isClosed ? -2 : -3;
                    supportChange = isClosed ? -3 : -5;
                    stabilityChange = -4;
                } else if (rand < 0.7) { 
                    outcomeLog += "YapÄ±cÄ± bir diyalog kuruldu, bazÄ± ortak noktalar bulundu ancak somut bir ilerleme kaydedilemedi.";
                    satisfactionChange = isClosed ? 1 : 0;
                    supportChange = isClosed ? 2 : 1;
                    stabilityChange = isClosed ? 2 : 1;
                } else { 
                    outcomeLog += "GÃ¶rÃ¼ÅŸme son derece olumlu geÃ§ti! Muhalefet bazÄ± politikalarÄ±nÄ±za destek vereceÄŸini aÃ§Ä±kladÄ±, ulusal birlik mesajlarÄ± verildi.";
                    satisfactionChange = isClosed ? 3 : 5;
                    supportChange = isClosed ? 6 : 8;
                    stabilityChange = isClosed ? 4 : 6;
                }
            }


            if (isClosed) {
                outcomeLog += " GÃ¶rÃ¼ÅŸmenin detaylarÄ± gizli tutuldu, bu da bazÄ± spekÃ¼lasyonlara yol aÃ§tÄ±.";
                satisfactionChange -=1; // Gizlilik hafif memnuniyetsizlik yaratÄ±r
            } else {
                outcomeLog += " GÃ¶rÃ¼ÅŸme sonrasÄ± ortak bir basÄ±n toplantÄ±sÄ± dÃ¼zenlendi.";
            }

            addLog(outcomeLog, satisfactionChange > 1 ? 'success' : (satisfactionChange < -1 ? 'danger' : 'info'));
            weeklySatisfactionChange += satisfactionChange;
            parliamentSupport = Math.min(100, Math.max(0, parliamentSupport + supportChange));
            weeklyPoliticalStabilityChange += stabilityChange;
            updateGameStats();
        }

        function updateForeignRelationsDisplay() {
            foreignRelationsDisplayEl.textContent = foreignRelationsScore.toFixed(0);
            countryRelationsList.innerHTML = '';
            for (const countryName in countries) {
                const country = countries[countryName];
                const listItem = document.createElement('li');
                let status = '';
                let color = '';
                if (country.relation >= 75) { status = 'MÃ¼ttefik'; color = 'var(--success-color)'; }
                else if (country.relation >= 50) { status = 'Dostane'; color = 'var(--primary-color)'; }
                else if (country.relation >= 25) { status = 'NÃ¶tr'; color = 'var(--warning-color)'; }
                else { status = 'Gergin'; color = 'var(--danger-color)'; }

                listItem.innerHTML = `
                    <span title="Askeri GÃ¼Ã§: ${country.militaryPower}">${countryName}: ${status} (<span style="color:${color};">${country.relation.toFixed(0)}</span>) ${country.tradeDeal ? '[Tic.Anl.]' : ''}</span>
                    <div>
                        <button class="foreign-action-btn" data-country="${countryName}" data-action="trade">Tic.Anl.</button>
                        <button class="foreign-action-btn" data-country="${countryName}" data-action="improve_specific" title="Ä°liÅŸki GeliÅŸtir ($1M)">Ä°yi Niyet</button>
                        <button class="foreign-action-btn" data-country="${countryName}" data-action="harm_specific" title="Ä°liÅŸki Boz ($500K)">Nota Ver</button>
                        ${country.relation < 20 || (country.relation < 30 && militaryStrengthIndex > country.militaryPower + 20 && diplomaticApproachLevel < 4) ? `<button class="foreign-action-btn" style="background-color:var(--danger-color);" data-country="${countryName}" data-action="declare-war-specific">SavaÅŸ Ä°lan Et</button>` : ''}
                    </div>
                `;
                countryRelationsList.appendChild(listItem);
            }

            document.querySelectorAll('.foreign-action-btn').forEach(btn => {
                btn.onclick = handleForeignAction;
            });
        }
        
        function handleForeignAction(event) {
            const countryName = event.target.dataset.country;
            const action = event.target.dataset.action;
            const country = countries[countryName];

            if (!country) return;
            let cost = 0;
            let successChance = 0;

            if (action === 'trade') {
                if (country.tradeDeal) {
                    addLog(`${countryName} ile zaten bir ticaret anlaÅŸmanÄ±z var.`, 'warning'); return;
                }
                cost = 3000000;
                if (country.relation < 25 && diplomaticApproachLevel < 5) {
                     addLog(`${countryName} ile iliÅŸkileriniz Ã§ok kÃ¶tÃ¼ ve diplomatik yaklaÅŸÄ±mÄ±nÄ±z sert. Ticaret anlaÅŸmasÄ± ÅŸu an iÃ§in mÃ¼mkÃ¼n gÃ¶rÃ¼nmÃ¼yor.`, 'danger'); return;
                }
                successChance = country.relation + diplomaticApproachLevel * 5 + (cabinet.foreign.efficiency - 0.5)*20 - 20; // BaÅŸarÄ± ÅŸansÄ±
                
                if (budget >= cost) {
                    budget -= cost; weeklyBudgetChange -= cost;
                    if (Math.random() * 100 < successChance) {
                        country.relation = Math.min(100, country.relation + 10 + Math.floor(diplomaticApproachLevel/2)); 
                        country.tradeDeal = true;
                        weeklyGdpChangeFactor *= 1.002; 
                        foreignRelationsScore = Math.min(100, foreignRelationsScore + 3);
                        addLog(`${countryName} ile yeni bir ticaret anlaÅŸmasÄ± imzalandÄ±! Ekonomi ve iliÅŸkiler olumlu etkilendi.`, 'success');
                    } else {
                         addLog(`${countryName} ile ticaret anlaÅŸmasÄ± mÃ¼zakereleri baÅŸarÄ±sÄ±z oldu. Belki daha iyi bir diplomatik yaklaÅŸÄ±mla tekrar denenebilir.`, 'warning');
                         country.relation = Math.max(0, country.relation -3); // BaÅŸarÄ±sÄ±zlÄ±k iliÅŸkiyi hafif bozar
                    }
                } else { addLog(`Ticaret anlaÅŸmasÄ± iÃ§in yeterli bÃ¼tÃ§e yok! ($${cost.toLocaleString()})`, 'warning'); }

            } else if (action === 'improve_specific') {
                cost = 1000000;
                if (budget >= cost) {
                    budget -= cost; weeklyBudgetChange -= cost;
                    let improvement = Math.floor(Math.random()*3) + 3 + Math.floor(diplomaticApproachLevel/2) + Math.floor((cabinet.foreign.efficiency-0.5)*5);
                    country.relation = Math.min(100, country.relation + improvement);
                    foreignRelationsScore = Math.min(100, foreignRelationsScore + Math.floor(improvement/3));
                    addLog(`${countryName} ile iliÅŸkileri geliÅŸtirmek iÃ§in yapÄ±lan diplomatik jest olumlu karÅŸÄ±landÄ±. Ä°liÅŸki ${improvement} puan arttÄ±.`, 'info');
                } else { addLog('Ä°yi niyet jesti iÃ§in yetersiz bÃ¼tÃ§e.', 'warning'); }

            } else if (action === 'harm_specific') { // Nota vermek
                 cost = 500000;
                if (budget >= cost) {
                    budget -= cost; weeklyBudgetChange -= cost;
                    let harm = Math.floor(Math.random()*4) + 4 + Math.floor((10-diplomaticApproachLevel)/2) - Math.floor((cabinet.foreign.efficiency-0.5)*3);
                    country.relation = Math.max(0, country.relation - harm);
                    foreignRelationsScore = Math.max(0, foreignRelationsScore - Math.floor(harm/4));
                    addLog(`${countryName}'ye sert bir diplomatik nota verdiniz. Ä°liÅŸkiler ${harm} puan geriledi.`, 'warning');
                    if(country.relation < 15 && country.tradeDeal){ // Ticaret anlaÅŸmasÄ± varsa ve iliÅŸkiler Ã§ok bozulursa
                        country.tradeDeal = false;
                        addLog(`${countryName} ile olan ticaret anlaÅŸmanÄ±z askÄ±ya alÄ±ndÄ±!`, 'danger');
                        weeklyGdpChangeFactor *= 0.998;
                    }
                } else { addLog('Diplomatik nota iÃ§in yetersiz bÃ¼tÃ§e.', 'warning'); }

            } else if (action === 'declare-war-specific') {
                 handleDeclareWar(countryName); // AyrÄ± fonksiyona taÅŸÄ±dÄ±m
            }
            updateForeignRelationsDisplay();
            updateGameStats();
        }
        
        function handleDeclareWar(targetCountryName) {
            const target = countries[targetCountryName];
            addLog(`SavaÅŸ Konseyi ToplanÄ±yor: ${targetCountryName}'e savaÅŸ ilan etme kararÄ± deÄŸerlendiriliyor...`, "event");

            // Genelkurmay GÃ¶rÃ¼ÅŸÃ¼
            let militaryAssessment = "Genelkurmay BaÅŸkanÄ±: ";
            const powerRatio = militaryStrengthIndex / target.militaryPower;
            if (powerRatio > 1.5 && armyLoyalty > 70) militaryAssessment += `"${targetCountryName} karÅŸÄ±sÄ±nda net bir askeri Ã¼stÃ¼nlÃ¼ÄŸÃ¼mÃ¼z var. HÄ±zlÄ± bir zafer muhtemel. Ordu hazÄ±r!"`;
            else if (powerRatio > 1.1 && armyLoyalty > 50) militaryAssessment += `"${targetCountryName} ile denk gÃ¼Ã§teyiz ancak iyi bir stratejiyle kazanabiliriz. Lojistik destek Ã¶nemli."`;
            else if (armyLoyalty < 40) militaryAssessment += `"Ordu iÃ§inde moral bozukluÄŸu ve itaatsizlik sÃ¶ylentileri var. Åu anda bir savaÅŸa girmek bÃ¼yÃ¼k risk taÅŸÄ±r!"`;
            else militaryAssessment += `"${targetCountryName} gÃ¼Ã§lÃ¼ bir rakip. Bu savaÅŸ uzun ve yÄ±pratÄ±cÄ± olabilir. KayÄ±plarÄ±mÄ±z aÄŸÄ±r olabilir. Ã‡ok dikkatli dÃ¼ÅŸÃ¼nÃ¼lmeli."`;
            addLog(militaryAssessment, armyLoyalty < 40 || powerRatio < 1.1 ? 'warning' : 'info');

            // Kabine GÃ¶rÃ¼ÅŸleri
            addLog(`Savunma BakanÄ± (${cabinet.defense.name}): "${cabinet.defense.efficiency > 0.6 ? 'Ordu emirlerinizi bekliyor!' : 'SavaÅŸ iÃ§in ek kaynak ve zamana ihtiyacÄ±mÄ±z olabilir...'}"`, 'info');
            addLog(`DÄ±ÅŸiÅŸleri BakanÄ± (${cabinet.foreign.name}): "${cabinet.foreign.efficiency > 0.6 && diplomaticApproachLevel > 5 ? 'Diplomatik izolasyon riskini iyi hesaplamalÄ±yÄ±z ama ulusal Ã§Ä±karlarÄ±mÄ±z iÃ§in gerekliyse...' : 'Bu savaÅŸÄ±n uluslararasÄ± yankÄ±larÄ± Ã§ok aÄŸÄ±r olabilir! TÃ¼m diplomatik kanallarÄ± zorlamalÄ±yÄ±z.'}"`, 'info');
            addLog(`Ekonomi BakanÄ± (${cabinet.economy.name}): "SavaÅŸ ekonomisi iÃ§in ek bÃ¼tÃ§e ve kaynak planlamasÄ± yapÄ±lmalÄ±. Uzun sÃ¼rmesi halinde enflasyon ve borÃ§lanma artabilir."`, 'warning');

            // HalkÄ±n Ä°lk Tepkisi (SavaÅŸ ilan edilmeden Ã¶nce bir nabÄ±z yoklama gibi)
            let initialPublicReaction = "Halk arasÄ±nda savaÅŸ sÃ¶ylentileri endiÅŸe yaratÄ±yor. ";
            if (target.relation < 10 && satisfaction > 60) initialPublicReaction += "Ancak bir kesim, 'dÃ¼ÅŸman' olarak gÃ¶rÃ¼len bu Ã¼lkeye karÅŸÄ± sert bir duruÅŸu destekliyor.";
            else if (satisfaction < 40) initialPublicReaction += "Zaten zor durumda olan halk, yeni bir maceraya girilmesine kesinlikle karÅŸÄ±.";
            else initialPublicReaction += "Kamuoyu kararsÄ±z, liderliÄŸinizin ikna edici olmasÄ± gerekecek.";
            addLog(initialPublicReaction, 'info');


            if (!confirm(`${targetCountryName}'e savaÅŸ ilan etmek istediÄŸinize emin misiniz? Bu kararÄ±n geri dÃ¶nÃ¼ÅŸÃ¼ olmayabilir!`)) {
                addLog("SavaÅŸ ilan etmekten vazgeÃ§ildi.", "info");
                return;
            }

            // SAVAÅ BAÅLADI
            const cost = 50000000 + (armySize * 120) + (target.militaryPower * 100000); // SavaÅŸ maliyeti arttÄ±
            if (budget < cost) {
                addLog(`SavaÅŸ baÅŸlatmak iÃ§in yeterli bÃ¼tÃ§e yok! Gerekli: $${cost.toLocaleString()}`, 'danger');
                return;
            }
            budget -= cost; weeklyBudgetChange -= cost;

            addLog(`${targetCountryName} Ã¼lkesine resmen savaÅŸ ilan edildi! TANRI YARDIMCIMIZ OLSUN!`, 'danger');
            weeklySatisfactionChange -= (15 - Math.floor(satisfaction/10) + (diplomaticApproachLevel > 7 ? 5: 0)); // Memnuniyet dÃ¼ÅŸÃ¼ÅŸÃ¼, mevcut memnuniyete ve barÄ±ÅŸÃ§Ä±l olup olmamamÄ±za gÃ¶re
            politicalStability = Math.max(0, politicalStability - 10 - Math.floor(Math.random()*10));
            foreignRelationsScore = Math.max(0, foreignRelationsScore - 25);
            armyLoyalty += 5; // SavaÅŸ baÅŸÄ±nda sadakat artabilir (ya da tam tersi, senaryoya gÃ¶re)
            
            // DiÄŸer Ã¼lkelerin tepkileri
            for(const otherCountryName in countries){
                if(otherCountryName !== targetCountryName){
                    if(countries[otherCountryName].relation > 60 && countries[targetCountryName].relation < 30){ // MÃ¼ttefikimizse ve hedef dÃ¼ÅŸmansa
                        countries[otherCountryName].relation = Math.min(100, countries[otherCountryName].relation + 5);
                        addLog(`${otherCountryName} savaÅŸ kararÄ±nÄ±zÄ± desteklediÄŸini aÃ§Ä±kladÄ±.`, 'success');
                    } else if (countries[otherCountryName].relation < 30 || countries[otherCountryName].relation < countries[targetCountryName].relation + 20) { // Bize zaten kÄ±zgÄ±nsa veya hedefe daha yakÄ±nsa
                        countries[otherCountryName].relation = Math.max(0, countries[otherCountryName].relation - 10);
                        addLog(`${otherCountryName} savaÅŸ kararÄ±nÄ±zÄ± kÄ±nadÄ± ve ${targetCountryName}'e destek verebileceÄŸini ima etti.`, 'danger');
                         if(Math.random() < 0.2 && countries[otherCountryName].militaryPower > 30) { // %20 ihtimalle hedefe destek
                            countries[targetCountryName].militaryPower += Math.floor(countries[otherCountryName].militaryPower * 0.1);
                            addLog(`${otherCountryName}, ${targetCountryName}'e askeri malzeme gÃ¶nderdi!`, 'danger');
                        }
                    } else { // NÃ¶trler
                         countries[otherCountryName].relation = Math.max(0, countries[otherCountryName].relation - 3);
                         addLog(`${otherCountryName} savaÅŸ kararÄ±nÄ±zdan endiÅŸe duyduÄŸunu belirtti.`, 'warning');
                    }
                }
            }
            updateForeignRelationsDisplay();
            simulateWar(targetCountryName, true, false); // isPlayerInitiated = true, isSurprise = false
        }


        function simulateWar(targetCountry, isPlayerInitiated, isSurpriseAttack = false) {
            addLog(`${targetCountry} ile ${isSurpriseAttack ? 'ani bir saldÄ±rÄ± sonucu ' : ''}savaÅŸ tÃ¼m ÅŸiddetiyle devam ediyor...`, 'danger');
            
            let playerEffectivePower = militaryStrengthIndex * (armySize / 10000) * (cabinet.defense.efficiency || 0.6) * (armyLoyalty/100);
            if(isSurpriseAttack && !isPlayerInitiated) playerEffectivePower *= 0.8; // SÃ¼rpriz saldÄ±rÄ±ya uÄŸrarsak dezavantaj
            if(isSurpriseAttack && isPlayerInitiated) playerEffectivePower *= 1.1; // SÃ¼rpriz saldÄ±rÄ± yaparsak avantaj

            let enemyMilitaryPower = countries[targetCountry].militaryPower * (Math.random() * 0.4 + 0.8); // DÃ¼ÅŸman gÃ¼cÃ¼nde biraz rastgelelik
             // EÄŸer dÃ¼ÅŸmanÄ±n mÃ¼ttefikleri varsa (basit bir kontrol)
            Object.keys(countries).forEach(allyCand => {
                if (allyCand !== targetCountry && countries[allyCand].relation > 70 && countries[targetCountry].relation < 30 && countries[allyCand].relation > countries[targetCountry].relation + 30) { // Hedefin mÃ¼ttefiki ve bize dÃ¼ÅŸman
                    if(Math.random() < 0.3) { // %30 ihtimalle savaÅŸa katÄ±lÄ±r
                        addLog(`${allyCand}, ${targetCountry} safÄ±nda savaÅŸa katÄ±ldÄ±ÄŸÄ±nÄ± duyurdu!`, "danger");
                        enemyMilitaryPower += countries[allyCand].militaryPower * 0.5; // MÃ¼ttefik gÃ¼cÃ¼nÃ¼n yarÄ±sÄ± eklenir
                        countries[allyCand].relation = Math.max(0, countries[allyCand].relation - 50); // O mÃ¼ttefikle de aramÄ±z bozulur
                    }
                }
            });


            const outcomeRoll = Math.random() * (isPlayerInitiated ? 1.05 : 0.95); // SaldÄ±ran tarafÄ±n hafif avantajÄ±/dezavantajÄ±
            let resultDescription = "";
            let warDuration = Math.floor(Math.random() * 5) + 3; // SavaÅŸ 3-7 hafta sÃ¼rsÃ¼n (basit model)
            
            addLog(`SavaÅŸÄ±n ${warDuration} hafta sÃ¼rmesi bekleniyor. Her hafta durum gÃ¼ncellenecek.`, "event");

            let currentWarWeek = 0;
            const warInterval = setInterval(() => {
                currentWarWeek++;
                if(currentWarWeek > warDuration || budget < 0 || armySize < 5000) { // SavaÅŸ bitirme koÅŸullarÄ±
                    clearInterval(warInterval);
                    // Nihai sonuÃ§ burada belirlenir
                    if (playerEffectivePower * (outcomeRoll + 0.1) > enemyMilitaryPower * (1 - outcomeRoll + 0.1) ) { 
                        resultDescription = `UZUN VE ZORLU MÃœCADELENÄ°N ARDINDAN ZAFER! ${targetCountry} dize getirildi. BarÄ±ÅŸ anlaÅŸmasÄ± imzalandÄ±.`;
                        weeklyGdpChangeFactor *= 1.01; 
                        weeklySatisfactionChange += (isPlayerInitiated ? 5 : 10) + Math.floor(armyLoyalty/20); 
                        budget += 50000000 + Math.floor(Math.random() * 80000000); 
                        weeklyBudgetChange += 50000000;
                        countries[targetCountry].relation = Math.max(0, countries[targetCountry].relation - 40); 
                        countries[targetCountry].militaryPower = Math.max(10, countries[targetCountry].militaryPower * 0.6); // DÃ¼ÅŸman ordusu zayÄ±flar
                        if(isPlayerInitiated) foreignRelationsScore = Math.max(0, foreignRelationsScore -5); 
                        else foreignRelationsScore = Math.min(100, foreignRelationsScore + 8); 
                        militaryStrengthIndex = Math.max(10, militaryStrengthIndex - (5 + Math.floor(Math.random()*5))); 
                        armySize = Math.max(10000, armySize - Math.floor(armySize * (0.03 + Math.random()*0.08))); 
                        politicalStability = Math.min(100, politicalStability + 5);
                        addLog(resultDescription, 'success');
                    } else if (playerEffectivePower * (outcomeRoll + 0.3) < enemyMilitaryPower * (1-outcomeRoll + 0.3) && (outcomeRoll < 0.4 || armyLoyalty < 30) ) { 
                        resultDescription = `ACI BÄ°R YENÄ°LGÄ°! ${targetCountry} ordularÄ± baÅŸkente dayandÄ±. AÄŸÄ±r ÅŸartlarda bir ateÅŸkes imzalandÄ±. Toprak ve itibar kaybettik.`;
                        weeklyGdpChangeFactor *= 0.92;
                        weeklySatisfactionChange -= (isPlayerInitiated ? 30 : 20) - Math.floor(armyLoyalty/10);
                        budget -= (30000000 + Math.floor(Math.random() * 40000000));
                        weeklyBudgetChange -= 30000000;
                        countries[targetCountry].relation = Math.min(100, countries[targetCountry].relation + 30);
                        foreignRelationsScore = Math.max(0, foreignRelationsScore - (isPlayerInitiated ? 20 : 10));
                        militaryStrengthIndex = Math.max(5, militaryStrengthIndex - (15 + Math.floor(Math.random()*10)));
                        armySize = Math.max(5000, armySize - Math.floor(armySize * (0.1 + Math.random()*0.15)));
                        politicalStability = Math.max(0, politicalStability - 20 - Math.floor(Math.random()*10));
                        if(politicalStability < 10) gameOver("SavaÅŸ yenilgisi sonrasÄ± Ã§Ä±kan iÃ§ karÄ±ÅŸÄ±klÄ±klar nedeniyle hÃ¼kÃ¼metiniz devrildi!", "civil_war");
                        else addLog(resultDescription, 'danger');
                    } else { 
                        resultDescription = `SavaÅŸ ${targetCountry} ile kanlÄ± bir Ã§Ä±kmaza girdi. Ä°ki taraf da korkunÃ§ kayÄ±plar verdi. SÄ±nÄ±rlar deÄŸiÅŸmedi ama barÄ±ÅŸÄ±n maliyeti aÄŸÄ±r oldu.`;
                        weeklyGdpChangeFactor *= 0.96;
                        weeklySatisfactionChange -= (10 + Math.floor(Math.random()*5));
                        militaryStrengthIndex = Math.max(10, militaryStrengthIndex - (10 + Math.floor(Math.random()*8)));
                        armySize = Math.max(8000, armySize - Math.floor(armySize * (0.05 + Math.random()*0.1)));
                        politicalStability = Math.max(0, politicalStability - 10);
                        addLog(resultDescription, 'warning');
                    }
                    updateGameStats();
                    updateForeignRelationsDisplay();
                    enableAllActionButtons(); // SavaÅŸ bitince butonlarÄ± tekrar aktif et
                    return;
                }

                // SavaÅŸÄ±n her haftasÄ± iÃ§in:
                let weeklyPlayerCasualties = Math.floor(armySize * (0.005 + Math.random()*0.015) * (enemyMilitaryPower / (playerEffectivePower*2+1)));
                let weeklyEnemyCasualtiesReported = Math.floor(countries[targetCountry].militaryPower * (0.005 + Math.random()*0.015) * (playerEffectivePower / (enemyMilitaryPower*2+1))); // Bildirilen
                
                armySize = Math.max(5000, armySize - weeklyPlayerCasualties);
                // DÃ¼ÅŸman kayÄ±plarÄ± direkt dÃ¼ÅŸman gÃ¼cÃ¼nden dÃ¼ÅŸÃ¼lebilir ama bu oyunda takip edilmiyor, sadece loglanÄ±r.
                
                playerEffectivePower *= (0.98 - weeklyPlayerCasualties / (armySize + weeklyPlayerCasualties + 1)); // YÄ±pranma
                enemyMilitaryPower *= (0.985 - weeklyEnemyCasualtiesReported / (countries[targetCountry].militaryPower + 1));


                budget -= armySize * 20; // HaftalÄ±k savaÅŸ maliyeti
                weeklySatisfactionChange -= 0.5; // SavaÅŸ uzadÄ±kÃ§a memnuniyetsizlik
                militaryStrengthIndex = Math.max(10, militaryStrengthIndex * 0.99); // TecrÃ¼be vs yÄ±pranma

                addLog(`SavaÅŸÄ±n ${currentWarWeek}. haftasÄ±: ${weeklyPlayerCasualties.toLocaleString()} asker kaybettik. DÃ¼ÅŸmanÄ±n ${weeklyEnemyCasualtiesReported.toLocaleString()} asker kaybettiÄŸi rapor edildi. Cephede durum zorlu.`, "warning");
                updateGameStats(); // Her hafta istatistikleri gÃ¼ncelle

            }, 3000); // Her 3 saniyede bir savaÅŸ haftasÄ± (simÃ¼lasyon hÄ±zÄ±)
            enableAllActionButtons(false); // SavaÅŸ sÄ±rasÄ±nda diÄŸer eylemler kÄ±sÄ±tlÄ±
            endWeekBtn.disabled = true; // SavaÅŸ bitene kadar hafta sonu butonu pasif
        }

        function updateSummitInvitationList() {
            summitInvitationListEl.innerHTML = '';
            let selectedCount = 0;
            for (const countryName in countries) {
                if(countries[countryName].summitInvited) selectedCount++;
            }

            for (const countryName in countries) {
                const country = countries[countryName];
                const listItem = document.createElement('li');
                listItem.innerHTML = `
                    <span>${countryName} (Ä°liÅŸki: ${country.relation.toFixed(0)})</span>
                    <input type="checkbox" data-country="${countryName}" class="summit-invite-checkbox" 
                           ${country.summitInvited ? 'checked' : ''} 
                           ${summitInvitationsSent ? 'disabled' : ''}
                           ${selectedCount >=5 && !country.summitInvited && summitPlanned ? 'disabled' : ''}> 
                           ${country.summitInvited && summitInvitationsSent ? (country.summitAccepted ? ' (KatÄ±lacak)' : ' (Reddetti)') : ''}
                `;
                summitInvitationListEl.appendChild(listItem);
            }

            document.querySelectorAll('.summit-invite-checkbox').forEach(checkbox => {
                checkbox.onchange = handleSummitInviteCheckbox;
            });
            sendSummitInvitationsBtn.disabled = !summitPlanned || summitInvitationsSent || getSelectedSummitInvitees().length === 0;
        }

        function handleSummitInviteCheckbox(event) {
            if (summitInvitationsSent) return; // Davetler gÃ¶nderildiyse deÄŸiÅŸiklik yapÄ±lamaz
            const countryName = event.target.dataset.country;
            countries[countryName].summitInvited = event.target.checked;
            updateSummitInvitationList(); 
        }
        
        function getSelectedSummitInvitees() {
            const invitees = [];
            for (const countryName in countries) {
                if (countries[countryName].summitInvited) {
                    invitees.push(countryName);
                }
            }
            return invitees;
        }

        function updateReports() {
            if(gdpChangeReportDisplayEl) gdpChangeReportDisplayEl.textContent = `${((gdpGrowthFactorGlobal || 1) -1 * 100).toFixed(2)}%`; // gdpGrowthFactorGlobal tanÄ±mlanmalÄ± veya alternatif kullanÄ±lmalÄ±
            if(inflationChangeReportDisplayEl) inflationChangeReportDisplayEl.textContent = `${(inflationChangeGlobal || 0).toFixed(2)}%`; // inflationChangeGlobal tanÄ±mlanmalÄ±

            educationQualityReportEl.textContent = educationSpending > population * 0.8 ? 'Ã‡ok Ä°yi' : educationSpending > population * 0.4 ? 'Ä°yi' : educationSpending > population * 0.1 ? 'Orta' : 'Yetersiz';
            healthQualityReportEl.textContent = healthSpending > population * 1 ? 'Ã‡ok Ä°yi' : healthSpending > population * 0.5 ? 'Ä°yi' : healthSpending > population * 0.2 ? 'Orta' : 'Yetersiz';
            holidayCountReportEl.textContent = nationalHolidays;
            governmentSupportReportEl.textContent = `${satisfaction.toFixed(1)}%`; 
            parliamentSupportReportEl.textContent = `${politicalSystem === 'Demokrasi' ? parliamentSupport.toFixed(1) : 'N/A'}%`;
            politicalStabilityReportEl.textContent = `${politicalStability.toFixed(1)}%`;
            oppositionStrengthReportEl.textContent = `${(politicalSystem === 'Demokrasi' ? (100 - parliamentSupport) : 0).toFixed(1)}%`;

            updateMinisterReports(); // BakanlÄ±k raporlarÄ±
            drawReportChart();
        }


        taxSlider.addEventListener('input', () => { taxSliderValue.textContent = taxSlider.value; });
        applyTaxBtn.addEventListener('click', () => {
            const newTaxRate = parseFloat(taxSlider.value);
            const oldTaxes = taxes;
            taxes = newTaxRate;
            const change = newTaxRate - oldTaxes;
            taxRateEl.textContent = taxes.toFixed(1);
            
            let taxMessage = "";
            if (change > 0) {
                taxMessage = `Vergileri %${taxes.toFixed(1)} oranÄ±na yÃ¼kselttiniz.`;
                weeklySatisfactionChange -= change * 2.8; 
                weeklyPoliticalStabilityChange -= change * 0.5;
                if (taxes > 20) taxMessage += " Halk arasÄ±nda bÃ¼yÃ¼k bir hoÅŸnutsuzluk var!";
                addLog(taxMessage, 'warning');
            } else if (change < 0) {
                taxMessage = `Vergileri %${taxes.toFixed(1)} oranÄ±na dÃ¼ÅŸÃ¼rdÃ¼nÃ¼z.`;
                weeklySatisfactionChange -= change * 2.0; // change negatif olduÄŸu iÃ§in artÄ±ÅŸ olacak
                weeklyPoliticalStabilityChange -= change * 0.2;
                if (taxes < 8) taxMessage += " BÃ¼tÃ§e gelirlerinde ciddi dÃ¼ÅŸÃ¼ÅŸ bekleniyor.";
                 addLog(taxMessage, 'info');
            }
            updateGameStats();
        });

        function setupInvestmentButtons(inputId, decreaseBtnId, increaseBtnId, minVal, maxVal, step = 1) {
            const inputEl = document.getElementById(inputId);
            const decBtn = document.getElementById(decreaseBtnId);
            const incBtn = document.getElementById(increaseBtnId);
            if(decBtn) decBtn.addEventListener('click', () => { inputEl.value = Math.max(minVal, parseInt(inputEl.value) - step); });
            if(incBtn) incBtn.addEventListener('click', () => { inputEl.value = Math.min(maxVal, parseInt(inputEl.value) + step); });
        }
        setupInvestmentButtons('economy-investment', 'decrease-economy-investment', 'increase-economy-investment', 1, 100);
        setupInvestmentButtons('education-investment', 'decrease-education-investment', 'increase-education-investment', 1, 50);
        setupInvestmentButtons('health-investment', 'decrease-health-investment', 'increase-health-investment', 1, 50);
        setupInvestmentButtons('culture-investment', 'decrease-culture-investment', 'increase-culture-investment', 1, 30);
        setupInvestmentButtons('police-budget', 'decrease-police-budget', 'increase-police-budget', 1, 20);
        setupInvestmentButtons('recruit-soldiers-input', 'decrease-recruits', 'increase-recruits', 1, 50);

        function makeInvestment(name, amount, budgetChangeEffect, gdpFactorEffect, inflationEffect, satisfactionEffect, minister) {
            const cost = amount * 1000000;
            if (budget < cost) {
                addLog(`${name} iÃ§in yeterli bÃ¼tÃ§e yok! Maliyet: $${cost.toLocaleString()}`, 'warning');
                return false;
            }
            budget -= cost;
            let effectiveAmount = cost * (1 - minister.corruption * 0.7); // Yolsuzluk miktarÄ± azaltÄ±r
            
            weeklyBudgetChange -= cost; // BÃ¼tÃ§eden her zaman tam maliyet dÃ¼ÅŸer
            if(gdpFactorEffect) weeklyGdpChangeFactor *= (1 + (effectiveAmount / gdp * gdpFactorEffect * minister.efficiency));
            if(inflationEffect) weeklyInflationChange += (effectiveAmount / gdp * inflationEffect);
            if(satisfactionEffect) weeklySatisfactionChange += satisfactionEffect * (effectiveAmount / 10000000) * minister.efficiency;

            addLog(`${name}'e $${amount}M yatÄ±rÄ±m yaptÄ±nÄ±z. Bakan ${minister.name} projeyi yÃ¶netiyor (Verimlilik: ${minister.efficiency.toFixed(1)}, Yolsuzluk: ${minister.corruption.toFixed(1)}).`, 'info');
            if (minister.corruption > 0.2 && Math.random() < minister.corruption*2) {
                let lostAmount = cost * minister.corruption * 0.5;
                budget -= lostAmount; // Yolsuzluktan ekstra kayÄ±p (fark ettirilmeden)
                addLog(`Bakan ${minister.name}'in yolsuzluklarÄ± nedeniyle yatÄ±rÄ±mÄ±n bir kÄ±smÄ± ($${lostAmount.toLocaleString()}) buharlaÅŸtÄ±!`, 'danger');
                weeklySatisfactionChange -=2; weeklyPoliticalStabilityChange -=3;
            }
            return true;
        }

        investEconomyBtn.addEventListener('click', () => {
            const amount = parseInt(economyInvestmentInput.value);
            makeInvestment('Ekonomi', amount, -amount, 0.12, 0.06, 0.15, cabinet.economy);
            updateGameStats();
        });
        investEducationBtn.addEventListener('click', () => {
            const amount = parseInt(educationInvestmentInput.value);
            if(makeInvestment('EÄŸitim', amount, -amount, 0.01, 0.005, 0.6, cabinet.education)) educationSpending += amount * 1000000 * cabinet.education.efficiency;
            updateGameStats();
        });
        investHealthBtn.addEventListener('click', () => {
            const amount = parseInt(healthInvestmentInput.value);
            if(makeInvestment('SaÄŸlÄ±k', amount, -amount, 0.015, 0.007, 0.75, cabinet.health)) healthSpending += amount*1000000*cabinet.health.efficiency;
            updateGameStats();
        });
        promoteCultureBtn.addEventListener('click', () => {
            const amount = parseInt(cultureInvestmentInput.value);
             if(makeInvestment('KÃ¼ltÃ¼r', amount, -amount, 0.005, 0.002, 0.35, cabinet.economy)) cultureSpending += amount*1000000; // KÃ¼ltÃ¼r bakanÄ± yoksa ekonomi bk.
            updateGameStats();
        });

        investGreenEnergyBtn.addEventListener('click', () => {
            const cost = 20000000;
            if (budget >= cost) {
                budget -= cost; weeklyBudgetChange -= cost;
                addLog("YeÅŸil enerji dÃ¶nÃ¼ÅŸÃ¼mÃ¼ iÃ§in 20 Milyon DolarlÄ±k bÃ¼yÃ¼k bir yatÄ±rÄ±m paketi aÃ§Ä±klandÄ±.", "success");
                weeklySatisfactionChange += 3;
                weeklyForeignRelationsChange += 2; 
                weeklyInflationChange -= 0.15; 
                weeklyPoliticalStabilityChange +=1;
                // Gelecek haftalarda GSYÄ°H'ya etki edebilir
                if(Math.random() < cabinet.economy.efficiency - 0.3) { // BaÅŸarÄ±lÄ± olursa
                     addLog("YeÅŸil enerji yatÄ±rÄ±mÄ± uluslararasÄ± alanda takdir topladÄ± ve yeni teknolojiler getirdi!", "success");
                     weeklyGdpChangeFactor *= 1.002;
                }
            } else { addLog("YeÅŸil enerji yatÄ±rÄ±mÄ± iÃ§in yeterli bÃ¼tÃ§e yok.", "warning"); }
            updateGameStats();
        });

        developDefenseIndustryBtn.addEventListener('click', () => {
            const cost = 50000000;
            if (budget >= cost) {
                budget -= cost; weeklyBudgetChange -= cost;
                addLog("Ulusal savunma sanayii geliÅŸtirme projesi baÅŸlatÄ±ldÄ± (50 Milyon Dolar).", "info");
                let strengthGain = 5 + Math.floor(cabinet.defense.efficiency * 5 - cabinet.defense.corruption * 8);
                strengthGain = Math.max(1, strengthGain); // En az 1 kazansÄ±n
                weeklyMilitaryStrengthChange += strengthGain; 
                weeklyGdpChangeFactor *= (1 + 0.001 * cabinet.defense.efficiency); 
                weeklyForeignRelationsChange -= (2 - diplomaticApproachLevel * 0.2); 
                armyLoyalty += Math.max(0, Math.floor((cabinet.defense.efficiency - cabinet.defense.corruption - 0.3)*5)); // BakanÄ±n dÃ¼rÃ¼stlÃ¼ÄŸÃ¼ sadakati artÄ±rÄ±r
                if(strengthGain < 2){
                    addLog("Ancak, yolsuzluk ve verimsizlik nedeniyle projeden beklenen fayda saÄŸlanamadÄ±.", "danger");
                }
            } else { addLog("Savunma sanayii projesi iÃ§in yeterli bÃ¼tÃ§e yok.", "warning"); }
            updateGameStats();
        });

        socialPolicySlider.addEventListener('input', () => { socialPolicyValue.textContent = socialPolicySlider.value; });
        economicPolicySlider.addEventListener('input', () => { economicPolicyValue.textContent = economicPolicySlider.value; });
        diplomaticApproachSlider.addEventListener('input', () => { diplomaticApproachValue.textContent = diplomaticApproachSlider.value; });
        securityLevelSlider.addEventListener('input', () => { securityLevelValue.textContent = securityLevelSlider.value; });
        
        applySocialPolicyBtn.addEventListener('click', () => {
            const newLevel = parseInt(socialPolicySlider.value);
            const change = newLevel - socialPolicyLevel;
            socialPolicyLevel = newLevel;
            if (change > 0) {
                addLog(`Sosyal politikalar ${newLevel}. seviyeye geniÅŸletildi. Halk memnuniyeti artacak, bÃ¼tÃ§e yÃ¼kÃ¼ artacak.`, 'info');
                weeklySatisfactionChange += change * 0.8; 
                weeklyBudgetChange -= change * 700000; 
                weeklyPoliticalStabilityChange += change * 0.2;
            } else if (change < 0) {
                addLog(`Sosyal politikalar ${newLevel}. seviyeye daraltÄ±ldÄ±. BÃ¼tÃ§e rahatlayacak, halk memnuniyeti dÃ¼ÅŸebilir.`, 'warning');
                weeklySatisfactionChange += change * 1.5; 
                weeklyBudgetChange -= change * 700000; 
                weeklyPoliticalStabilityChange += change * 0.3; // Daraltma bazen istikrarÄ± artÄ±rabilir (popÃ¼list deÄŸilse)
            }
            updateGameStats();
        });
        applyEconomicPolicyBtn.addEventListener('click', () => {
            const newLevel = parseInt(economicPolicySlider.value);
            const change = newLevel - economicPolicyLevel;
            economicPolicyLevel = newLevel;
             if (change > 0) { // GeniÅŸlemeci
                addLog(`Ekonomi politikalarÄ± ${newLevel}. seviyeye getirildi (GeniÅŸlemeci). GSYÄ°H artabilir, enflasyon riski yÃ¼kseldi.`, 'info');
                weeklyGdpChangeFactor *= (1 + (change * 0.003 * cabinet.economy.efficiency)); 
                weeklyInflationChange += change * 0.15 * (1.5 - cabinet.economy.efficiency); // Verimli bakan enflasyonu daha iyi kontrol eder
            } else if (change < 0) { // DaraltÄ±cÄ±
                addLog(`Ekonomi politikalarÄ± ${newLevel}. seviyeye getirildi (DaraltÄ±cÄ±). Enflasyon dÃ¼ÅŸebilir, GSYÄ°H yavaÅŸlayabilir.`, 'warning');
                weeklyGdpChangeFactor *= (1 + (change * 0.002 / cabinet.economy.efficiency)); // Verimli bakan daralmanÄ±n GSYÄ°H etkisini azaltÄ±r
                weeklyInflationChange += change * 0.12 * cabinet.economy.efficiency; // Verimli bakan enflasyonu daha hÄ±zlÄ± dÃ¼ÅŸÃ¼rÃ¼r
            }
            updateGameStats();
        });
        applyDiplomaticApproachBtn.addEventListener('click', () => {
            const newLevel = parseInt(diplomaticApproachSlider.value);
            const change = newLevel - diplomaticApproachLevel;
            diplomaticApproachLevel = newLevel;
            let message = `Diplomatik yaklaÅŸÄ±m ${newLevel}. seviyeye ayarlandÄ± (${newLevel > 7 ? 'Ã‡ok UzlaÅŸmacÄ±' : newLevel > 4 ? 'Dengeli' : 'Agresif'}). `;
            if (change > 0) { // Daha uzlaÅŸmacÄ±
                message += "UluslararasÄ± iliÅŸkilerde iyileÅŸme bekleniyor.";
                weeklyForeignRelationsChange += change * 0.8; 
                for (const cN in countries) { countries[cN].relation = Math.min(100, countries[cN].relation + (change * (0.3 + Math.random()*0.4)));}
            } else if (change < 0) { // Daha agresif
                 message += "UluslararasÄ± alanda gerginlikler artabilir.";
                weeklyForeignRelationsChange += change * 1.2; 
                for (const cN in countries) { countries[cN].relation = Math.max(0, countries[cN].relation + (change * (0.4 + Math.random()*0.5)));}
                 if(newLevel < 3 && Math.random() < 0.3) {
                     let randCountry = Object.keys(countries)[Math.floor(Math.random()*Object.keys(countries).length)];
                     countries[randCountry].relation = Math.max(0, countries[randCountry].relation - 15);
                     message += ` ${randCountry} sert tutumunuzdan dolayÄ± bÃ¼yÃ¼kelÃ§isini geri Ã§aÄŸÄ±rdÄ±!`;
                     weeklyForeignRelationsChange -=5;
                 }
            }
            addLog(message, change > 0 ? 'info' : 'warning');
            updateForeignRelationsDisplay();
            updateGameStats();
        });
        applySecurityLevelBtn.addEventListener('click', () => { 
            const newLevel = parseInt(securityLevelSlider.value);
            const change = newLevel - securityLevel;
            securityLevel = newLevel;
            let slMessage = `Ä°Ã§ gÃ¼venlik (polisaj) seviyesi ${newLevel}. seviyeye ayarlandÄ±. `;
            if (change > 0) {
                slMessage += "SuÃ§ oranlarÄ±nda dÃ¼ÅŸÃ¼ÅŸ ve gÃ¼venlik algÄ±sÄ±nda artÄ±ÅŸ bekleniyor.";
                weeklyCrimeRateChange -= change * 0.3;
                weeklySecurityPerceptionChange += change * 0.7;
                if (securityLevel > 8 && politicalSystem === 'Demokrasi') {
                    slMessage += " Ancak bu durum Ã¶zgÃ¼rlÃ¼kleri kÄ±sÄ±tladÄ±ÄŸÄ± iÃ§in halk arasÄ±nda tepkiye neden olabilir.";
                    weeklySatisfactionChange -= (securityLevel - 8) * 0.6; 
                    weeklyPoliticalStabilityChange -= (securityLevel-8) * 0.3;
                }
            } else if (change < 0) {
                 slMessage += "Ã–zgÃ¼rlÃ¼kler geniÅŸleyebilir ancak suÃ§ oranlarÄ±nda artÄ±ÅŸ riski var.";
                weeklyCrimeRateChange -= change * 0.4; 
                weeklySecurityPerceptionChange += change * 0.9; 
            }
            addLog(slMessage, 'info');
            updateGameStats();
        });

        tabButtons.forEach(button => { button.addEventListener('click', () => { showScreen(button.dataset.tab); }); });
        
        declareHolidayBtn.addEventListener('click', () => {
            const cost = 2000000;
            if (budget >= cost) {
                budget -= cost; weeklyBudgetChange -= cost;
                nationalHolidays++;
                weeklySatisfactionChange += (5 - nationalHolidays*0.5); // Ä°lk tatiller daha etkili
                weeklyGdpChangeFactor *= 0.998; 
                addLog(`Yeni bir resmi tatil ilan ettiniz (${nationalHolidays}. tatil)! HalkÄ±n morali yÃ¼kseldi.`, 'success');
            } else { addLog(`Tatil ilan etmek iÃ§in yeterli bÃ¼tÃ§e yok!`, 'warning'); }
            updateGameStats();
        });
        callElectionsBtn.addEventListener('click', () => {
            if (politicalSystem === 'Demokrasi') {
                if (politicalStability < 40 && satisfaction < 40) {
                     addLog('Halk ve siyasi ortam erken seÃ§im iÃ§in Ã§ok gergin. Bu karar kaos yaratabilir!', 'danger');
                     weeklyPoliticalStabilityChange -=10; weeklySatisfactionChange -=5;
                     if(Math.random() < 0.3) { gameOver("Erken seÃ§im Ã§aÄŸrÄ±nÄ±z Ã¼lkeyi kaosa sÃ¼rÃ¼kledi ve hÃ¼kÃ¼metiniz dÃ¼ÅŸtÃ¼!", "civil_war"); return;}
                }
                const cost = 10000000;
                if (budget < cost) { addLog("Erken seÃ§im iÃ§in bÃ¼tÃ§e yetersiz!", "warning"); return;}
                budget -= cost; weeklyBudgetChange -= cost;
                addLog('Erken seÃ§im kararÄ± aldÄ±nÄ±z! SandÄ±klar kuruluyor...', 'event');
                politicalStability = Math.max(0, politicalStability - 5 - Math.floor(Math.random()*5)); // Erken seÃ§im istikrarÄ± sarsar
                setTimeout(() => conductElections(), 2000 ); 
            } else { addLog('DiktatÃ¶rlÃ¼kte seÃ§im olmaz!', 'danger'); }
        });
        proposeLawBtn.addEventListener('click', () => {
            const proposalText = proposalInput.value.trim();
            if (proposalText === '') { addLog('LÃ¼tfen geÃ§erli bir yasa teklifi girin.', 'warning'); return; }
            if (politicalSystem === 'DiktatÃ¶rlÃ¼k') {
                 addLog(`Kararname yayÄ±nlandÄ±: "${proposalText}". HalkÄ±n tepkisi yakÄ±nda belli olur.`, 'info');
                 weeklySatisfactionChange += (Math.random()-0.5)*4; // +/-2 etki
                 proposalInput.value = ''; updateGameStats(); return;
            }
            // Yasa teklifinin popÃ¼laritesine gÃ¶re ilk etki
            let proposalPopularity = (Math.random() - 0.3) * 10; // Ortalama pozitif ama negatif de olabilir

            parliamentAgenda.push({
                description: proposalText, rejectionCount: 0, 
                onApprove: () => {
                    addLog(`Sizin teklifiniz olan "${proposalText}" yasasÄ± onaylandÄ±!`, 'success');
                    weeklySatisfactionChange += 2 + proposalPopularity/2; 
                    parliamentSupport = Math.min(100, parliamentSupport + 4 + proposalPopularity/3);
                    weeklyPoliticalStabilityChange += 1 + proposalPopularity/5;
                },
                onReject: () => { // ReddedildiÄŸinde onReject Ã§aÄŸrÄ±lÄ±r, mesaj handleParliamentAction'da
                    weeklySatisfactionChange -= (1 - proposalPopularity/3); 
                    weeklyPoliticalStabilityChange -= (1 - proposalPopularity/4);
                }
            });
            addLog(`"${proposalText}" yasa teklifi meclis gÃ¼ndemine sunuldu. (Tahmini PopÃ¼larite Etkisi: ${proposalPopularity.toFixed(1)})`, 'info');
            proposalInput.value = ''; updateParliamentDisplay();
        });

        declareDictatorshipBtn.addEventListener('click', () => {
            if (politicalSystem === 'Demokrasi') {
                addLog("DiktatÃ¶rlÃ¼k ilan etme giriÅŸimi...", "event");
                if (armyLoyalty < 60 && politicalStability > 40) {
                    addLog('Ordu bu hukuksuz emre uymadÄ±! DiktatÃ¶rlÃ¼k giriÅŸiminiz baÅŸarÄ±sÄ±z oldu ve siyasi bir krize yol aÃ§tÄ±!', 'danger');
                    weeklySatisfactionChange -= 25; parliamentSupport = Math.max(0, parliamentSupport - 30);
                    politicalStability = Math.max(0, politicalStability - 40);
                    if(politicalStability < 10) gameOver("BaÅŸarÄ±sÄ±z diktatÃ¶rlÃ¼k giriÅŸimi sonrasÄ± Ã¼lke kaosa sÃ¼rÃ¼klendi.", "civil_war");
                    return;
                }
                 if (satisfaction > 50 && politicalStability > 50) {
                     addLog('Halk ve kurumlar demokrasiye baÄŸlÄ±. DiktatÃ¶rlÃ¼k ilan etme giriÅŸiminiz bÃ¼yÃ¼k tepki Ã§ekti!', 'danger');
                     weeklySatisfactionChange -= 20; weeklyPoliticalStabilityChange -= 30; return;
                 }

                addLog('Orduyu arkanÄ±za alarak (veya zorlayarak) diktatÃ¶rlÃ¼ÄŸÃ¼nÃ¼zÃ¼ ilan ettiniz! TÃ¼m yetkiler sizde. Demokrasi askÄ±ya alÄ±ndÄ±.', 'danger');
                politicalSystem = 'DiktatÃ¶rlÃ¼k';
                weeklySatisfactionChange -= 35; 
                weeklyForeignRelationsChange -= 50; 
                parliamentSupport = 100; // Meclis kukla
                politicalStability = Math.min(60, politicalStability + 10); // KÄ±sa sÃ¼reli baskÄ± ile istikrar
                crimeRate = Math.max(0.1, crimeRate * 0.4); 
                securityPerception = Math.min(100, securityPerception + 30);
                armyLoyalty = Math.min(100, armyLoyalty + 15); // Darbeye katÄ±lan ordu daha sadÄ±k olur
                // KomÅŸu Ã¼lkelerden sert tepkiler
                Object.keys(countries).forEach(cn => {
                    if(countries[cn].relation > 40) countries[cn].relation = Math.max(0, countries[cn].relation - 20 - Math.floor(Math.random()*15));
                });
                updateForeignRelationsDisplay();
            } else { addLog('Zaten bir diktatÃ¶rsÃ¼nÃ¼z!', 'warning'); }
            updateGameStats(); enableAllActionButtons(); 
        });
        dissolveParliamentBtn.addEventListener('click', () => { 
            if (politicalSystem === 'Demokrasi') {
                addLog("Meclisi feshetme kararÄ± alÄ±yorsunuz...", "event");
                if (parliamentSupport > 30 && politicalStability > 40 && armyLoyalty > 50) {
                    addLog('Meclisi feshetme giriÅŸiminiz ordu ve yargÄ± tarafÄ±ndan engellendi! Bu hareket anayasaya aykÄ±rÄ± bulundu ve siyasi kriz derinleÅŸti.', 'danger');
                    weeklySatisfactionChange -= 15; parliamentSupport = Math.max(0, parliamentSupport - 20);
                    politicalStability = Math.max(0, politicalStability - 25);
                    if(politicalStability < 15) gameOver("Anayasal kriz Ã¼lkeyi yÃ¶netilemez hale getirdi.", "civil_war");
                    return;
                }
                addLog('Meclisi feshettiniz! TÃ¼m yasama yetkisi size geÃ§ti. Bu, Ã¼lkeyi otoriter bir yÃ¶netime doÄŸru sÃ¼rÃ¼klÃ¼yor.', 'danger');
                weeklySatisfactionChange -= 30; 
                politicalSystem = 'DiktatÃ¶rlÃ¼k'; // SonuÃ§ yine diktatÃ¶rlÃ¼k olabilir
                parliamentSupport = 0; 
                politicalStability = Math.max(10, politicalStability - 20 + (armyLoyalty > 70 ? 10 : -5)); // Ordu desteklerse istikrar biraz artar
                parliamentAgenda.length = 0; 
                updateParliamentDisplay();
            } else { addLog('DiktatÃ¶rlÃ¼kte zaten etkisiz olan bir meclisi feshetmenin anlamÄ± yok.', 'warning'); }
            updateGameStats(); enableAllActionButtons();
        });
        
        meetOppositionClosedBtn.addEventListener('click', () => { handleOppositionMeeting(true, true); });
        meetOppositionOpenBtn.addEventListener('click', () => { handleOppositionMeeting(true, false); });

        recruitSoldiersBtn.addEventListener('click', () => {
            const numRecruits = parseInt(recruitSoldiersInput.value) * 1000;
            const costPerThousand = 1000000 + (population - armySize*100 < 5000000 ? 200000 : 0) ; // Az nÃ¼fus kalmÄ±ÅŸsa asker bulmak daha pahalÄ±
            const totalCost = (numRecruits / 1000) * costPerThousand;

            if (population < armySize + numRecruits + 2000000) { // Askere alÄ±nacak yeterli genÃ§ nÃ¼fus var mÄ±?
                addLog("Askere alÄ±nacak yeterli genÃ§ nÃ¼fus bulunmuyor!", "warning"); return;
            }
            if (budget >= totalCost) {
                budget -= totalCost; weeklyBudgetChange -= totalCost;
                armySize += numRecruits;
                militaryStrengthIndex = Math.min(100, militaryStrengthIndex + numRecruits / 25000 * (cabinet.defense.efficiency*1.2)); 
                addLog(`${numRecruits.toLocaleString()} yeni asker orduya katÄ±ldÄ±. Ordu bÃ¼yÃ¼klÃ¼ÄŸÃ¼: ${armySize.toLocaleString()}`, 'info');
                weeklySatisfactionChange -= numRecruits / population * 60; 
                armyLoyalty = Math.max(10, armyLoyalty - numRecruits / population * 30); // Zorla alÄ±m sadakati dÃ¼ÅŸÃ¼rebilir
            } else { addLog(`Asker alÄ±mÄ± iÃ§in yeterli bÃ¼tÃ§e yok. Maliyet: $${totalCost.toLocaleString()}`, 'warning'); }
            updateGameStats();
        });
        planWarBtn.addEventListener('click', () => {
            const cost = 5000000;
            if (budget >= cost) {
                budget -= cost; weeklyBudgetChange -= cost;
                let planQuality = Math.floor(cabinet.defense.efficiency * 5) - Math.floor(cabinet.defense.corruption*3) + Math.floor(Math.random()*3);
                addLog(`Genelkurmay, olasÄ± savaÅŸ senaryolarÄ± iÃ§in ${planQuality} kalite puanÄ±nda operasyon planlarÄ± hazÄ±rladÄ±. Askeri stratejiler gÃ¼ncellendi.`, "info");
                weeklyMilitaryStrengthChange += Math.max(0, planQuality/2); 
                // Gelecek savaÅŸlarda bu kalite puanÄ± kullanÄ±labilir
                if (planQuality < 2) addLog("Ancak hazÄ±rlanan planlarÄ±n kalitesi dÃ¼ÅŸÃ¼k, bakanlÄ±ÄŸÄ±n performansÄ±nÄ± gÃ¶zden geÃ§irin!", "danger");
            } else { addLog("SavaÅŸ planlamasÄ± iÃ§in yeterli bÃ¼tÃ§e yok.", "warning");}
            updateGameStats();
        });
        militaryExerciseBtn.addEventListener('click', () => {
            const cost = 10000000 + Math.floor(armySize / 8000 * 700000); 
            if (budget >= cost) {
                budget -= cost; weeklyBudgetChange -= cost;
                let exerciseSuccess = Math.random() < (cabinet.defense.efficiency - cabinet.defense.corruption*1.5 + 0.2);
                if(exerciseSuccess){
                    addLog("GeniÅŸ kapsamlÄ± askeri tatbikat baÅŸarÄ±yla tamamlandÄ±. Ordunun hazÄ±rlÄ±k, moral ve koordinasyonu arttÄ±.", "success");
                    weeklyMilitaryStrengthChange += (4 + Math.floor(cabinet.defense.efficiency * 3)); 
                    armyLoyalty = Math.min(100, armyLoyalty + 5 + Math.floor(cabinet.defense.efficiency * 5));
                } else {
                    addLog("Askeri tatbikat sÄ±rasÄ±nda ciddi bir kaza yaÅŸandÄ±! Ekipman hasar gÃ¶rdÃ¼, personel arasÄ±nda moral bozukluÄŸu var.", "danger");
                    weeklyMilitaryStrengthChange -= 2;
                    armyLoyalty = Math.max(0, armyLoyalty - 8);
                    budget -= cost * 0.2; // Kaza maliyeti
                }
                // KomÅŸu tepkileri
                Object.keys(countries).forEach(cN => {
                    if(countries[cN].relation < 40 && diplomaticApproachLevel < 5 && Math.random() < 0.4){
                        countries[cN].relation = Math.max(0, countries[cN].relation - (6 - diplomaticApproachLevel));
                        addLog(`${cN}, dÃ¼zenlenen tatbikatÄ± kendi sÄ±nÄ±rlarÄ±na yÃ¶nelik bir tehdit olarak algÄ±ladÄ± ve protesto etti!`, 'warning');
                        weeklyForeignRelationsChange -=1;
                    }
                });
                updateForeignRelationsDisplay();
            } else { addLog("Askeri tatbikat iÃ§in yeterli bÃ¼tÃ§e yok.", "warning");}
            updateGameStats();
        });
        militaryCouncilMeetingBtn.addEventListener('click', () => {
            const cost = 1000000;
            if (budget >= cost) {
                budget -= cost; weeklyBudgetChange -= cost;
                let advice = "Askeri Åura acil koduyla toplandÄ±. Genelkurmay BaÅŸkanÄ± durumu Ã¶zetledi: ";
                let adviceType = 'info';
                if (armyLoyalty < 30) {
                    advice += "Ordu iÃ§inde bÃ¼yÃ¼k bir huzursuzluk ve itaatsizlik var! MaaÅŸlar yetersiz, teÃ§hizat eski. ACÄ°L Ã–NLEM ALINMAZSA DARBE KAÃ‡INILMAZ!";
                    adviceType = 'danger'; weeklyPoliticalStabilityChange -=5;
                } else if (militaryStrengthIndex < 30 && foreignRelationsScore < 30) {
                    advice += "Savunma kapasitemiz kritik derecede zayÄ±f ve dÄ±ÅŸ tehditler artÄ±yor. Acil modernizasyon ve personel alÄ±mÄ± ÅŸart!";
                    adviceType = 'danger';
                } else if (politicalStability < 30 && armyLoyalty < 50) {
                    advice += "Ãœlkedeki siyasi istikrarsÄ±zlÄ±k orduya da sirayet ediyor. Askerler arasÄ±nda farklÄ± gruplaÅŸmalar olduÄŸu yÃ¶nÃ¼nde duyumlar var. Bu durum ulusal gÃ¼venliÄŸi tehdit ediyor!";
                    adviceType = 'danger';
                } else if (cabinet.defense.corruption > 0.25) {
                    advice += `Savunma BakanlÄ±ÄŸÄ±'ndaki yolsuzluklar ordunun moralini bozuyor ve kaynaklarÄ±n boÅŸa harcanmasÄ±na neden oluyor. Bakan ${cabinet.defense.name} hakkÄ±nda ciddi iddialar var!`;
                    adviceType = 'warning'; weeklyArmyLoyaltyChange -=3;
                } else {
                    advice += "Mevcut askeri durum genel olarak kontrol altÄ±nda. Ancak, olasÄ± tehditlere karÅŸÄ± her zaman hazÄ±rlÄ±klÄ± olunmalÄ± ve ordunun modernizasyonuna devam edilmeli.";
                    weeklyMilitaryStrengthChange +=1; weeklyArmyLoyaltyChange +=1;
                }
                addLog(advice, adviceType);
            } else { addLog("Askeri Åura toplantÄ±sÄ± iÃ§in yeterli bÃ¼tÃ§e yok.", "warning");}
            updateGameStats();
        });

        reformJusticeBtn.addEventListener('click', () => {
            const cost = 5000000;
            if (budget >= cost) {
                budget -= cost; weeklyBudgetChange -= cost;
                let reformImpact = (cabinet.justice.efficiency - cabinet.justice.corruption - 0.2) * 10; // 0-10 arasÄ± etki
                if (reformImpact > 0) {
                    addLog(`Adalet sisteminde reformlar baÅŸlatÄ±ldÄ± (${reformImpact.toFixed(1)} etki puanÄ±). HalkÄ±n adalete gÃ¼veni artÄ±yor, suÃ§la mÃ¼cadele gÃ¼Ã§leniyor.`, 'success');
                    weeklyCrimeRateChange -= reformImpact * 0.05;
                    weeklySecurityPerceptionChange += reformImpact * 0.15;
                    weeklySatisfactionChange += reformImpact * 0.1;
                    weeklyPoliticalStabilityChange += reformImpact * 0.08;
                } else {
                     addLog(`Adalet reformu giriÅŸimi, sistemdeki direniÅŸ veya yetersizlik nedeniyle beklenen etkiyi yaratamadÄ± (Etki: ${reformImpact.toFixed(1)}).`, 'warning');
                     weeklySatisfactionChange -=1;
                }
            } else { addLog(`Adalet reformu iÃ§in yeterli bÃ¼tÃ§e yok!`, 'warning'); }
            updateGameStats();
        });
        surveillanceProgramBtn.addEventListener('click', () => {
            const cost = 4000000;
            if (budget >= cost) {
                budget -= cost; weeklyBudgetChange -= cost;
                addLog(`GeniÅŸ Ã§aplÄ± bir elektronik gÃ¶zetim programÄ± devreye alÄ±ndÄ±.`, 'info');
                weeklyCrimeRateChange -= 1.5; 
                weeklySecurityPerceptionChange += 2;
                if(politicalSystem === 'Demokrasi'){
                    addLog("Ancak bu durum Ã¶zel hayatÄ±n gizliliÄŸi tartÄ±ÅŸmalarÄ±nÄ± alevlendirdi ve halkÄ±n bir kesminden tepki topladÄ±.", "warning");
                    weeklySatisfactionChange -= 7; 
                    weeklyPoliticalStabilityChange -=4;
                    weeklyForeignRelationsChange -=2; // Demokratik Ã¼lkelerden eleÅŸtiri
                } else { // DiktatÃ¶rlÃ¼k
                     addLog("Rejimin kontrolÃ¼ daha da arttÄ±.", "info");
                     politicalStability = Math.min(100, politicalStability + 3);
                }
            } else { addLog(`GÃ¶zetim programÄ± iÃ§in yeterli bÃ¼tÃ§e yok!`, 'warning'); }
            updateGameStats();
        });
        crackdownDissentBtn.addEventListener('click', () => {
            if (politicalSystem === 'DiktatÃ¶rlÃ¼k') {
                const cost = 2000000 + Math.floor(population * 0.00002 * (100-politicalStability)/20); // Ä°stikrarsÄ±zlÄ±k maliyeti artÄ±rÄ±r
                if (budget >= cost) {
                    budget -= cost; weeklyBudgetChange -= cost;
                    addLog(`Muhalif sesler ve potansiyel tehditler sert bir ÅŸekilde bastÄ±rÄ±ldÄ±. Rejimin demir yumruÄŸu hissediliyor.`, 'danger');
                    weeklySatisfactionChange -= (15 - armyLoyalty/10); 
                    weeklySecurityPerceptionChange += (10 - satisfaction/20); 
                    weeklyForeignRelationsChange -= (10 - diplomaticApproachLevel); 
                    politicalStability = Math.min(100, politicalStability + 5 + armyLoyalty/15);
                    crimeRate = Math.max(0.1, crimeRate * 0.7);
                    armyLoyalty +=2; // BaskÄ±ya katÄ±lan ordu rejime daha da baÄŸlanÄ±r (kÄ±sa vadede)
                } else { addLog(`Muhalefeti bastÄ±rmak iÃ§in yeterli kaynak ($${cost.toLocaleString()}) bulunamadÄ±.`, 'warning'); }
            } else {
                addLog(`Demokratik bir Ã¼lkede muhalefeti bu ÅŸekilde bastÄ±rmak anayasal suÃ§tur ve sizi diktatÃ¶rlÃ¼ÄŸe gÃ¶tÃ¼rÃ¼r!`, 'danger');
                 weeklySatisfactionChange -= 15;
                 parliamentSupport = Math.max(0, parliamentSupport - 20);
                 politicalStability = Math.max(0, politicalStability - 25);
                 if(politicalStability < 20) {
                     addLog("Bu hukuksuz eylem sonrasÄ± Ã¼lke kaosa sÃ¼rÃ¼klendi!", "danger");
                     gameOver("AnayasayÄ± Ã§iÄŸneyerek iÃ§ karÄ±ÅŸÄ±klÄ±ÄŸa neden oldunuz.", "civil_war");
                 }
            }
            updateGameStats();
        });
        
        globalSummitBtn.addEventListener('click', () => { 
            const cost = 10000000;
            if (budget >= cost) {
                budget -= cost; weeklyBudgetChange -= cost;
                let summitSuccess = Math.random() < (diplomaticApproachLevel/10 + foreignRelationsScore/150 + cabinet.foreign.efficiency/2 - 0.2);
                if(summitSuccess){
                    addLog(`KatÄ±ldÄ±ÄŸÄ±nÄ±z uluslararasÄ± zirvede Ã¼lkeniz Ã¶nemli anlaÅŸmalara imza attÄ± ve saygÄ±nlÄ±k kazandÄ±.`, 'success');
                    weeklyForeignRelationsChange += (10 + Math.floor(diplomaticApproachLevel*1.5)); 
                    weeklySatisfactionChange += 4;
                    weeklyGdpChangeFactor *= 1.001;
                    weeklyPoliticalStabilityChange +=2;
                } else {
                    addLog("UluslararasÄ± zirveye katÄ±lÄ±mÄ±nÄ±z beklenen etkiyi yaratmadÄ±. BazÄ± konularda yalnÄ±z kaldÄ±nÄ±z.", "warning");
                    weeklyForeignRelationsChange +=2; // Yine de biraz artar
                    weeklySatisfactionChange +=1;
                }
            } else { addLog(`UluslararasÄ± zirveye katÄ±lÄ±m iÃ§in bÃ¼tÃ§e yetersiz!`, 'warning'); }
            updateGameStats();
        });

        createSummitBtn.addEventListener('click', () => { 
            if (summitPlanned) { addLog("Zaten bir zirve planlama aÅŸamasÄ±ndasÄ±nÄ±z.", "warning"); return; }
            const cost = 15000000;
            if (budget >= cost) {
                budget -= cost; weeklyBudgetChange -= cost;
                summitPlanned = true; summitInvitationsSent = false; 
                for(const cN in countries) { countries[cN].summitInvited = false; countries[cN].summitAccepted = false; }
                addLog(`Kendi ev sahipliÄŸinizde bir uluslararasÄ± zirve dÃ¼zenlemeye karar verdiniz (Maliyet: $${cost.toLocaleString()}). Davet edilecek Ã¼lkeleri seÃ§in.`, 'info');
                updateSummitInvitationList(); createSummitBtn.disabled = true; sendSummitInvitationsBtn.disabled = false; 
            } else { addLog("Zirve dÃ¼zenlemek iÃ§in yeterli bÃ¼tÃ§e yok.", "warning"); }
            updateGameStats();
        });

        sendSummitInvitationsBtn.addEventListener('click', () => {
            if (!summitPlanned || summitInvitationsSent) return;
            const selectedInvitees = getSelectedSummitInvitees();
            if (selectedInvitees.length === 0) { addLog("Zirveye davet etmek iÃ§in en az bir Ã¼lke seÃ§melisiniz.", "warning"); return; }

            addLog(`${selectedInvitees.join(', ')} Ã¼lkelerine zirve davetiyeleri gÃ¶nderildi. CevaplarÄ± bekleniyor...`, "info");
            summitInvitationsSent = true; sendSummitInvitationsBtn.disabled = true;

            selectedInvitees.forEach(countryName => {
                const country = countries[countryName];
                const acceptanceChance = country.relation + (diplomaticApproachLevel * 6) + foreignRelationsScore/4 - (25 - cabinet.foreign.efficiency*10) - (politicalSystem === 'DiktatÃ¶rlÃ¼k' ? 15 : 0) ;
                country.summitAccepted = Math.random() * 100 < acceptanceChance;
            });
            updateSummitInvitationList(); 
        });

        signTradeDealBtn.addEventListener('click', () => { 
            const cost = 3000000;
            if (budget >= cost) {
                budget -= cost; weeklyBudgetChange -= cost;
                let bestCountry = null; let bestPotential = -1; 
                
                for (const countryName in countries) {
                    const country = countries[countryName];
                    if (!country.tradeDeal && country.relation > 30 && country.relation + foreignRelationsScore > 80) { 
                        const potential = country.relation + Math.random() * 40 + diplomaticApproachLevel * 3 + (cabinet.economy.efficiency -0.5)*20;
                        if (potential > bestPotential) { bestCountry = countryName; bestPotential = potential; }
                    }
                }
                
                if (bestCountry && bestPotential > 60) { // BaÅŸarÄ± iÃ§in eÅŸik
                    countries[bestCountry].tradeDeal = true;
                    countries[bestCountry].relation += (8 + Math.floor(diplomaticApproachLevel/2));
                    weeklyGdpChangeFactor *= 1.0025;
                    foreignRelationsScore = Math.min(100, foreignRelationsScore + 2);
                    addLog(`${bestCountry} ile kÃ¢rlÄ± bir ticaret anlaÅŸmasÄ± imzaladÄ±nÄ±z! Ä°hracat artacak.`, 'success');
                } else {
                    addLog(`Uygun bir Ã¼lke ile ticaret anlaÅŸmasÄ± zemini bulunamadÄ±. Diplomatik iliÅŸkiler ve ekonomik durum gÃ¶zden geÃ§irilmeli.`, 'warning');
                    budget += cost*0.5; weeklyBudgetChange += cost*0.5; // Maliyetin bir kÄ±smÄ± iade
                }
            } else { addLog(`Ticaret anlaÅŸmasÄ± iÃ§in yeterli bÃ¼tÃ§e yok!`, 'warning'); }
            updateForeignRelationsDisplay(); updateGameStats();
        });
        improveRelationsBtn.addEventListener('click', () => { 
            const cost = 2000000;
            if (budget >= cost) {
                budget -= cost; weeklyBudgetChange -= cost;
                let totalImprovement = 0;
                for (const cN in countries) {
                    if (countries[cN].relation < 85) { 
                         let imp = 1 + Math.floor(Math.random()*2) + Math.floor(diplomaticApproachLevel/2.5) + Math.floor((cabinet.foreign.efficiency-0.4)*2);
                         countries[cN].relation = Math.min(100, countries[cN].relation + Math.max(0,imp)); // Negatif olmasÄ±n
                         totalImprovement += Math.max(0,imp);
                    }
                }
                weeklyForeignRelationsChange += Math.floor(totalImprovement / (Object.keys(countries).length * 1.5) );
                addLog(`Genel diplomatik iliÅŸkileri geliÅŸtirme Ã§abalarÄ± sonucu ortalama ${ (totalImprovement/Object.keys(countries).length).toFixed(1) } puanlÄ±k bir iyileÅŸme saÄŸlandÄ±.`, 'info');
            } else { addLog(`Diplomasi ataÄŸÄ± iÃ§in yeterli bÃ¼tÃ§e yok!`, 'warning'); }
            updateForeignRelationsDisplay(); updateGameStats();
        });

        declareWarBtn.addEventListener('click', () => { 
            let worstCountry = null; let worstRelation = 101; let mostThreatening = null; let maxThreat = -1;
            for (const cN in countries) {
                if (countries[cN].relation < worstRelation) { worstCountry = cN; worstRelation = countries[cN].relation; }
                let threatLevel = countries[cN].militaryPower - countries[cN].relation - (diplomaticApproachLevel*5) + (politicalStability < 30 ? 10:0);
                if(threatLevel > maxThreat && countries[cN].relation < 30) { mostThreatening = cN; maxThreat = threatLevel;}
            }
            let targetToDeclare = null;
            if(mostThreatening && maxThreat > 30 && Math.random() < 0.6){ // YÃ¼ksek tehdit varsa ona Ã¶ncelik ver
                targetToDeclare = mostThreatening;
                addLog(`Ulusal GÃ¼venlik Kurulu, artan tehditler nedeniyle ${targetToDeclare}'e karÅŸÄ± Ã¶nleyici bir savaÅŸ baÅŸlatÄ±lmasÄ±nÄ± tavsiye etti.`, "event");
            } else if (worstCountry && worstRelation < 20) {
                targetToDeclare = worstCountry;
                 addLog(`En kÃ¶tÃ¼ iliÅŸkilere sahip olduÄŸumuz ${targetToDeclare} ile gerilim had safhada. SavaÅŸ bir seÃ§enek olarak masada.`, "event");
            }

            if (targetToDeclare) {
                handleDeclareWar(targetToDeclare);
            } else {
                addLog(`Åu anda doÄŸrudan savaÅŸ ilan edilecek kadar kritik bir dÄ±ÅŸ tehdit veya dÃ¼ÅŸmanlÄ±k bulunmuyor.`, 'warning');
            }
            updateGameStats();
        });
        
        appointMinisterBtn.addEventListener('click', () => {
            const ministerType = ministerTypeSelect.value;
            let ministerName = ministerNameInput.value.trim();
            if (ministerName === '') {
                const names = ["Ali Veli", "Zehra Ã‡Ä±nar", "Kemal Kurt", "Elif Aslan", "Serkan TaÅŸ", "Bahar GÃ¼l"];
                ministerName = names[Math.floor(Math.random() * names.length)];
            }

            const oldMinister = cabinet[ministerType];
            const newEfficiency = Math.min(1, Math.max(0.1, 0.3 + Math.random() * 0.7 + (politicalStability-50)/200 + (satisfaction-50)/250)); // Daha dengeli
            const newCorruption = Math.min(0.5, Math.max(0, 0.05 + Math.random() * 0.3 - (politicalStability-50)/300 - (cabinet.justice.efficiency-0.5)*0.1)); // Daha dengeli

            const cost = 500000;
            if (budget >= cost) {
                budget -= cost; weeklyBudgetChange -= cost;
                cabinet[ministerType] = { name: ministerName, efficiency: newEfficiency, corruption: newCorruption };
                addLog(`${capitalizeFirstLetter(ministerType)} BakanlÄ±ÄŸÄ±na ${ministerName} atandÄ± (Maliyet: $${cost.toLocaleString()}). Yeni V: ${newEfficiency.toFixed(1)}, Y: ${newCorruption.toFixed(1)}`, 'info');
                
                let stabilityEffect = (newEfficiency - (oldMinister ? oldMinister.efficiency : 0.5)) * 5;
                stabilityEffect -= (newCorruption - (oldMinister ? oldMinister.corruption : 0.1)) * 8;
                weeklyPoliticalStabilityChange += stabilityEffect / 2;
                weeklySatisfactionChange += stabilityEffect / 3;
                 if (Math.abs(newEfficiency - (oldMinister ? oldMinister.efficiency : 0.5)) > 0.3 || Math.abs(newCorruption - (oldMinister ? oldMinister.corruption : 0.1)) > 0.15) {
                     addLog("Bu atama kabinede ve bÃ¼rokraside bazÄ± dalgalanmalara yol aÃ§tÄ±.", "warning");
                     weeklyPoliticalStabilityChange -=1;
                 }

            } else { addLog(`Bakan atamasÄ± iÃ§in yeterli bÃ¼tÃ§e yok. ($${cost.toLocaleString()})`, 'warning'); return; }
            
            updateCabinetDisplay(); updateMinisterAdvice(); updateMinisterReports();
            ministerNameInput.value = ''; 
        });
        
        restartGameBtn.addEventListener('click', () => { resetGame(); });
        endWeekBtn.addEventListener('click', () => { endWeek(); });
        
        let gdpGrowthFactorGlobal = 1; // Raporlama iÃ§in global deÄŸiÅŸkenler
        let inflationChangeGlobal = 0;

        initTheme();
        resetGame(); 
        showScreen('main-screen'); 
    </script>
</body>
</html>
