[replace_code]
<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ulus Sim√ºlat√∂r√º</title>
    <style>
        :root {
            --bg-color: #ecf0f1;
            --container-bg: #fff;
            --text-color: #2c3e50;
            --primary-color: #3498db;
            --secondary-color: #1abc9c;
            --danger-color: #e74c3c;
            --warning-color: #f39c12;
            --success-color: #2ecc71;
            --panel-bg: #f5f7fa;
            --border-color: #dfe4ea;
            --accent-color: #5D5CDE;
            --header-color: #1abc9c;
            --input-bg: #ecf0f1;
            --tab-active-color: #5D5CDE;
        }

        .dark {
            --bg-color: #181818;
            --container-bg: #2c3e50;
            --text-color: #ecf0f1;
            --primary-color: #5D5CDE;
            --secondary-color: #1abc9c;
            --danger-color: #e74c3c;
            --warning-color: #f39c12;
            --success-color: #2ecc71;
            --panel-bg: #34495e;
            --border-color: #4e6a83;
            --header-color: #1abc9c;
            --input-bg: #4e6a83;
            --tab-active-color: #5D5CDE;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            box-sizing: border-box;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        .game-container {
            background-color: var(--container-bg);
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            padding: 20px;
            width: 95%;
            max-width: 1200px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            transition: background-color 0.3s ease;
        }

        h1 {
            text-align: center;
            color: var(--header-color);
            margin-bottom: 20px;
        }

        /* Sekme Navigasyonu */
        .tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 10px;
            gap: 10px; /* Sekmeler arasƒ± bo≈üluk */
            flex-wrap: wrap; /* K√º√ß√ºk ekranlarda sarmalama */
        }

        .tab-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 5px 5px 0 0; /* √úst k√∂≈üeleri yuvarlak */
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.2s ease, transform 0.1s ease;
            flex-grow: 1; /* Esnek b√ºy√ºme */
            min-width: 120px; /* Minimum geni≈ülik */
        }

        @media (max-width: 768px) {
            .tab-btn {
                min-width: 90px;
                padding: 10px 12px;
                font-size: 0.9em;
            }
        }

        .tab-btn:hover {
            background-color: var(--primary-color);
            opacity: 0.9;
            transform: translateY(-2px); /* Hafif yukarƒ± kalkma efekti */
        }

        .tab-btn.active {
            background-color: var(--tab-active-color); /* Aktif sekme rengi */
            font-weight: bold;
            border-bottom: 2px solid var(--tab-active-color); /* Aktif sekmede alt √ßizgi */
            transform: translateY(0); /* Sabit konum */
        }

        /* T√ºm ekranlarƒ± gizle */
        .game-screen {
            display: none;
            background-color: var(--container-bg); /* T√ºm ekranlar i√ßin ortak arka plan */
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            min-height: 500px; /* Ekranlar arasƒ± bo≈üluƒüu korumak i√ßin */
            overflow-y: auto; /* ƒ∞√ßerik ta≈üarsa kaydƒ±rma */
        }

        /* Ana oyun ekranƒ±nƒ±n d√ºzenini korumak i√ßin */
        #main-screen {
            display: grid; /* Flexbox ile ana konteyneri y√∂nettik, i√ßini grid ile */
            grid-template-columns: 1fr 1.5fr;
            grid-template-rows: auto 1fr; /* ƒ∞statistikler ve eylemler √ºstte, log ve canvas altta */
            gap: 20px;
            grid-template-areas:
                "stats actions"
                "log canvas";
        }

        @media (max-width: 768px) {
            #main-screen {
                grid-template-columns: 1fr;
                grid-template-areas:
                    "stats"
                    "actions"
                    "log"
                    "canvas";
            }

            .game-container {
                padding: 15px;
                width: 98%;
            }
        }

        #main-screen.active { /* Bu .active sƒ±nƒ±fƒ± JS ile y√∂netilecek */
            /* display: grid; Javascript showScreen i√ßinde y√∂netiyor */
        }

        .stats-panel {
            grid-area: stats;
            background-color: var(--panel-bg);
            padding: 20px;
            border-radius: 6px;
            border-left: 5px solid var(--secondary-color);
        }

        .stats-panel p {
            margin: 10px 0;
            font-size: 1.1em;
        }

        .stats-panel span {
            font-weight: bold;
            color: var(--text-color);
        }

        .actions-panel {
            grid-area: actions;
            background-color: var(--panel-bg);
            padding: 20px;
            border-radius: 6px;
            border-left: 5px solid var(--warning-color);
        }

        .actions-panel h2 {
            color: var(--warning-color);
            margin-top: 0;
            margin-bottom: 15px;
        }

        .action-category {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px dashed var(--border-color);
        }

        .action-category:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }

        .action-category h3 {
            color: var(--warning-color);
            margin-top: 0;
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 15px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.95em;
            transition: background-color 0.2s ease;
        }

        button:hover {
            background-color: var(--primary-color);
            opacity: 0.9;
        }

        button:disabled {
            background-color: #7f8c8d;
            cursor: not-allowed;
            opacity: 0.7;
        }

        .log-panel {
            grid-area: log;
            background-color: var(--panel-bg);
            padding: 20px;
            border-radius: 6px;
            border-left: 5px solid #9b59b6;
            overflow-y: auto;
            max-height: 300px; /* Log paneli i√ßin maksimum y√ºkseklik */
        }

        .log-panel h2 {
            color: #9b59b6;
            margin-top: 0;
            margin-bottom: 15px;
        }

        #game-log {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        #game-log li {
            background-color: var(--container-bg);
            padding: 8px 12px;
            margin-bottom: 5px;
            border-radius: 4px;
            font-size: 0.9em;
        }
         #game-log li.daily { /* G√ºnl√ºk loglar i√ßin farklƒ± stil */
            font-style: italic;
            color: var(--accent-color);
            opacity: 0.8;
            font-size: 0.85em;
            border-left: 3px solid var(--accent-color);
            padding-left: 10px;
        }


        #gameCanvas {
            grid-area: canvas;
            background-color: var(--panel-bg);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            width: 100%;
            height: 300px; /* Canvas boyutu */
        }

        /* Yeni Ekranlarƒ±n Genel Stili */
        .game-screen h2 {
            color: var(--warning-color); /* Sarƒ±msƒ± ba≈ülƒ±k rengi */
            margin-bottom: 20px;
            text-align: center;
        }
        .game-screen h3 {
            color: var(--secondary-color);
            margin-top: 20px;
            margin-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 5px;
        }


        .game-screen ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .game-screen li {
            background-color: var(--panel-bg);
            padding: 10px 15px;
            margin-bottom: 8px;
            border-radius: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 1.05em;
        }
         .game-screen li div { /* Butonlarƒ± saƒüa yaslamak i√ßin */
            display: flex;
            gap: 5px;
            flex-wrap: wrap; /* Butonlar sƒ±ƒümazsa alt satƒ±ra ge√ßsin */
        }


        .game-screen .cabinet-actions,
        .game-screen .parliament-propose,
        .game-screen .security-actions,
        .game-screen .foreign-actions,
        .game-screen .opposition-actions,
        .game-screen .reports-actions { /* Rapor ekranƒ± i√ßin eylem alanƒ± */
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
            justify-content: center; /* Butonlarƒ± ortala */
            margin-bottom: 15px;
        }


        .game-screen input[type="text"],
        .game-screen input[type="number"],
        .game-screen select {
            padding: 10px;
            border-radius: 5px;
            border: 1px solid var(--border-color);
            background-color: var(--input-bg);
            color: var(--text-color);
            font-size: 1em;
            flex-grow: 1;
            min-width: 150px;
        }

        .game-screen .parliament-note,
        .game-screen .security-note {
            font-style: italic;
            font-size: 0.9em;
            color: #bdc3c7;
            margin-top: 10px;
            text-align: center;
        }

        /* Oyun Sonu Ekranƒ± */
        #game-over-screen {
            display: flex; /* Flexbox ile ortalama */
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            min-height: 500px;
        }

        #game-over-screen h1 {
            color: var(--danger-color);
            margin-bottom: 20px;
        }

        #game-over-screen p {
            font-size: 1.2em;
            margin-bottom: 10px;
        }

        #game-over-screen button {
            background-color: var(--danger-color);
            padding: 15px 30px;
            font-size: 1.2em;
            margin-top: 30px;
        }

        #game-over-screen button:hover {
            background-color: var(--danger-color);
            opacity: 0.9;
        }

        /* Meclis Action butonlarƒ± */
        .parliament-action-btn {
            padding: 8px 12px;
            margin-left: 5px;
            font-size: 0.85em;
        }

        .parliament-action-btn[data-action="approve"] {
            background-color: var(--success-color);
        }
        .parliament-action-btn[data-action="approve"]:hover {
            background-color: var(--success-color);
            opacity: 0.9;
        }
        .parliament-action-btn[data-action="reject"] {
            background-color: var(--danger-color);
        }
        .parliament-action-btn[data-action="reject"]:hover {
            background-color: var(--danger-color);
            opacity: 0.9;
        }

        /* Dƒ±≈ü ƒ∞li≈ükiler listesi */
        #country-relations-list button, #summit-invitation-list button {
            padding: 6px 10px;
            font-size: 0.8em;
            margin-left: 5px;
        }

        #country-relations-list li, #summit-invitation-list li {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap; /* K√º√ß√ºk ekranlarda sarmalama */
        }


        /* Dark Mode Toggle */
        .theme-toggle {
            position: absolute;
            top: 15px;
            right: 15px;
            background-color: transparent;
            border: none;
            cursor: pointer;
            font-size: 1.5rem;
            color: var(--text-color);
            z-index: 100;
        }

        /* Chart styles */
        #reportChartCanvas {
            background-color: var(--panel-bg);
            border-radius: 6px;
            max-width: 100%;
            height: auto;
            margin-top: 20px;
        }

        /* Yeni √∂zellikler i√ßin stiller */
        .slider-container {
            margin: 15px 0;
        }

        .slider-container label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .slider-container input[type="range"] {
            width: 100%;
            height: 10px;
            border-radius: 5px;
            background: var(--panel-bg);
            outline: none;
            -webkit-appearance: none;
        }

        .slider-container input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--accent-color);
            cursor: pointer;
        }

        .flex-row {
            display: flex;
            gap: 10px;
            align-items: center;
            margin: 10px 0;
            flex-wrap: wrap;
        }

        .input-with-buttons {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .input-with-buttons input {
            width: 100px;
            text-align: center;
        }

        .input-with-buttons button {
            padding: 8px 12px;
            font-size: 1em;
        }

        .minister-advice {
            background-color: var(--panel-bg);
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
            border-left: 5px solid var(--accent-color);
        }

        .minister-advice h3 {
            margin-top: 0;
            color: var(--accent-color);
        }

        .policy-slider {
            margin: 15px 0;
        }

        .policy-slider-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 5px;
        }

        .policy-value {
            font-weight: bold;
        }

        /* Tooltip styles */
        .tooltip {
            position: relative;
            display: inline-block;
            margin-left: 5px;
            cursor: help;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: rgba(0, 0, 0, 0.8);
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.9em;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        @media (max-width: 480px) {
            button {
                padding: 8px 12px;
                font-size: 0.85em;
                margin: 3px;
            }
            
            .stats-panel p, .actions-panel h3 {
                font-size: 0.95em;
            }
             .game-screen li div {
                justify-content: flex-start; /* Mobil i√ßin butonlarƒ± sola yasla */
            }
        }
    </style>
</head>
<body>
    <button id="theme-toggle" class="theme-toggle" aria-label="Toggle dark/light mode">üåì</button>
    <div class="game-container">
        <h1>Ulus Sim√ºlat√∂r√º</h1>

        <div class="tabs">
            <button class="tab-btn active" data-tab="main-screen">Ana Ekran</button>
            <button class="tab-btn" data-tab="cabinet-screen">Kabine</button>
            <button class="tab-btn" data-tab="parliament-screen">Meclis & Siyaset</button>
            <button class="tab-btn" data-tab="foreign-affairs-screen">Dƒ±≈ü ƒ∞li≈ükiler & Zirveler</button>
            <button class="tab-btn" data-tab="security-screen">G√ºvenlik & Ordu</button>
            <button class="tab-btn" data-tab="reports-screen">Raporlar & Zaman</button>
        </div>

        <div id="main-screen" class="game-screen active">
            <div class="stats-panel">
                <p>Hafta: <span id="current-week">1</span> (G√ºn: <span id="current-day-of-week">1</span>)</p>
                <p>N√ºfus: <span id="population">10,000,000</span></p>
                <p>GSYƒ∞H: $<span id="gdp">1,000,000,000</span></p>
                <p>Enflasyon: <span id="inflation">2</span>%</p>
                <p>Halk Memnuniyeti: <span id="satisfaction">70</span>%</p>
                <p>B√ºt√ße: $<span id="budget">100,000,000</span></p>
                <p>Vergi Oranƒ±: <span id="tax-rate">10</span>%</p>
                <p>H√ºk√ºmet Tipi: <span id="government-type-display">Demokrasi</span></p>
                <p>Siyasi ƒ∞stikrar: <span id="political-stability">70</span>%</p>
                <p>Dƒ±≈ü ƒ∞li≈ükiler Skoru: <span id="foreign-relations-score">50</span></p>
                <p>Ordu B√ºy√ºkl√ºƒü√º: <span id="army-size-display">50000</span></p>
                 <p>Medya √ñzg√ºrl√ºƒü√º: <span id="media-freedom-display">7</span>/10</p>
            </div>

            <div class="actions-panel">
                <h2>Kararlar</h2>
                <div class="action-category">
                    <h3>Vergi Ayarlarƒ±</h3>
                    <div class="slider-container">
                        <label for="tax-slider">Vergi Oranƒ±: <span id="tax-slider-value">10</span>%</label>
                        <input type="range" id="tax-slider" min="5" max="30" step="0.1" value="10">
                    </div>
                    <button id="apply-tax">Vergi Oranƒ±nƒ± Uygula</button>
                </div>
                
                <div class="action-category">
                    <h3>Ekonomi</h3>
                    <div class="flex-row">
                        <label for="economy-investment">Ekonomiye Yatƒ±rƒ±m ($M):</label>
                        <div class="input-with-buttons">
                            <button id="decrease-economy-investment">-</button>
                            <input type="number" id="economy-investment" value="10" min="1" max="100">
                            <button id="increase-economy-investment">+</button>
                        </div>
                        <button id="invest-economy">Yatƒ±rƒ±m Yap</button>
                    </div>
                </div>
                
                <div class="action-category">
                    <h3>Sosyal Politikalar</h3>
                    <div class="flex-row">
                        <label for="education-investment">Eƒüitime Yatƒ±rƒ±m ($M):</label>
                        <div class="input-with-buttons">
                            <button id="decrease-education-investment">-</button>
                            <input type="number" id="education-investment" value="5" min="1" max="50">
                            <button id="increase-education-investment">+</button>
                        </div>
                        <button id="invest-education">Yatƒ±rƒ±m Yap</button>
                    </div>
                    
                    <div class="flex-row">
                        <label for="health-investment">Saƒülƒ±ƒüa Yatƒ±rƒ±m ($M):</label>
                        <div class="input-with-buttons">
                            <button id="decrease-health-investment">-</button>
                            <input type="number" id="health-investment" value="7" min="1" max="50">
                            <button id="increase-health-investment">+</button>
                        </div>
                        <button id="invest-health">Yatƒ±rƒ±m Yap</button>
                    </div>
                    
                    <div class="flex-row">
                        <label for="culture-investment">K√ºlt√ºre Yatƒ±rƒ±m ($M):</label>
                        <div class="input-with-buttons">
                            <button id="decrease-culture-investment">-</button>
                            <input type="number" id="culture-investment" value="3" min="1" max="30">
                            <button id="increase-culture-investment">+</button>
                        </div>
                        <button id="promote-culture">Yatƒ±rƒ±m Yap</button>
                    </div>
                    
                    <button id="declare-holiday">Yeni Tatil ƒ∞lan Et ($2M)</button>
                </div>
                 <div class="action-category">
                    <h3>Yeni Politikalar</h3>
                    <button id="invest-green-energy">Ye≈üil Enerjiye Yatƒ±rƒ±m Yap ($20M)</button>
                    <button id="develop-defense-industry">Savunma Sanayii Geli≈ütir ($50M)</button>
                </div>
                <button id="end-week-btn">Haftayƒ± Bitir</button>
            </div>

            <div class="log-panel">
                <h2>Olay G√ºnl√ºƒü√º</h2>
                <ul id="game-log"></ul>
            </div>

            <canvas id="gameCanvas"></canvas>
        </div>

        <div id="cabinet-screen" class="game-screen">
            <h2>Kabine Y√∂netimi</h2>
            <p>Mevcut Kabine √úyeleri:</p>
            <ul id="cabinet-list">
            </ul>
            
            <div class="minister-advice" id="cabinet-advice">
                <h3>Bakan Raporlarƒ±</h3>
                <div id="economy-minister-advice">
                    <p><strong>Ekonomi Bakanƒ±:</strong> <span id="economy-advice-text">Hen√ºz rapor verilmedi.</span></p>
                </div>
                <div id="education-minister-advice">
                    <p><strong>Eƒüitim Bakanƒ±:</strong> <span id="education-advice-text">Hen√ºz rapor verilmedi.</span></p>
                </div>
                <div id="health-minister-advice">
                    <p><strong>Saƒülƒ±k Bakanƒ±:</strong> <span id="health-advice-text">Hen√ºz rapor verilmedi.</span></p>
                </div>
                <div id="foreign-minister-advice">
                    <p><strong>Dƒ±≈üi≈üleri Bakanƒ±:</strong> <span id="foreign-advice-text">Hen√ºz rapor verilmedi.</span></p>
                </div>
                <div id="interior-minister-advice">
                    <p><strong>ƒ∞√ßi≈üleri Bakanƒ±:</strong> <span id="interior-advice-text">Hen√ºz rapor verilmedi.</span></p>
                </div>
                <div id="justice-minister-advice">
                    <p><strong>Adalet Bakanƒ±:</strong> <span id="justice-advice-text">Hen√ºz rapor verilmedi.</span></p>
                </div>
                 <div id="defense-minister-advice">
                    <p><strong>Savunma Bakanƒ±:</strong> <span id="defense-advice-text">Hen√ºz rapor verilmedi.</span></p>
                </div>
            </div>
            
            <h3>Bakan Atamalarƒ± / Deƒüi≈üiklikleri</h3>
            <div class="cabinet-actions">
                <select id="minister-type-select">
                    <option value="economy">Ekonomi Bakanƒ±</option>
                    <option value="education">Eƒüitim Bakanƒ±</option>
                    <option value="health">Saƒülƒ±k Bakanƒ±</option>
                    <option value="foreign">Dƒ±≈üi≈üleri Bakanƒ±</option>
                    <option value="interior">ƒ∞√ßi≈üleri Bakanƒ±</option>
                    <option value="justice">Adalet Bakanƒ±</option>
                    <option value="defense">Savunma Bakanƒ±</option>
                </select>
                <input type="text" id="minister-name-input" placeholder="Yeni Bakan Adƒ± (isteƒüe baƒülƒ±)">
                <button id="appoint-minister-btn">Bakan Ata / Deƒüi≈ütir ($500K)</button>
            </div>
            <p>Kabine kararlarƒ± haftalƒ±k s√ºre√ßleri etkiler.</p>
        </div>

        <div id="parliament-screen" class="game-screen">
            <h2>Meclis & Siyaset</h2>
            <p>H√ºk√ºmet Tipi: <span id="government-type-parliament">Demokrasi</span></p>
            <p>Meclis Desteƒüi: <span id="parliament-support"></span></p>
            <p>Muhalefet G√ºc√º: <span id="opposition-strength-display"></span></p>
             <h3>Medya & ƒ∞fade √ñzg√ºrl√ºƒü√º</h3>
            <div class="policy-slider">
                <div class="policy-slider-header">
                    <label for="media-freedom-slider">Medya √ñzg√ºrl√ºƒü√º Politikasƒ± (Hedef: <span id="media-freedom-target-value">7</span>/10)</label>
                    <span class="policy-value" id="media-freedom-value-display">7</span>
                </div>
                <input type="range" id="media-freedom-slider" min="0" max="10" value="7">
                <button id="apply-media-policy">Medya Politikasƒ±nƒ± G√ºncelle</button>
            </div>
            <div class="opposition-actions"> 
                 <button id="start-propaganda-btn">Devlet Propagandasƒ± Ba≈ülat ($5M)</button>
                 <button id="apply-censorship-btn">Sans√ºr Uygula</button>
            </div>

            <h3>Yasama Politikalarƒ±</h3>
            <div class="policy-slider">
                <div class="policy-slider-header">
                    <h3>Sosyal Politikalar</h3>
                    <span class="policy-value" id="social-policy-value">5</span>
                </div>
                <input type="range" id="social-policy-slider" min="1" max="10" value="5">
                <div class="tooltip">‚ÑπÔ∏è
                    <span class="tooltiptext">Sosyal politikalarƒ± artƒ±rmak halk memnuniyetini artƒ±rƒ±r ancak b√ºt√ßeye y√ºk getirir.</span>
                </div>
                <button id="apply-social-policy">Uygula</button>
            </div>
            
            <div class="policy-slider">
                <div class="policy-slider-header">
                    <h3>Ekonomi Politikalarƒ±</h3>
                    <span class="policy-value" id="economic-policy-value">5</span>
                </div>
                <input type="range" id="economic-policy-slider" min="1" max="10" value="5">
                <div class="tooltip">‚ÑπÔ∏è
                    <span class="tooltiptext">Ekonomi politikalarƒ±nƒ± deƒüi≈ütirmek GSYƒ∞H ve enflasyonu etkiler.</span>
                </div>
                <button id="apply-economic-policy">Uygula</button>
            </div>
            
            <h3>G√ºndemdeki Yasalar / Talepler</h3>
            <ul id="parliament-agenda">
            </ul>
            <h3>Sizin Teklifleriniz</h3>
            <div class="parliament-propose">
                <input type="text" id="proposal-input" placeholder="Yeni yasa teklifi">
                <button id="propose-law-btn">Yasa Teklif Et</button>
            </div>
            <h3>Muhalefet ƒ∞li≈ükileri</h3>
            <div class="opposition-actions">
                <button id="meet-opposition-closed-btn">Muhalefetle Kapalƒ± G√∂r√º≈ü ($500K)</button>
                <button id="meet-opposition-open-btn">Muhalefetle A√ßƒ±k G√∂r√º≈ü ($200K)</button>
            </div>
            <h3>Radikal Kararlar</h3>
            <div class="parliament-propose"> 
                 <button id="call-elections">Erken Se√ßim √áaƒürƒ±sƒ± Yap ($10M)</button>
                 <button id="declare-dictatorship">Diktat√∂rl√ºk ƒ∞lan Et</button>
                 <button id="dissolve-parliament-btn">Meclisi Feshet</button>
            </div>
            <p class="parliament-note">Meclisi feshetmek veya diktat√∂rl√ºk ilan etmek ciddi sonu√ßlar doƒüurabilir.</p>
        </div>

        <div id="foreign-affairs-screen" class="game-screen">
            <h2>Dƒ±≈ü ƒ∞li≈ükiler & Zirveler</h2>
            <p>Genel Dƒ±≈ü ƒ∞li≈ükiler Puanƒ±: <span id="foreign-relations-display"></span></p>
            
            <div class="policy-slider">
                <div class="policy-slider-header">
                    <h3>Diplomatik Yakla≈üƒ±m</h3>
                    <span class="policy-value" id="diplomatic-approach-value">5</span>
                </div>
                <input type="range" id="diplomatic-approach-slider" min="1" max="10" value="5">
                <div class="tooltip">‚ÑπÔ∏è
                    <span class="tooltiptext">1: Agresif, 10: Uzla≈ümacƒ±. Diplomatik yakla≈üƒ±mƒ±nƒ±z dƒ±≈ü ili≈ükileri ve ticari fƒ±rsatlarƒ± etkiler.</span>
                </div>
                <button id="apply-diplomatic-approach">Uygula</button>
            </div>
            
            <h3>√úlkelerle ƒ∞li≈ükiler</h3>
            <ul id="country-relations-list">
            </ul>

            <h3>Zirve Y√∂netimi</h3>
            <div class="foreign-actions">
                 <button id="create-summit-btn">Zirve D√ºzenle ($15M)</button>
            </div>
            <p>Zirveye davet edilecek √ºlkeler (En fazla 5):</p>
            <ul id="summit-invitation-list"></ul>
            <div class="foreign-actions">
                <button id="send-summit-invitations-btn" disabled>Davetleri G√∂nder</button>
            </div>


            <h3>Gelen Davetler / Olaylar</h3>
            <ul id="foreign-events-list">
            </ul>
            <h3>Genel Diplomatik Eylemler</h3>
            <div class="foreign-actions">
                <button id="global-summit-btn">Uluslararasƒ± Zirveye Katƒ±l ($10M)</button>
                <button id="sign-trade-deal">Ticaret Anla≈ümasƒ± ƒ∞mzala (Uygun √úlkeyle - $3M)</button>
                <button id="improve-relations">Dƒ±≈ü ƒ∞li≈ükileri Geli≈ütir (Genel - $2M)</button>
                <button id="declare-war">Sava≈ü ƒ∞lan Et (En K√∂t√º ƒ∞li≈ükili √úlkeye)</button>
            </div>
        </div>

        <div id="security-screen" class="game-screen">
            <h2>G√ºvenlik & Ordu</h2>
            <p>Su√ß Oranƒ±: <span id="crime-rate">5</span>%</p>
            <p>Halkƒ±n G√ºvenlik Algƒ±sƒ±: <span id="security-perception">75</span>%</p>
            <p>Ordu B√ºy√ºkl√ºƒü√º: <span id="army-size-security">50000</span></p>
            <p>Askeri G√º√ß Endeksi: <span id="military-strength-index">50</span></p>
            <p>Ordu Sadakati: <span id="army-loyalty-display">Y√ºksek</span></p>
            
            <div class="policy-slider">
                <div class="policy-slider-header">
                    <h3>G√ºvenlik Seviyesi (ƒ∞√ß Polisaj)</h3>
                    <span class="policy-value" id="security-level-value">5</span>
                </div>
                <input type="range" id="security-level-slider" min="1" max="10" value="5">
                <div class="tooltip">‚ÑπÔ∏è
                    <span class="tooltiptext">G√ºvenlik seviyesini artƒ±rmak su√ßlarƒ± azaltabilir ancak √∂zg√ºrl√ºkleri kƒ±sƒ±tlayabilir.</span>
                </div>
                <button id="apply-security-level">Uygula</button>
            </div>
            
            <h3>Emniyet / Adalet Kararlarƒ±</h3>
            <div class="flex-row">
                <label for="police-budget">Polis B√ºt√ßesi ($M):</label>
                <div class="input-with-buttons">
                    <button id="decrease-police-budget">-</button>
                    <input type="number" id="police-budget" value="3" min="1" max="20">
                    <button id="increase-police-budget">+</button>
                </div>
                <button id="increase-police-budget-btn">Uygula</button>
            </div>
            <div class="security-actions">
                <button id="reform-justice">Adalet Sistemini Reforme Et ($5M)</button>
                <button id="surveillance-program">G√∂zetim Programƒ± Ba≈ülat ($4M)</button>
                <button id="crackdown-dissent" title="Sadece Diktat√∂rl√ºkte etkili">Muhalefeti Bastƒ±r ($2M+)</button>
            </div>
            <p class="security-note">G√∂zetim programlarƒ± ve muhalefeti bastƒ±rma, su√ß oranƒ±nƒ± d√º≈ü√ºrebilir ancak halk memnuniyetini ve siyasi istikrarƒ± ciddi ≈üekilde etkileyebilir.</p>

            <h3>Askeri Kararlar</h3>
             <div class="flex-row">
                <label for="recruit-soldiers-input">Asker Alƒ±mƒ± (x1000 ki≈üi):</label> 
                <div class="input-with-buttons">
                    <button id="decrease-recruits">-</button>
                    <input type="number" id="recruit-soldiers-input" value="5" min="1" max="50">
                    <button id="increase-recruits">+</button>
                </div>
                <button id="recruit-soldiers-btn">Asker Al ($1M/1000 asker)</button>
            </div>
            <div class="security-actions">
                <button id="plan-war-btn">Sava≈ü Planlamasƒ± Yap ($5M)</button>
                <button id="military-exercise-btn">Askeri Tatbikat D√ºzenle ($10M+)</button>
                <button id="military-council-meeting-btn">Askeri ≈ûura ile Toplantƒ± ($1M)</button>
            </div>
        </div>

        <div id="reports-screen" class="game-screen">
            <h2>Raporlar & Zaman Y√∂netimi</h2>
            <p>Mevcut Tarih: Hafta <span id="report-current-week">1</span>, G√ºn <span id="report-current-day">1</span></p>
            <div class="reports-actions">
                <button id="advance-day-btn">G√ºn√º ƒ∞lerlet (1 G√ºn)</button>
                <button id="complete-week-reports-btn" disabled>Haftayƒ± Tamamla</button>
            </div>
            <hr>
            
            <div class="minister-advice">
                <h3>Ekonomi Bakanlƒ±ƒüƒ± Raporu</h3>
                <p>GSYƒ∞H Deƒüi≈üimi (Haftalƒ±k): <span id="gdp-change-report-display">-</span></p>
                <p>Enflasyon Deƒüi≈üimi (Haftalƒ±k): <span id="inflation-change-report-display">-</span></p>
                <p id="economy-report-inflation">Enflasyon Analizi: <span id="inflation-analysis">Hen√ºz analiz yapƒ±lmadƒ±.</span></p>
                <p id="economy-report-gdp">GSYƒ∞H Durumu: <span id="gdp-analysis">Hen√ºz analiz yapƒ±lmadƒ±.</span></p>
                <p id="economy-report-advice">√ñneriler: <span id="economy-recommendations">Hen√ºz √∂neri bulunmuyor.</span></p>
            </div>
            
            <div class="minister-advice">
                <h3>Sosyal Politikalar Raporu</h3>
                <p>Eƒüitim Kalitesi: <span id="education-quality-report">Yetersiz</span></p>
                <p>Saƒülƒ±k Hizmetleri Kalitesi: <span id="health-quality-report">Yetersiz</span></p>
                <p>Ulusal Bayram Sayƒ±sƒ±: <span id="holiday-count-report">0</span></p>
                <p>√ñneriler: <span id="social-recommendations">Hen√ºz √∂neri bulunmuyor.</span></p>
            </div>
            
            <div class="minister-advice">
                <h3>Siyasi Rapor</h3>
                <p>H√ºk√ºmet Desteƒüi (Memnuniyet): <span id="government-support-report">70%</span></p>
                <p>Meclis Desteƒüi: <span id="parliament-support-report">70%</span></p>
                <p>Siyasi ƒ∞stikrar: <span id="political-stability-report">70%</span></p>
                 <p>Medya √ñzg√ºrl√ºƒü√º Endeksi: <span id="media-freedom-report">7</span>/10</p>
                <p>√ñneriler: <span id="political-recommendations">Hen√ºz √∂neri bulunmuyor.</span></p>
            </div>
             <div class="minister-advice">
                <h3>Askeri Durum Raporu</h3>
                <p>Ordu Hazƒ±rlƒ±k Seviyesi: <span id="army-readiness-report">Orta</span></p>
                <p>Ordu Sadakati: <span id="army-loyalty-report">Y√ºksek</span></p>
                <p>Genelkurmay Deƒüerlendirmesi: <span id="military-assessment-report">Durum stabil.</span></p>
            </div>
            
            <h3>Ekonomi Verileri (Son 10 Hafta)</h3>
            <canvas id="reportChartCanvas" width="600" height="300"></canvas>
        </div>

        <div id="game-over-screen" class="game-screen">
            <h1>Oyun Bitti!</h1>
            <p id="game-over-reason"></p>
            <p>Son Hafta: <span id="final-week"></span></p>
            <p>Son N√ºfus: <span id="final-population"></span></p>
            <p>Son GSYƒ∞H: <span id="final-gdp"></span></p>
            <button id="restart-game-btn">Tekrar Oyna</button>
        </div>

    </div>

    <script>
        // --- Oyun Deƒüi≈ükenleri ---
        let week = 1;
        let dayOfWeek = 1; 
        let isAtWar = false;
        let governmentType = 'Demokrasi'; 
        let mediaFreedom = 7; 
        let mediaInfluence = 60; 
        let propagandaEffectWeeks = 0; 

        let population = 10000000;
        let gdp = 1000000000;
        let inflation = 2; 
        let satisfaction = 70; 
        let budget = 100000000; 
        let taxes = 10; 
        let educationSpending = 0; 
        let healthSpending = 0; 
        let cultureSpending = 0; 
        let crimeRate = 5; 
        let securityPerception = 75; 
        let politicalStability = 70; 
        let parliamentSupport = 70; 
        let foreignRelationsScore = 50; 
        let nationalHolidays = 0; 
        let armySize = 50000; 
        let militaryStrengthIndex = 50; 
        let armyUpkeepCostPerSoldier = 50; 
        let armyLoyalty = 80; 

        let socialPolicyLevel = 5; 
        let economicPolicyLevel = 5; 
        let diplomaticApproachLevel = 5; 
        let securityLevel = 5; 

        const historicalData = {
            weeks: [], gdp: [], satisfaction: [], inflation: [], politicalStability: []
        };
        
        let weeklyBudgetChange = 0; let weeklySatisfactionChange = 0; let weeklyGdpChangeFactor = 1;
        let weeklyInflationChange = 0; let weeklyPopulationChangeFactor = 1; let weeklyForeignRelationsChange = 0;
        let weeklyCrimeRateChange = 0; let weeklySecurityPerceptionChange = 0; let weeklyMilitaryStrengthChange = 0;
        let weeklyPoliticalStabilityChange = 0; let weeklyArmyLoyaltyChange = 0;
        let weeklyMediaFreedomChange = 0;


        const cabinet = {
            economy: { name: 'Bo≈ü', efficiency: 0.5, corruption: 0.1 }, education: { name: 'Bo≈ü', efficiency: 0.5, corruption: 0.1 },
            health: { name: 'Bo≈ü', efficiency: 0.5, corruption: 0.1 }, foreign: { name: 'Bo≈ü', efficiency: 0.5, corruption: 0.1 },
            interior: { name: 'Bo≈ü', efficiency: 0.5, corruption: 0.1 }, justice: { name: 'Bo≈ü', efficiency: 0.5, corruption: 0.1 },
            defense: { name: 'Bo≈ü', efficiency: 0.5, corruption: 0.1 } 
        };
        const countries = { 
            'Yunanistan': { relation: 40, tradeDeal: false, summitInvited: false, summitAccepted: false, militaryPower: 45 },
            'Bulgaristan': { relation: 55, tradeDeal: false, summitInvited: false, summitAccepted: false, militaryPower: 35 },
            'G√ºrcistan': { relation: 60, tradeDeal: true, summitInvited: false, summitAccepted: false, militaryPower: 30 },
            'Ermenistan': { relation: 20, tradeDeal: false, summitInvited: false, summitAccepted: false, militaryPower: 25 },
            'Azerbaycan': { relation: 75, tradeDeal: true, summitInvited: false, summitAccepted: false, militaryPower: 50 },
            'ƒ∞ran': { relation: 30, tradeDeal: false, summitInvited: false, summitAccepted: false, militaryPower: 65 },
            'Irak': { relation: 25, tradeDeal: false, summitInvited: false, summitAccepted: false, militaryPower: 40 },
            'Suriye': { relation: 15, tradeDeal: false, summitInvited: false, summitAccepted: false, militaryPower: 20 }, 
            'Rusya': { relation: 45, tradeDeal: false, summitInvited: false, summitAccepted: false, militaryPower: 90 },
            'Ukrayna': { relation: 50, tradeDeal: false, summitInvited: false, summitAccepted: false, militaryPower: 60 }
        };
        const parliamentAgenda = []; 
        let summitPlanned = false;
        let summitInvitationsSent = false;
        let gamePausedForWar = false; // Sava≈ü sim√ºlasyonu sƒ±rasƒ±nda diƒüer i≈ülemleri durdurmak i√ßin

        // --- DOM Elementleri ---
        // (Bu blok, √∂nceki kodunuzdaki t√ºm getElementById √ßaƒürƒ±larƒ±nƒ± i√ßermelidir. Kƒ±salƒ±k i√ßin tekrar yazƒ±lmadƒ±.)
        // √ñnemli olan, bu deƒüi≈ükenlerin scriptin ba≈üƒ±nda veya DOMContentLoaded i√ßinde tanƒ±mlanmasƒ±dƒ±r.
        const themeToggleBtn = document.getElementById('theme-toggle');
        const tabButtons = document.querySelectorAll('.tab-btn');
        const gameScreens = document.querySelectorAll('.game-screen');
        const currentWeekEl = document.getElementById('current-week');
        const currentDayOfWeekEl = document.getElementById('current-day-of-week'); 
        const populationEl = document.getElementById('population');
        const gdpEl = document.getElementById('gdp');
        const inflationEl = document.getElementById('inflation');
        const satisfactionEl = document.getElementById('satisfaction');
        const budgetEl = document.getElementById('budget');
        const taxRateEl = document.getElementById('tax-rate');
        const governmentTypeDisplayEl = document.getElementById('government-type-display');
        const mediaFreedomDisplayEl = document.getElementById('media-freedom-display');
        const politicalStabilityEl = document.getElementById('political-stability');
        const foreignRelationsScoreEl = document.getElementById('foreign-relations-score');
        const armySizeDisplayEl = document.getElementById('army-size-display');
        const gameLogEl = document.getElementById('game-log');
        const gameCanvas = document.getElementById('gameCanvas');
        const ctx = gameCanvas.getContext('2d');
        const taxSlider = document.getElementById('tax-slider');
        const taxSliderValue = document.getElementById('tax-slider-value');
        const applyTaxBtn = document.getElementById('apply-tax');
        const economyInvestmentInput = document.getElementById('economy-investment');
        const decreaseEconomyInvestmentBtn = document.getElementById('decrease-economy-investment');
        const increaseEconomyInvestmentBtn = document.getElementById('increase-economy-investment');
        const investEconomyBtn = document.getElementById('invest-economy');
        const educationInvestmentInput = document.getElementById('education-investment');
        const decreaseEducationInvestmentBtn = document.getElementById('decrease-education-investment');
        const increaseEducationInvestmentBtn = document.getElementById('increase-education-investment');
        const investEducationBtn = document.getElementById('invest-education');
        const healthInvestmentInput = document.getElementById('health-investment');
        const decreaseHealthInvestmentBtn = document.getElementById('decrease-health-investment');
        const increaseHealthInvestmentBtn = document.getElementById('increase-health-investment');
        const investHealthBtn = document.getElementById('invest-health');
        const cultureInvestmentInput = document.getElementById('culture-investment');
        const decreaseCultureInvestmentBtn = document.getElementById('decrease-culture-investment');
        const increaseCultureInvestmentBtn = document.getElementById('increase-culture-investment');
        const promoteCultureBtn = document.getElementById('promote-culture');
        const declareHolidayBtn = document.getElementById('declare-holiday');
        const endWeekBtn = document.getElementById('end-week-btn');
        const investGreenEnergyBtn = document.getElementById('invest-green-energy');
        const developDefenseIndustryBtn = document.getElementById('develop-defense-industry');
        const socialPolicySlider = document.getElementById('social-policy-slider');
        const socialPolicyValue = document.getElementById('social-policy-value');
        const applySocialPolicyBtn = document.getElementById('apply-social-policy');
        const economicPolicySlider = document.getElementById('economic-policy-slider');
        const economicPolicyValue = document.getElementById('economic-policy-value');
        const applyEconomicPolicyBtn = document.getElementById('apply-economic-policy');
        const diplomaticApproachSlider = document.getElementById('diplomatic-approach-slider');
        const diplomaticApproachValue = document.getElementById('diplomatic-approach-value');
        const applyDiplomaticApproachBtn = document.getElementById('apply-diplomatic-approach');
        const securityLevelSlider = document.getElementById('security-level-slider');
        const securityLevelValue = document.getElementById('security-level-value');
        const applySecurityLevelBtn = document.getElementById('apply-security-level');
        const policeBudgetInput = document.getElementById('police-budget');
        const decreasePoliceBudgetBtn = document.getElementById('decrease-police-budget');
        const increasePoliceBudgetBtn = document.getElementById('increase-police-budget');
        const increasePoliceBudgetBtnApply = document.getElementById('increase-police-budget-btn');
        const crimeRateEl = document.getElementById('crime-rate');
        const securityPerceptionEl = document.getElementById('security-perception');
        const armySizeSecurityEl = document.getElementById('army-size-security');
        const militaryStrengthIndexEl = document.getElementById('military-strength-index');
        const armyLoyaltyDisplayEl = document.getElementById('army-loyalty-display');
        const reformJusticeBtn = document.getElementById('reform-justice');
        const surveillanceProgramBtn = document.getElementById('surveillance-program');
        const crackdownDissentBtn = document.getElementById('crackdown-dissent');
        const recruitSoldiersInput = document.getElementById('recruit-soldiers-input');
        const decreaseRecruitsBtn = document.getElementById('decrease-recruits');
        const increaseRecruitsBtn = document.getElementById('increase-recruits');
        const recruitSoldiersBtn = document.getElementById('recruit-soldiers-btn');
        const planWarBtn = document.getElementById('plan-war-btn');
        const militaryExerciseBtn = document.getElementById('military-exercise-btn');
        const militaryCouncilMeetingBtn = document.getElementById('military-council-meeting-btn');
        const cabinetListEl = document.getElementById('cabinet-list');
        const ministerTypeSelect = document.getElementById('minister-type-select');
        const ministerNameInput = document.getElementById('minister-name-input');
        const appointMinisterBtn = document.getElementById('appoint-minister-btn');
        const economyAdviceText = document.getElementById('economy-advice-text');
        const educationAdviceText = document.getElementById('education-advice-text');
        const healthAdviceText = document.getElementById('health-advice-text');
        const foreignAdviceText = document.getElementById('foreign-advice-text');
        const interiorAdviceText = document.getElementById('interior-advice-text');
        const justiceAdviceText = document.getElementById('justice-advice-text');
        const defenseAdviceText = document.getElementById('defense-advice-text');
        const inflationAnalysisEl = document.getElementById('inflation-analysis');
        const gdpAnalysisEl = document.getElementById('gdp-analysis');
        const economyRecommendationsEl = document.getElementById('economy-recommendations');
        const socialRecommendationsEl = document.getElementById('social-recommendations');
        const politicalRecommendationsEl = document.getElementById('political-recommendations');
        const parliamentSupportEl = document.getElementById('parliament-support');
        const oppositionStrengthDisplayEl = document.getElementById('opposition-strength-display');
        const governmentTypeParliamentEl = document.getElementById('government-type-parliament');
        const mediaFreedomSlider = document.getElementById('media-freedom-slider');
        const mediaFreedomTargetValueEl = document.getElementById('media-freedom-target-value');
        const mediaFreedomValueDisplayEl = document.getElementById('media-freedom-value-display');
        const applyMediaPolicyBtn = document.getElementById('apply-media-policy');
        const startPropagandaBtn = document.getElementById('start-propaganda-btn');
        const applyCensorshipBtn = document.getElementById('apply-censorship-btn');
        const parliamentAgendaList = document.getElementById('parliament-agenda');
        const proposalInput = document.getElementById('proposal-input');
        const proposeLawBtn = document.getElementById('propose-law-btn');
        const callElectionsBtn = document.getElementById('call-elections');
        const declareDictatorshipBtn = document.getElementById('declare-dictatorship');
        const dissolveParliamentBtn = document.getElementById('dissolve-parliament-btn');
        const meetOppositionClosedBtn = document.getElementById('meet-opposition-closed-btn');
        const meetOppositionOpenBtn = document.getElementById('meet-opposition-open-btn');
        const foreignRelationsDisplayEl = document.getElementById('foreign-relations-display');
        const countryRelationsList = document.getElementById('country-relations-list');
        const foreignEventsList = document.getElementById('foreign-events-list');
        const globalSummitBtn = document.getElementById('global-summit-btn');
        const signTradeDealBtn = document.getElementById('sign-trade-deal');
        const improveRelationsBtn = document.getElementById('improve-relations');
        const declareWarBtn = document.getElementById('declare-war');
        const createSummitBtn = document.getElementById('create-summit-btn');
        const summitInvitationListEl = document.getElementById('summit-invitation-list');
        const sendSummitInvitationsBtn = document.getElementById('send-summit-invitations-btn');
        const advanceDayBtn = document.getElementById('advance-day-btn');
        const completeWeekReportsBtn = document.getElementById('complete-week-reports-btn');
        const reportCurrentWeekEl = document.getElementById('report-current-week');
        const reportCurrentDayEl = document.getElementById('report-current-day');
        const gdpChangeReportDisplayEl = document.getElementById('gdp-change-report-display');
        const inflationChangeReportDisplayEl = document.getElementById('inflation-change-report-display');
        const educationQualityReportEl = document.getElementById('education-quality-report');
        const healthQualityReportEl = document.getElementById('health-quality-report');
        const holidayCountReportEl = document.getElementById('holiday-count-report');
        const governmentSupportReportEl = document.getElementById('government-support-report');
        const parliamentSupportReportEl = document.getElementById('parliament-support-report');
        const politicalStabilityReportEl = document.getElementById('political-stability-report');
        const mediaFreedomReportEl = document.getElementById('media-freedom-report');
        const armyReadinessReportEl = document.getElementById('army-readiness-report');
        const armyLoyaltyReportEl = document.getElementById('army-loyalty-report');
        const militaryAssessmentReportEl = document.getElementById('military-assessment-report');
        const reportChartCanvas = document.getElementById('reportChartCanvas');
        const reportChartCtx = reportChartCanvas.getContext('2d');
        const gameOverScreen = document.getElementById('game-over-screen');
        const gameOverReasonEl = document.getElementById('game-over-reason');
        const finalWeekEl = document.getElementById('final-week');
        const finalPopulationEl = document.getElementById('final-population');
        const finalGdpEl = document.getElementById('final-gdp');
        const restartGameBtn = document.getElementById('restart-game-btn');
        
        
        function initTheme() { 
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                document.documentElement.classList.add('dark');
                if(themeToggleBtn) themeToggleBtn.textContent = '‚òÄÔ∏è';
            } else {
                 document.documentElement.classList.remove('dark');
                if(themeToggleBtn) themeToggleBtn.textContent = 'üåô';
            }
        }
        
        function showScreen(screenId) { 
            if(!gameScreens || !tabButtons) return; // Eƒüer ana elementler yoksa √ßƒ±k

            gameScreens.forEach(screen => { if(screen) screen.style.display = 'none'; });
            const targetScreen = document.getElementById(screenId);
            if (targetScreen) {
                 targetScreen.style.display = screenId === 'main-screen' ? 'grid' : 'block';
            } else {
                console.error("Hedef ekran bulunamadƒ±:", screenId);
                return; // Hedef ekran yoksa devam etme
            }

            tabButtons.forEach(btn => {
                if(btn) btn.classList.toggle('active', btn.dataset.tab === screenId);
            });

            // Zaman kontrol butonlarƒ±nƒ±n g√∂r√ºn√ºrl√ºƒü√º
            const mainScreenActive = (screenId === 'main-screen');
            const reportsScreenActive = (screenId === 'reports-screen');

            if(endWeekBtn) endWeekBtn.style.display = mainScreenActive ? 'inline-block' : 'none';
            if(advanceDayBtn) advanceDayBtn.style.display = reportsScreenActive ? 'inline-block' : 'none';
            if(completeWeekReportsBtn) completeWeekReportsBtn.style.display = reportsScreenActive ? 'inline-block' : 'none';
            
            enableAllActionButtons(); // Ekran deƒüi≈üiminde buton durumlarƒ±nƒ± g√ºncelle

            // Ekran √∂zel g√ºncellemeleri
            if (reportsScreenActive) updateReports(); 
            else if (screenId === 'cabinet-screen') updateMinisterAdvice();
            else if (screenId === 'foreign-affairs-screen') { updateForeignRelationsDisplay(); updateSummitInvitationList(); }
            else if (screenId === 'security-screen') {
                if(armySizeSecurityEl) armySizeSecurityEl.textContent = armySize.toLocaleString();
                if(militaryStrengthIndexEl) militaryStrengthIndexEl.textContent = militaryStrengthIndex.toFixed(0);
                if(armyLoyaltyDisplayEl) armyLoyaltyDisplayEl.textContent = getArmyLoyaltyStatus();
            } else if (screenId === 'parliament-screen') {
                if(oppositionStrengthDisplayEl) oppositionStrengthDisplayEl.textContent = `${(governmentType === 'Demokrasi' ? (100 - parliamentSupport) : 'N/A').toFixed(0)}%`;
                if(governmentTypeParliamentEl) governmentTypeParliamentEl.textContent = governmentType;
                if(mediaFreedomValueDisplayEl) mediaFreedomValueDisplayEl.textContent = mediaFreedom.toFixed(1);
                if(mediaFreedomSlider) mediaFreedomSlider.value = mediaFreedom;
                if(mediaFreedomTargetValueEl) mediaFreedomTargetValueEl.textContent = mediaFreedom.toFixed(1);
                updateParliamentDisplay(); 
            }
        }
        
        function getArmyLoyaltyStatus() { /* ... √ñncekiyle aynƒ± ... */
            if (armyLoyalty >= 80) return "√áok Y√ºksek";
            if (armyLoyalty >= 60) return "Y√ºksek";
            if (armyLoyalty >= 40) return "Orta";
            if (armyLoyalty >= 20) return "D√º≈ü√ºk";
            return "√áok D√º≈ü√ºk (ƒ∞syan Riski!)";
        }
        
        function resizeCanvas() { /* ... √ñncekiyle aynƒ± ... */
            const mainCanvasContainer = gameCanvas.parentElement;
            if (mainCanvasContainer && gameCanvas) { 
                 gameCanvas.width = mainCanvasContainer.offsetWidth;
                 gameCanvas.height = 300; 
                 drawCanvasStats();
            }
            const reportCanvasContainer = reportChartCanvas.parentElement;
            if (reportCanvasContainer && reportChartCanvas) { 
                reportChartCanvas.width = reportCanvasContainer.offsetWidth > 0 ? reportCanvasContainer.offsetWidth * 0.98 : 300; 
                reportChartCanvas.height = 300; 
                drawReportChart(); 
            }
         }
        
        function resetGame() {
            week = 1; dayOfWeek = 1; isAtWar = false; gamePausedForWar = false;
            governmentType = 'Demokrasi'; mediaFreedom = 7; mediaInfluence = 60; propagandaEffectWeeks = 0;
            population = 10000000; gdp = 1000000000; inflation = 2; satisfaction = 70;
            budget = 100000000; taxes = 10; educationSpending = 0; healthSpending = 0; cultureSpending = 0;
            crimeRate = 5; securityPerception = 75; politicalStability = 70;
            parliamentSupport = 70; foreignRelationsScore = 50; nationalHolidays = 0;
            armySize = 50000; militaryStrengthIndex = 50; armyLoyalty = 80;
            summitPlanned = false; summitInvitationsSent = false;
            
            socialPolicyLevel = 5; economicPolicyLevel = 5; diplomaticApproachLevel = 5; securityLevel = 5;
            
            if(taxSlider) taxSlider.value = taxes; if(taxSliderValue) taxSliderValue.textContent = taxes;
            if(socialPolicySlider) socialPolicySlider.value = socialPolicyLevel; if(socialPolicyValue) socialPolicyValue.textContent = socialPolicyLevel;
            if(economicPolicySlider) economicPolicySlider.value = economicPolicyLevel; if(economicPolicyValue) economicPolicyValue.textContent = economicPolicyLevel;
            if(diplomaticApproachSlider) diplomaticApproachSlider.value = diplomaticApproachLevel; if(diplomaticApproachValue) diplomaticApproachValue.textContent = diplomaticApproachLevel;
            if(securityLevelSlider) securityLevelSlider.value = securityLevel; if(securityLevelValue) securityLevelValue.textContent = securityLevel;
            if(mediaFreedomSlider) mediaFreedomSlider.value = mediaFreedom; if(mediaFreedomTargetValueEl) mediaFreedomTargetValueEl.textContent = mediaFreedom.toFixed(1);

             ['weekly'].forEach(prefix => { 
                Object.keys(window).filter(k => k.startsWith(prefix) && typeof window[k] === 'number').forEach(key => {
                    if (key.includes('Factor')) window[key] = 1; else window[key] = 0;
                });
            });

            historicalData.weeks = []; historicalData.gdp = []; historicalData.satisfaction = [];
            historicalData.inflation = []; historicalData.politicalStability = [];

            for (const type in cabinet) {
                cabinet[type] = { name: 'Bo≈ü', efficiency: 0.4 + Math.random() * 0.3, corruption: 0.05 + Math.random() * 0.2 };
            }
            updateCabinetDisplay();
             const initialCountries = { /* ... √ñncekiyle aynƒ± ... */
                'Yunanistan': { relation: 30 + Math.floor(Math.random()*21)-10, tradeDeal: false, militaryPower: 40 + Math.floor(Math.random()*11)-5 },
                'Bulgaristan': { relation: 45 + Math.floor(Math.random()*21)-10, tradeDeal: false, militaryPower: 30 + Math.floor(Math.random()*11)-5 },
                'G√ºrcistan': { relation: 50 + Math.floor(Math.random()*21)-10, tradeDeal: Math.random() < 0.3, militaryPower: 25 + Math.floor(Math.random()*11)-5 },
                'Ermenistan': { relation: 15 + Math.floor(Math.random()*21)-10, tradeDeal: false, militaryPower: 20 + Math.floor(Math.random()*11)-5 },
                'Azerbaycan': { relation: 65 + Math.floor(Math.random()*21)-10, tradeDeal: Math.random() < 0.5, militaryPower: 45 + Math.floor(Math.random()*11)-5 },
                'ƒ∞ran': { relation: 25 + Math.floor(Math.random()*21)-10, tradeDeal: false, militaryPower: 60 + Math.floor(Math.random()*11)-5 },
                'Irak': { relation: 20 + Math.floor(Math.random()*21)-10, tradeDeal: false, militaryPower: 35 + Math.floor(Math.random()*11)-5 },
                'Suriye': { relation: 10 + Math.floor(Math.random()*21)-10, tradeDeal: false, militaryPower: 15 + Math.floor(Math.random()*11)-5 },
                'Rusya': { relation: 40 + Math.floor(Math.random()*21)-10, tradeDeal: false, militaryPower: 85 + Math.floor(Math.random()*11)-5 },
                'Ukrayna': { relation: 45 + Math.floor(Math.random()*21)-10, tradeDeal: false, militaryPower: 55 + Math.floor(Math.random()*11)-5 }
            };
             for (const countryName in countries) { 
                if (initialCountries[countryName]) {
                    countries[countryName].relation = Math.max(0, Math.min(100, initialCountries[countryName].relation));
                    countries[countryName].tradeDeal = initialCountries[countryName].tradeDeal;
                    countries[countryName].militaryPower = initialCountries[countryName].militaryPower;
                    countries[countryName].summitInvited = false;
                    countries[countryName].summitAccepted = false;
                }
            }
            updateForeignRelationsDisplay();
            updateSummitInvitationList();

            parliamentAgenda.length = 0; 
            updateParliamentDisplay();
            if(foreignEventsList) foreignEventsList.innerHTML = ''; 
            if(gameLogEl) gameLogEl.innerHTML = ''; 
            
            if(gameOverScreen) gameOverScreen.style.display = 'none';
            
            addLog('Ulus Sim√ºlat√∂r√º Ba≈üladƒ±! Yeni bir oyun...');
            updateGameStats(); 
            updateMinisterAdvice(); 
            updateReports();
            resizeCanvas(); 
            enableAllActionButtons(); // Butonlarƒ± oyun durumuna g√∂re ayarla
            showScreen('main-screen'); 
        }

        function updateGameStats() { /* ... √ñncekiyle aynƒ±, politicalSystem kaldƒ±rƒ±ldƒ± ... */
            if(currentWeekEl) currentWeekEl.textContent = week;
            if(currentDayOfWeekEl) currentDayOfWeekEl.textContent = dayOfWeek; 
            if(populationEl) populationEl.textContent = population.toLocaleString();
            if(gdpEl) gdpEl.textContent = gdp.toLocaleString();
            if(inflationEl) inflationEl.textContent = inflation.toFixed(1);
            if(satisfactionEl) satisfactionEl.textContent = satisfaction.toFixed(1);
            if(budgetEl) budgetEl.textContent = budget.toLocaleString();
            if(taxRateEl) taxRateEl.textContent = taxes.toFixed(1);
            if(governmentTypeDisplayEl) governmentTypeDisplayEl.textContent = governmentType; 
            if(mediaFreedomDisplayEl) mediaFreedomDisplayEl.textContent = `${mediaFreedom.toFixed(1)}/10`; 
            if(politicalStabilityEl) politicalStabilityEl.textContent = politicalStability.toFixed(1) + '%';
            if(foreignRelationsScoreEl) foreignRelationsScoreEl.textContent = foreignRelationsScore.toFixed(0);
            if(armySizeDisplayEl) armySizeDisplayEl.textContent = armySize.toLocaleString(); 
            if(armySizeSecurityEl) armySizeSecurityEl.textContent = armySize.toLocaleString(); 
            if(militaryStrengthIndexEl) militaryStrengthIndexEl.textContent = militaryStrengthIndex.toFixed(0);
            if(armyLoyaltyDisplayEl) armyLoyaltyDisplayEl.textContent = getArmyLoyaltyStatus();

            if(crimeRateEl) crimeRateEl.textContent = crimeRate.toFixed(1);
            if(securityPerceptionEl) securityPerceptionEl.textContent = securityPerception.toFixed(1);
            
            if(reportCurrentWeekEl) reportCurrentWeekEl.textContent = week; 
            if(reportCurrentDayEl) reportCurrentDayEl.textContent = dayOfWeek;

            drawCanvasStats(); 
            const reportsScreen = document.getElementById('reports-screen');
            if(reportsScreen && reportsScreen.style.display !== 'none') {
                 updateReports(); 
            }
        }

        function addLog(message, type = 'info', isDaily = false) { /* ... √ñncekiyle aynƒ± ... */
            const listItem = document.createElement('li');
            const timePrefix = isDaily ? `H${week}, G${dayOfWeek}: ` : `Hafta ${week}: `;
            listItem.textContent = timePrefix + message;

            if (type === 'warning') listItem.style.color = 'var(--warning-color)';
            else if (type === 'danger') listItem.style.color = 'var(--danger-color)';
            else if (type === 'success') listItem.style.color = 'var(--success-color)';
            else if (type === 'event') { listItem.style.color = 'var(--accent-color)'; listItem.style.fontWeight = 'bold';}
            
            if(isDaily) listItem.classList.add('daily');

            if(gameLogEl) gameLogEl.prepend(listItem); 
            if (gameLogEl && gameLogEl.children.length > 80) { 
                gameLogEl.removeChild(gameLogEl.lastChild);
            }
         }

        function drawCanvasStats() { /* ... √ñncekiyle aynƒ± ... */ 
            if (!gameCanvas || !ctx) return;
            ctx.clearRect(0, 0, gameCanvas.width, gameCanvas.height);
            const barHeight = 20;
            const barWidth = Math.max(50, gameCanvas.width - 130); 
            const startX = 110; 
            let currentY = 30;
            const textColor = getComputedStyle(document.documentElement).getPropertyValue('--text-color');
            const borderColor = getComputedStyle(document.documentElement).getPropertyValue('--border-color');
            ctx.font = '14px Arial'; 

            function drawBar(label, value, maxValue, colorFunc) {
                ctx.fillStyle = textColor;
                ctx.fillText(label, 10, currentY + barHeight / 2 + 5);
                const fillWidth = (value / maxValue) * barWidth;
                ctx.fillStyle = colorFunc(value, maxValue);
                ctx.fillRect(startX, currentY, fillWidth, barHeight);
                ctx.strokeStyle = borderColor;
                ctx.strokeRect(startX, currentY, barWidth, barHeight);
                ctx.fillStyle = textColor;
                ctx.fillText(`<span class="math-inline">\{value\.toFixed\(1\)\}</span>{maxValue === 100 || maxValue === 25 || maxValue === 10 ? '%' : ''}`, startX + barWidth + 5, currentY + barHeight / 2 + 5);
                currentY += barHeight + 15; 
            }

            drawBar('Memnuniyet:', satisfaction, 100, (val) => `rgb(${255 - (val * 2.55)}, ${val * 2.55}, 0)`);
            drawBar('Enflasyon:', Math.min(inflation, 25), 25, (val, max) => `rgb(${(val/max) * 255}, ${255 - ((val/max) * 255)}, 0)`); 
            drawBar('Dƒ±≈ü ƒ∞li≈ükiler:', foreignRelationsScore, 100, (val) => `rgb(0, ${val * 1.5}, ${255 - (val * 1.5)})`); 
            drawBar('Su√ß Oranƒ±:', Math.min(crimeRate, 25), 25, (val, max) => `rgb(${(val/max) * 255}, ${150 - ((val/max) * 150)}, 0)`); 
            drawBar('ƒ∞stikrar:', politicalStability, 100, (val) => `rgb(${val*0.5}, ${val * 2}, ${255 - val * 2})`);
            drawBar('Med. √ñzg.:', mediaFreedom, 10, (val,max) => `rgb(${val/max * 100}, ${val/max * 200}, ${255 - val/max * 100})`);
        }

        function drawReportChart() { /* ... √ñncekiyle aynƒ± ... */ 
            if (!reportChartCanvas || !reportChartCtx) return;
            reportChartCtx.clearRect(0, 0, reportChartCanvas.width, reportChartCanvas.height);
             const textColor = getComputedStyle(document.documentElement).getPropertyValue('--text-color');
            const borderColor = getComputedStyle(document.documentElement).getPropertyValue('--border-color');

            if (historicalData.weeks.length < 1) { 
                reportChartCtx.font = '16px Arial';
                reportChartCtx.fillStyle = textColor;
                reportChartCtx.textAlign = 'center';
                reportChartCtx.fillText('Grafik i√ßin hen√ºz yeterli veri yok.', reportChartCanvas.width / 2, reportChartCanvas.height / 2);
                return;
            }

            const padding = 40;
            const chartWidth = reportChartCanvas.width - (padding * 2);
            const chartHeight = reportChartCanvas.height - (padding * 2);
            
            if (chartWidth <= 0 || chartHeight <= 0) return; 

            reportChartCtx.beginPath();
            reportChartCtx.strokeStyle = borderColor;
            reportChartCtx.moveTo(padding, padding);
            reportChartCtx.lineTo(padding, reportChartCanvas.height - padding);
            reportChartCtx.lineTo(reportChartCanvas.width - padding, reportChartCanvas.height - padding);
            reportChartCtx.stroke();
            const dataPoints = Math.min(historicalData.weeks.length, 10);
            const startIndex = Math.max(0, historicalData.weeks.length - dataPoints);
            
            reportChartCtx.font = '12px Arial';
            reportChartCtx.fillStyle = textColor;
            reportChartCtx.textAlign = 'center';
            
            if (dataPoints > 1) { 
                for (let i = 0; i < dataPoints; i++) {
                    const x = padding + (i * (chartWidth / (dataPoints - 1)));
                    if(historicalData.weeks[startIndex+i] !== undefined) reportChartCtx.fillText(historicalData.weeks[startIndex + i].toString(), x, reportChartCanvas.height - padding + 20);
                }
            } else if (dataPoints === 1 && historicalData.weeks[startIndex] !== undefined) { 
                 const x = padding + chartWidth / 2;
                 reportChartCtx.fillText(historicalData.weeks[startIndex].toString(), x, reportChartCanvas.height - padding + 20);
            }

            function drawLine(dataArray, color, maxValue = 100, normalize = false) {
                if (dataPoints === 0 || !dataArray || dataArray.length === 0) return;
                reportChartCtx.beginPath();
                reportChartCtx.strokeStyle = color;
                reportChartCtx.lineWidth = 2;
                
                let valuesToProcess = dataArray.slice(startIndex, startIndex + dataPoints);
                if(valuesToProcess.length === 0 && dataArray.length > 0 && dataPoints === 1 && dataArray[dataArray.length-1] !== undefined) { 
                    valuesToProcess = [dataArray[dataArray.length-1]];
                }

                let minVal = 0, range = maxValue;

                if (normalize && valuesToProcess.length > 0) {
                    const numericValues = valuesToProcess.filter(v => typeof v === 'number' && !isNaN(v));
                    if (numericValues.length === 0) return; 
                    minVal = Math.min(...numericValues); 
                    let maxVal = Math.max(...numericValues);
                    range = maxVal - minVal;
                    if (range === 0) range = 1; 
                }

                for (let i = 0; i < valuesToProcess.length; i++) {
                    const x = padding + (valuesToProcess.length > 1 ? (i * (chartWidth / (valuesToProcess.length - 1))) : chartWidth / 2);
                    let value = valuesToProcess[i];
                     if(typeof value !== 'number' || isNaN(value)) continue; 

                    let normalizedValue;

                    if (normalize) {
                        normalizedValue = (value - minVal) / range;
                    } else {
                        normalizedValue = Math.min(value, maxValue) / maxValue;
                    }
                    
                    const y = reportChartCanvas.height - padding - (normalizedValue * chartHeight);

                    if (i === 0) reportChartCtx.moveTo(x, y);
                    else reportChartCtx.lineTo(x, y);
                }
                reportChartCtx.stroke();
            }
            
            drawLine(historicalData.satisfaction, 'rgb(46, 204, 113)'); 
            drawLine(historicalData.inflation, 'rgb(231, 76, 60)', 25); 
            drawLine(historicalData.gdp, 'rgb(52, 152, 219)', 0, true); 
            drawLine(historicalData.politicalStability, 'rgb(155, 89, 182)', 100); 

            reportChartCtx.font = '12px Arial'; 
            reportChartCtx.textAlign = 'left'; 
            reportChartCtx.fillStyle = 'rgb(46, 204, 113)';
            reportChartCtx.fillText('Mem.', padding + 5, padding - 5); 
            reportChartCtx.fillStyle = 'rgb(231, 76, 60)';
            reportChartCtx.fillText('Enf.', padding + 60, padding - 5); 
            reportChartCtx.fillStyle = 'rgb(52, 152, 219)';
            reportChartCtx.fillText('GSYƒ∞H', padding + 110, padding - 5);
             reportChartCtx.fillStyle = 'rgb(155, 89, 182)';
            reportChartCtx.fillText('ƒ∞stik.', padding + 175, padding - 5); 
        }

        function updateMinisterAdvice() { /* ... √ñncekiyle aynƒ± ... */ 
            if(!economyAdviceText || !educationAdviceText || !healthAdviceText || !foreignAdviceText || !interiorAdviceText || !justiceAdviceText || !defenseAdviceText) return; 
            economyAdviceText.textContent = cabinet.economy.name === 'Bo≈ü' ? "Atanmadƒ±." : 
                (inflation > 15 ? "KRƒ∞Tƒ∞K ENFLASYON! Acil sƒ±kƒ± para politikasƒ± ve mali disiplin!" : 
                (inflation > 8 ? "Y√ºksek enflasyon endi≈üe verici. Harcamalarƒ± kontrol altƒ±na alƒ±n." : 
                (gdp < population * 80 ) ? "Ekonomik daralma var. Te≈üvikleri d√º≈ü√ºn√ºn." : "Ekonomi stabil, mevcut politikalar s√ºrd√ºr√ºlebilir.")); 

            educationAdviceText.textContent = cabinet.education.name === 'Bo≈ü' ? "Atanmadƒ±." :
                (educationSpending < population * 0.2 ? "Eƒüitim yatƒ±rƒ±mlarƒ± yetersiz. Kalite d√º≈ü√ºyor, halk tepkili." :
                (educationSpending < population * 0.5 ? "Eƒüitim b√ºt√ßesi artƒ±rƒ±lmalƒ±. Geleceƒüe yatƒ±rƒ±m √∂nemli." : "Eƒüitim yatƒ±rƒ±mlarƒ± iyi durumda."));

            healthAdviceText.textContent = cabinet.health.name === 'Bo≈ü' ? "Atanmadƒ±." :
                (healthSpending < population * 0.3 ? "Saƒülƒ±k sistemi √ß√∂kme noktasƒ±nda! Acil kaynak aktarƒ±n." :
                (healthSpending < population * 0.7 ? "Saƒülƒ±k hizmetleri geli≈ütirilmeli. Halk saƒülƒ±ƒüƒ± √∂nceliƒüimiz." : "Saƒülƒ±k altyapƒ±mƒ±z g√º√ßl√º."));
            
            foreignAdviceText.textContent = cabinet.foreign.name === 'Bo≈ü' ? "Atanmadƒ±." :
                (foreignRelationsScore < 25 ? "Uluslararasƒ± izolasyonla kar≈üƒ± kar≈üƒ±yayƒ±z! Acil diplomatik a√ßƒ±lƒ±m ≈üart." :
                (foreignRelationsScore < 50 ? "Dƒ±≈ü ili≈ükilerimiz zayƒ±f. Kom≈üularla ve m√ºttefiklerle ili≈ükileri g√º√ßlendirin." : "Diplomatik konumumuz iyi. Mevcut stratejiyi koruyun."));

            interiorAdviceText.textContent = cabinet.interior.name === 'Bo≈ü' ? "Atanmadƒ±." :
                (crimeRate > 12 ? "Su√ß oranlarƒ± kontrolden √ßƒ±ktƒ±! Emniyet te≈ükilatƒ±nƒ± g√º√ßlendirin." :
                (securityPerception < 40 ? "Halk kendini g√ºvende hissetmiyor. G√ºvenlik algƒ±sƒ±nƒ± artƒ±racak adƒ±mlar atƒ±n." : "ƒ∞√ß g√ºvenlik durumu stabil."));

            justiceAdviceText.textContent = cabinet.justice.name === 'Bo≈ü' ? "Atanmadƒ±." :
                (politicalStability < 40 && crimeRate > 8 ? "Adalet sistemi i≈ülemiyor, kaos kapƒ±da! Acil reform ve caydƒ±rƒ±cƒ±lƒ±k." :
                (crimeRate > 8 ? "Hukukun √ºst√ºnl√ºƒü√º zayƒ±f. Yargƒ± reformu ve polis desteƒüi gerekli." : "Adalet sistemi g√∂revini yapƒ±yor."));
            
            defenseAdviceText.textContent = cabinet.defense.name === 'Bo≈ü' ? "Atanmadƒ±." :
                (militaryStrengthIndex < 35 ? "Ordumuz zayƒ±f! Modernizasyon ve personel takviyesi acil ihtiya√ß." :
                (armyLoyalty < 50 ? "Ordu i√ßinde huzursuzluk var! Sadakati artƒ±racak √∂nlemler alƒ±nmalƒ±." :
                (foreignRelationsScore < 30 && Object.values(countries).some(c => c.relation < 15 && c.militaryPower > militaryStrengthIndex*0.8)) ? "Sƒ±nƒ±rda gerginlik y√ºksek, olasƒ± bir saldƒ±rƒ±ya kar≈üƒ± hazƒ±rlƒ±klƒ± olunmalƒ±!" :
                 "Savunma kapasitemiz yeterli. Ordunun moralini y√ºksek tutun."));
        }

        function updateMinisterReports() { /* ... √ñncekiyle aynƒ± ... */ 
            if(!inflationAnalysisEl || !gdpAnalysisEl || !economyRecommendationsEl || !educationQualityReportEl || !healthQualityReportEl || !holidayCountReportEl || !socialRecommendationsEl || !governmentSupportReportEl || !parliamentSupportReportEl || !politicalStabilityReportEl || !mediaFreedomReportEl || !politicalRecommendationsEl || !armyReadinessReportEl || !armyLoyaltyReportEl || !militaryAssessmentReportEl || !gdpChangeReportDisplayEl || !inflationChangeReportDisplayEl) return;
             // Ekonomi Raporu
            inflationAnalysisEl.textContent = cabinet.economy.name === 'Bo≈ü' ? "Atanmadƒ±." : 
                (inflation > 15 ? "A≈üƒ±rƒ± y√ºksek enflasyon, hiperenflasyon riski! Acil m√ºdahale gerekli." : 
                 inflation > 8 ? "√áift haneli enflasyon, alƒ±m g√ºc√º d√º≈ü√ºyor, sosyal huzursuzluk artabilir." : 
                 inflation > 4 ? "Enflasyon hedefin √ºzerinde, dikkatli olunmalƒ±." : 
                 inflation < 1 ? "Deflasyon riski, ekonomik durgunluƒüa yol a√ßabilir." : "Enflasyon kontrol altƒ±nda.");
            gdpAnalysisEl.textContent = cabinet.economy.name === 'Bo≈ü' ? "Atanmadƒ±." :
                (gdp < population * 80 ? "Ciddi ekonomik kriz. GSYƒ∞H √ßok d√º≈ü√ºk." :
                 (gdp < population * 120 && weeklyGdpChangeFactor < 1) ? "Ekonomik durgunluk veya hafif daralma." :
                 (weeklyGdpChangeFactor > 1.01) ? "G√º√ßl√º ekonomik b√ºy√ºme kaydediliyor." : "Ekonomi stabil veya yava≈ü b√ºy√ºyor.");
            economyRecommendationsEl.textContent = cabinet.economy.name === 'Bo≈ü' ? "Atanmadƒ±." : 
                (inflation > 10 && budget < 0 ? "Mali disiplin ≈üart, vergileri artƒ±rƒ±p harcamalarƒ± kƒ±sƒ±n." : 
                 gdp < population*100 && inflation < 3 ? "Ekonomiyi canlandƒ±rmak i√ßin te≈üvikler ve yatƒ±rƒ±mlar d√º≈ü√ºn√ºlebilir." : "Dengeli politikalar s√ºrd√ºr√ºlmeli.");

            // Sosyal Politikalar
            educationQualityReportEl.textContent = educationSpending > population * 0.8 ? '√áok ƒ∞yi' : educationSpending > population * 0.4 ? 'ƒ∞yi' : educationSpending > population * 0.1 ? 'Orta' : 'Yetersiz';
            healthQualityReportEl.textContent = healthSpending > population * 1 ? '√áok ƒ∞yi' : healthSpending > population * 0.5 ? 'ƒ∞yi' : healthSpending > population * 0.2 ? 'Orta' : 'Yetersiz';
            holidayCountReportEl.textContent = nationalHolidays;
            socialRecommendationsEl.textContent = (educationQualityReportEl.textContent === 'Yetersiz' || healthQualityReportEl.textContent === 'Yetersiz') ? "Sosyal harcamalar artƒ±rƒ±lmalƒ±." : "Sosyal denge g√∂zetiliyor.";
            
            // Siyasi Rapor
            governmentSupportReportEl.textContent = `${satisfaction.toFixed(1)}%`;
            parliamentSupportReportEl.textContent = `${governmentType === 'Demokrasi' ? parliamentSupport.toFixed(1) : 'N/A'}%`;
            politicalStabilityReportEl.textContent = `${politicalStability.toFixed(1)}%`;
            mediaFreedomReportEl.textContent = `${mediaFreedom.toFixed(1)}/10`; 
            politicalRecommendationsEl.textContent = politicalStability < 40 ? "Siyasi istikrarsƒ±zlƒ±k had safhada, acil uzla≈üƒ± ve reform gerekli." : "Siyasi ortam g√∂receli sakin.";
            
            // Askeri Rapor
            armyReadinessReportEl.textContent = militaryStrengthIndex > 70 ? "√áok Y√ºksek" : militaryStrengthIndex > 50 ? "Y√ºksek" : militaryStrengthIndex > 30 ? "Orta" : "D√º≈ü√ºk";
            armyLoyaltyReportEl.textContent = getArmyLoyaltyStatus();
            militaryAssessmentReportEl.textContent = cabinet.defense.name === 'Bo≈ü' ? "Atanmadƒ±." : "Genelkurmay, durumu deƒüerlendiriyor. Detaylar i√ßin Askeri ≈ûura toplantƒ±sƒ± talep edin.";

            gdpChangeReportDisplayEl.textContent = `${((gdpGrowthFactorGlobalForReport || 1) -1 * 100).toFixed(2)}%`; 
            inflationChangeReportDisplayEl.textContent = `${(inflationChangeGlobalForReport || 0).toFixed(2)}%`;
        }
         let gdpGrowthFactorGlobalForReport = 1; 
         let inflationChangeGlobalForReport = 0;

        function isGameOver() { // Oyun sonu durumunu kontrol et
            return gameOverScreen && gameOverScreen.style.display !== 'none';
        }

        function enableAllActionButtons() {
            const allActionButtons = document.querySelectorAll('.actions-panel button, .cabinet-actions button, .parliament-propose button, .security-actions button, .foreign-actions button, .opposition-actions button, .policy-slider button, .reports-actions button');
            const gameIsOver = isGameOver();

            allActionButtons.forEach(button => {
                if (button.id === 'restart-game-btn' || button.id === 'theme-toggle') return; // Bu butonlar her zaman aktif veya kendi logiƒüi var
                button.disabled = gameIsOver || isAtWar || gamePausedForWar;
            });

            if (gameIsOver || isAtWar || gamePausedForWar) {
                if(endWeekBtn) endWeekBtn.disabled = true;
                if(advanceDayBtn) advanceDayBtn.disabled = true;
                if(completeWeekReportsBtn) completeWeekReportsBtn.disabled = true;
                return; // Oyun bittiyse veya sava≈ü varsa ba≈üka kurala bakma
            }

            // Normal oyun durumu
            const isDemocracy = (governmentType === 'Demokrasi');
            const isAuthoritarian = (governmentType === 'Otoriter Demokrasi' || governmentType === 'Diktat√∂rl√ºk');
            const isDictatorship = (governmentType === 'Diktat√∂rl√ºk');

            if(declareDictatorshipBtn) declareDictatorshipBtn.disabled = !isDemocracy || satisfaction < 25 || armyLoyalty < 40 || politicalStability < 25;
            if(crackdownDissentBtn) crackdownDissentBtn.disabled = isDemocracy;
            if(callElectionsBtn) callElectionsBtn.disabled = !isDemocracy && governmentType !== 'Otoriter Demokrasi';
            if(dissolveParliamentBtn) dissolveParliamentBtn.disabled = isDictatorship || (isDemocracy && (parliamentSupport > 35 || politicalStability > 45));
            if(meetOppositionClosedBtn) meetOppositionClosedBtn.disabled = isDictatorship;
            if(meetOppositionOpenBtn) meetOppositionOpenBtn.disabled = isDictatorship;
            if(proposeLawBtn) proposeLawBtn.disabled = isDictatorship;
            if(applyCensorshipBtn) applyCensorshipBtn.disabled = isDemocracy && mediaFreedom > 5;
            if(startPropagandaBtn) startPropagandaBtn.disabled = isDictatorship && mediaFreedom < 2;
            
            if(sendSummitInvitationsBtn) sendSummitInvitationsBtn.disabled = !summitPlanned || summitInvitationsSent || getSelectedSummitInvitees().length === 0;
            if(createSummitBtn) createSummitBtn.disabled = summitPlanned; 

            // Zaman kontrol butonlarƒ± (sadece ilgili ekranda g√∂r√ºn√ºr olacaklarƒ± i√ßin showScreen'de de y√∂netiliyor)
            const currentScreenId = document.querySelector('.game-screen[style*="block"], .game-screen[style*="grid"]')?.id;
            if(endWeekBtn) endWeekBtn.disabled = (currentScreenId !== 'main-screen') || isAtWar;
            if(advanceDayBtn) advanceDayBtn.disabled = (currentScreenId !== 'reports-screen') || isAtWar || (dayOfWeek > 7);
            if(completeWeekReportsBtn) completeWeekReportsBtn.disabled = (currentScreenId !== 'reports-screen') || isAtWar || (dayOfWeek <= 7);
        }


        function gameOver(reason, type = 'normal') { /* ... √ñncekiyle aynƒ± ... */
            addLog(`Oyun Bitti! ${reason}`, 'danger');
            isAtWar = false; 
            enableAllActionButtons(); // Bu fonksiyon artƒ±k gameIsOver durumunu kontrol edecek
            
            if(gameOverReasonEl) gameOverReasonEl.textContent = reason;
            if(finalWeekEl) finalWeekEl.textContent = week;
            if(finalPopulationEl) finalPopulationEl.textContent = population.toLocaleString();
            if(finalGdpEl) finalGdpEl.textContent = gdp.toLocaleString();

            if (type === 'coup' && gameOverReasonEl) gameOverReasonEl.innerHTML += "<br>Ordu y√∂netime el koydu!";
            else if (type === 'civil_war' && gameOverReasonEl) gameOverReasonEl.innerHTML += "<br>√úlke i√ß sava≈üa s√ºr√ºklendi ve b√∂l√ºnd√º!";
            else if (type === 'retirement' && gameOverReasonEl) gameOverReasonEl.innerHTML += "<br>Huzurlu bir emeklilik sizi bekliyor.";
            else if (type === 'dictator_win' && gameOverReasonEl) gameOverReasonEl.innerHTML += "<br>Mutlak g√ºc√ºn√ºz√º ilan ettiniz.";
            
            showScreen('game-over-screen');
         }
        
        function applyDailyChanges() { /* ... √ñncekiyle aynƒ± ... */
            budget += weeklyBudgetChange; 
            satisfaction += weeklySatisfactionChange;
            gdp *= weeklyGdpChangeFactor;
            inflation += weeklyInflationChange;
            population = Math.round(population * weeklyPopulationChangeFactor);
            foreignRelationsScore += weeklyForeignRelationsChange;
            crimeRate += weeklyCrimeRateChange;
            securityPerception += weeklySecurityPerceptionChange;
            militaryStrengthIndex += weeklyMilitaryStrengthChange;
            politicalStability += weeklyPoliticalStabilityChange;
            armyLoyalty += weeklyArmyLoyaltyChange;
            mediaFreedom += weeklyMediaFreedomChange;


            satisfaction = Math.max(0, Math.min(100, satisfaction));
            inflation = Math.max(0.05, Math.min(50, inflation));
            population = Math.max(10000, population); 
            foreignRelationsScore = Math.max(0, Math.min(100, foreignRelationsScore));
            crimeRate = Math.max(0.1, Math.min(30, crimeRate));
            securityPerception = Math.max(0, Math.min(100, securityPerception));
            militaryStrengthIndex = Math.max(5, Math.min(100, militaryStrengthIndex));
            politicalStability = Math.max(0, Math.min(100, politicalStability));
            armyLoyalty = Math.max(0, Math.min(100, armyLoyalty));
            mediaFreedom = Math.max(0, Math.min(10, mediaFreedom));
            gdp = Math.max(population * 10, gdp); 

            weeklyBudgetChange = 0; weeklySatisfactionChange = 0; weeklyGdpChangeFactor = 1;
            weeklyInflationChange = 0; weeklyPopulationChangeFactor = 1; weeklyForeignRelationsChange = 0;
            weeklyCrimeRateChange = 0; weeklySecurityPerceptionChange = 0; weeklyMilitaryStrengthChange = 0;
            weeklyPoliticalStabilityChange = 0; weeklyArmyLoyaltyChange = 0; weeklyMediaFreedomChange = 0;
        }

        function advanceOneDay() {
            if (isAtWar || gamePausedForWar || isGameOver()) {
                addLog("Oyun duraklatƒ±lmƒ±≈üken veya bitmi≈üken g√ºn√º ilerletemezsiniz!", "warning", true);
                return;
            }
            
            addLog("Yeni bir g√ºn ba≈üladƒ±...", "info", true);
            
            const dailyFactor = 1/7;
            let currentDailyBudgetChange = 0;
            let dailyRevenue = (population * gdp * (taxes / (52*7)) * (1 - cabinet.economy.corruption*0.5)); // G√ºnl√ºk vergi geliri
            currentDailyBudgetChange += dailyRevenue;
            
            let dailyTotalSpending = 0;
            dailyTotalSpending += (educationSpending / 7 * (1 + cabinet.education.corruption*0.8)) ;
            dailyTotalSpending += (healthSpending / 7 * (1 + cabinet.health.corruption*0.8)) ;
            dailyTotalSpending += (cultureSpending / 7 * (1 + (cabinet.economy.corruption || 0.1)*0.8)) ;
            dailyTotalSpending += (socialPolicyLevel * 500000 / 7 * (1 + socialPolicyLevel/20)) ;
            const dailyArmyMaintenance = armySize * armyUpkeepCostPerSoldier / 7 * (1 + (militaryStrengthIndex - 50) / 150) * (1 - cabinet.defense.efficiency*0.1 + cabinet.defense.corruption*0.3) ;
            dailyTotalSpending += dailyArmyMaintenance;
            currentDailyBudgetChange -= dailyTotalSpending;
            weeklyBudgetChange += currentDailyBudgetChange;

            let dailyGdpGrowth = ( (Math.random() - 0.45) * 0.004 * cabinet.economy.efficiency + (economicPolicyLevel - 5) * 0.0015 - inflation/500 ) * dailyFactor;
            weeklyGdpChangeFactor *= (1 + dailyGdpGrowth);

            let dailyInfChange = ( (currentDailyBudgetChange / (gdp +1) * 100) * 0.0003 + (Math.random() - 0.5) * 0.08 ) * dailyFactor;
            if (economicPolicyLevel > 6) dailyInfChange += (economicPolicyLevel - 6) * 0.15 * dailyFactor;
            else if (economicPolicyLevel < 4) dailyInfChange -= (4 - economicPolicyLevel) * 0.08 * dailyFactor;
            weeklyInflationChange += dailyInfChange;

            let dailyPopGrowth = ( (satisfaction / 150000) - (inflation / 70000) + (healthSpending / (gdp+1) * 0.0002) ) * dailyFactor;
            weeklyPopulationChangeFactor *= (1 + dailyPopGrowth);
            
            let dailySatDelta = 0;
            dailySatDelta -= (taxes / 60) * dailyFactor;
            dailySatDelta += ((educationSpending / (600000*7) * cabinet.education.efficiency) + (healthSpending / (600000*7) * cabinet.health.efficiency) + (cultureSpending / (400000*7))) ; // Harcamalar artƒ±k haftalƒ±k etki, g√ºnl√ºk i√ßin b√∂l√ºnd√º
            dailySatDelta += (socialPolicyLevel - 5) * 0.6 * dailyFactor;
            if (inflation > 6) dailySatDelta -= (inflation - 6) * 0.25 * dailyFactor;
            if (crimeRate > 6) dailySatDelta -= crimeRate * 0.6 * dailyFactor;
            if (securityLevel > 7 && governmentType === 'Demokrasi') dailySatDelta -= (securityLevel - 7) * 0.4 * dailyFactor;
            if (governmentType === 'Diktat√∂rl√ºk') dailySatDelta -= 0.8 * dailyFactor;
            if (propagandaEffectWeeks > 0) dailySatDelta += (2 + mediaInfluence/30) * dailyFactor; 
            if (mediaFreedom < 3 && governmentType === 'Demokrasi') dailySatDelta -= (3 - mediaFreedom) * 0.2 * dailyFactor; 
            weeklySatisfactionChange += dailySatDelta;

            let dailyStabDelta = 0;
            dailyStabDelta += (satisfaction - 60) / 20 * dailyFactor;
            if (governmentType === 'Demokrasi') dailyStabDelta -= Math.abs(parliamentSupport - 50) / 25 * dailyFactor;
            if (governmentType === 'Demokrasi' && parliamentSupport < 30) dailyStabDelta -= 2 * dailyFactor;
            if (governmentType === 'Diktat√∂rl√ºk') dailyStabDelta += (armyLoyalty - 60) / 15 * dailyFactor;
            else if (governmentType === 'Demokrasi') dailyStabDelta += (armyLoyalty - 70) / 25 * dailyFactor;
            if (crimeRate > 10) dailyStabDelta -= (crimeRate - 10) * 0.3 * dailyFactor;
            if (mediaFreedom < 4) dailyStabDelta -= (4 - mediaFreedom) * 0.15 * dailyFactor; 
            weeklyPoliticalStabilityChange += dailyStabDelta;
            
            weeklyCrimeRateChange += ( (-(securityLevel - 4) * 0.12 - (militaryStrengthIndex / 1200) + (100 - politicalStability) / 300) * dailyFactor );
            weeklySecurityPerceptionChange += ( ((securityLevel - 5) * 0.6 + (militaryStrengthIndex / 600) - crimeRate / 3) * dailyFactor);
            
            // Medya √∂zg√ºrl√ºƒü√º hedefi varsa ona doƒüru ilerlet (g√ºnl√ºk k√º√ß√ºk adƒ±mlarla)
            let targetMediaFreedom = parseFloat(mediaFreedomSlider.value);
            if (mediaFreedom !== targetMediaFreedom) {
                 weeklyMediaFreedomChange += (targetMediaFreedom - mediaFreedom) * 0.2 * dailyFactor; // √áok yava≈ü deƒüi≈üim
            }


            applyDailyChanges(); 

            addLog("G√ºn sona erdi, geli≈ümeler ya≈üandƒ±.", "info", true);
            dayOfWeek++;

            if (dayOfWeek > 7) {
                // Haftayƒ± bitirme i≈ülemi endWeek() fonksiyonuna devredildi.
                // advanceDayBtn pasifle≈üecek, completeWeekReportsBtn aktifle≈üecek (eƒüer rapor ekranƒ±ndaysa)
                endWeek(); // 7 g√ºn dolunca otomatik olarak haftayƒ± bitir.
            }
            updateGameStats(); 
            enableAllActionButtons();
        }


        function endWeek() {
            if (isAtWar || gamePausedForWar || isGameOver()) {
                addLog("Oyun duraklatƒ±lmƒ±≈üken veya bitmi≈üken hafta bitirilemez.", "danger");
                if(endWeekBtn) endWeekBtn.disabled = true; 
                return;
            }
            
            // Haftalƒ±k biriktirilen t√ºm deƒüi≈üimler zaten applyDailyChanges ile her g√ºn sonunda ana deƒüi≈ükenlere uygulandƒ±.
            // Bu y√ºzden burada tekrar uygulamaya gerek yok. Sadece haftalƒ±k √∂zel olaylarƒ± ve kontrolleri yap.
            
            // Haftalƒ±k Medya √ñzg√ºrl√ºƒü√º Deƒüi≈üimi (Eƒüer bir hedef varsa ona doƒüru yava≈ü√ßa ilerler)
            // Bu artƒ±k advanceOneDay i√ßinde g√ºnl√ºk olarak yapƒ±lƒ±yor.
            // weeklyMediaFreedomChange haftalƒ±k toplamƒ± tutuyor ve applyDailyChanges'te uygulanƒ±yor.

            // Propaganda etkisi
            if (propagandaEffectWeeks > 0) {
                propagandaEffectWeeks--;
                if (propagandaEffectWeeks === 0) {
                    addLog("Devlet propaganda kampanyasƒ±nƒ±n yoƒüun etkisi sona erdi.", "info");
                }
            }

            historicalData.weeks.push(week);
            historicalData.gdp.push(gdp);
            historicalData.satisfaction.push(satisfaction);
            historicalData.inflation.push(inflation);
            historicalData.politicalStability.push(politicalStability);
            gdpGrowthFactorGlobalForReport = weeklyGdpChangeFactor; 
            inflationChangeGlobalForReport = weeklyInflationChange;

            // HAFTALIK OLAYLAR
            if (week > 1 && Math.random() < 0.30) { 
                triggerRandomEvent(); 
            }
            if ((governmentType === 'Demokrasi' || governmentType === 'Otoriter Demokrasi') && week > 10 && week % (48 + Math.floor(Math.random()*9)) === 0 ) { 
                addLog('SE√áƒ∞M ZAMANI!', 'event');
                conductElections();
            }
             if (summitPlanned && summitInvitationsSent && !isAtWar) { /* ... √ñnceki zirve sonu√ß mantƒ±ƒüƒ± ... */
                let participatingCount = 0; let totalRelationBoostFromSummit = 0;
                getSelectedSummitInvitees().forEach(cN => {
                     if (countries[cN].summitAccepted) { participatingCount++; countries[cN].relation = Math.min(100, countries[cN].relation + 5 + Math.floor(diplomaticApproachLevel/2)); totalRelationBoostFromSummit += (2 + Math.floor(diplomaticApproachLevel/3)); }
                     else { countries[cN].relation = Math.max(0, countries[cN].relation - 2); }
                });
                if (participatingCount >= Math.max(1, getSelectedSummitInvitees().length / 2)) { addLog(`D√ºzenlediƒüiniz zirve ${participatingCount} √ºlkenin katƒ±lƒ±mƒ±yla ba≈üarƒ±lƒ± oldu!`, "success"); foreignRelationsScore = Math.min(100, foreignRelationsScore + 5 + totalRelationBoostFromSummit); satisfaction += 3; politicalStability += 2; }
                else if (participatingCount > 0) { addLog(`Zirveye sadece ${participatingCount} √ºlke katƒ±ldƒ±. Sƒ±nƒ±rlƒ± etki.`, "info"); foreignRelationsScore = Math.min(100, foreignRelationsScore + 2 + totalRelationBoostFromSummit/2); satisfaction += 1;}
                else { addLog("Zirveye katƒ±lƒ±m olmadƒ±! Diplomatik fiyasko.", "danger"); foreignRelationsScore = Math.max(0, foreignRelationsScore - 5 - getSelectedSummitInvitees().length); satisfaction -= 2; politicalStability -=3; }
                summitPlanned = false; summitInvitationsSent = false; for (const cN in countries) { countries[cN].summitInvited = false; countries[cN].summitAccepted = false; }
                updateSummitInvitationList(); if(createSummitBtn) createSummitBtn.disabled = false; if(sendSummitInvitationsBtn) sendSummitInvitationsBtn.disabled = true;
             }

            // OYUN SONU KONTROLLERƒ∞ (Haftalƒ±k)
            if (satisfaction < 5 && politicalStability < 10 && week > 15) { gameOver('Halk isyan etti ve h√ºk√ºmet devrildi! √úlkede kaos hakim.', 'normal'); return; }
            if (budget < -2000000000 && week > 25) { gameOver('√úlke iflas etti! Uluslararasƒ± kurulu≈ülar y√∂netime el koydu.', 'normal'); return; } 
            if (population < 100000 && week > 20) { gameOver('N√ºfus kritik seviyenin altƒ±na d√º≈üt√º. √úlke hayalet bir diyara d√∂nd√º!', 'normal'); return; }
            if (governmentType === 'Diktat√∂rl√ºk' && armyLoyalty < 15 && politicalStability < 25 && week > 20) {
                 if (Math.random() < 0.7) { gameOver('Ordu y√∂netime el koydu! Diktat√∂rl√ºƒü√ºn√ºz sona erdi.', 'coup'); return; }
                 else { addLog("Ordu i√ßinde b√ºy√ºk bir huzursuzluk var, darbe a√ßƒ±k√ßa konu≈üuluyor!", "danger"); armyLoyalty = Math.max(0, armyLoyalty -15); }
            }
            if (politicalStability < 5 && satisfaction < 10 && week > 20) { 
                if (Math.random() < 0.5) { gameOver('√úlke i√ß sava≈üa s√ºr√ºklendi! Farklƒ± gruplar kontrol√º ele ge√ßirmeye √ßalƒ±≈üƒ±yor.', 'civil_war'); return; }
                else { addLog("√úlkede b√ºy√ºk √ßaplƒ± protestolar ve √ßatƒ±≈ümalar ya≈üanƒ±yor. ƒ∞√ß sava≈ü an meselesi!", "danger"); population -= Math.floor(population * 0.015); gdp *= 0.93; }
            }


            addLog(`----- HAFTA ${week} Bƒ∞TTƒ∞ / HAFTA ${week+1} BA≈ûLIYOR -----`, 'event');
            week++; 
            dayOfWeek = 1; 
            
            updateGameStats();
            updateMinisterAdvice();
            updateReports(); 
            enableAllActionButtons(); 
        }
        
        function triggerRandomEvent() { /* ... √ñncekiyle aynƒ± ... */ 
             const currentEvents = [
                { id:1, desc: 'B√ºy√ºk bir deprem √ºlkeyi sarstƒ±. Altyapƒ± hasar g√∂rd√º, can kayƒ±plarƒ± var.', type: 'danger', effect: () => { budget -= population * 3 * (1-cabinet.interior.efficiency*0.3); weeklySatisfactionChange -= 10; weeklyGdpChangeFactor *= 0.97; population -= Math.floor(population*0.001); weeklyPoliticalStabilityChange -= 5;} },
                { id:2, desc: 'Bilim insanlarƒ±mƒ±z √ßƒ±ƒüƒ±r a√ßan bir bulu≈ü yaptƒ±! Uluslararasƒ± patent gelirleri bekleniyor.', type: 'success', effect: () => { weeklyGdpChangeFactor *= 1.01; weeklySatisfactionChange += 5; budget += 25000000; foreignRelationsScore +=2; } },
                { id:3, desc: `Kritik bir bakanlƒ±kta (${Object.keys(cabinet)[Math.floor(Math.random()*Object.keys(cabinet).length)]}) b√ºy√ºk bir yolsuzluk skandalƒ± patlak verdi! Halk √∂fkeli.`, type: 'danger', effect: () => { weeklySatisfactionChange -= 15; weeklyPoliticalStabilityChange -= 10; budget -= 15000000; foreignRelationsScore -=5; parliamentSupport = Math.max(10, parliamentSupport-10); } },
                { id:4, desc: 'Kom≈üu bir √ºlkeyle yapƒ±lan ortak tatbikat ili≈ükileri g√º√ßlendirdi.', type: 'success', effect: () => { let friendlyNeighbor = Object.keys(countries).find(c => countries[c].relation > 60); if(friendlyNeighbor) {countries[friendlyNeighbor].relation = Math.min(100, countries[friendlyNeighbor].relation + 10); addLog(`${friendlyNeighbor} ile ortak tatbikat ba≈üarƒ±lƒ± ge√ßti.`);} weeklyForeignRelationsChange += 5; weeklyMilitaryStrengthChange +=1; } },
                { id:5, desc: 'Turizm sezonu beklenenden iyi ge√ßti, d√∂viz girdisi arttƒ±.', type: 'success', effect: () => { budget += gdp * 0.005; weeklyGdpChangeFactor *= 1.003; weeklySatisfactionChange += 2;} },
                { id:6, desc: 'K√ºresel bir resesyon kapƒ±da. ƒ∞hracat gelirleri d√º≈üebilir.', type: 'warning', effect: () => { weeklyGdpChangeFactor *= 0.985; weeklyInflationChange -= 0.2; weeklySatisfactionChange -=3;} },
                { id:7, desc: '√ñnemli bir ticaret yolu √ºzerinde tansiyon y√ºkseldi, ithalat maliyetleri arttƒ±.', type: 'warning', effect: () => { weeklyInflationChange += 0.8; budget -= population * 0.5; } },
                { id:8, desc: '√únl√º bir sanat√ßƒ±nƒ±z uluslararasƒ± √∂d√ºl kazandƒ±, √ºlke tanƒ±tƒ±mƒ±na katkƒ± saƒüladƒ±.', type: 'success', effect: () => { weeklySatisfactionChange += 4; /* cultureSpending += 500000; // Bu doƒürudan harcama olmamalƒ±, etki yaratmalƒ± */ foreignRelationsScore +=3;} },
                { id:9, desc: 'Hackerlar devlet sƒ±rlarƒ±nƒ± sƒ±zdƒ±rdƒ±! G√ºvenlik a√ßƒ±ƒüƒ± ve uluslararasƒ± kriz.', type: 'danger', effect: () => { weeklySecurityPerceptionChange -= 15; weeklyForeignRelationsChange -= 10; weeklyPoliticalStabilityChange -= 8; if(cabinet.interior.efficiency < 0.5) budget -= 10000000;} },
                { id:10, desc: 'Gen√ßler arasƒ±nda pop√ºler olan yeni bir sosyal medya akƒ±mƒ±, toplumsal bilinci artƒ±rdƒ±.', type: 'info', effect: () => { weeklySatisfactionChange += 2; /* educationSpending += 300000; */} },
                { id:11, desc: 'Nadir bir maden yataƒüƒ± ke≈üfedildi! ƒ∞≈ülenmesi zaman alacak ama potansiyel b√ºy√ºk.', type: 'event', effect: () => { addLog("Yeni maden yataƒüƒ± i√ßin yatƒ±rƒ±m se√ßenekleri deƒüerlendiriliyor.", "info"); weeklyGdpChangeFactor *=1.001; } },
                { id:12, desc: 'Bir grup ayrƒ±lƒ±k√ßƒ± ter√∂r saldƒ±rƒ±sƒ± d√ºzenledi. Halk paniƒüe kapƒ±ldƒ±.', type: 'danger', effect: () => { weeklySatisfactionChange -=12; weeklySecurityPerceptionChange -=10; weeklyCrimeRateChange +=3; weeklyPoliticalStabilityChange -=7; weeklyArmyLoyaltyChange -=2; } },

            ];
            const randomEvent = currentEvents[Math.floor(Math.random() * currentEvents.length)];
            randomEvent.effect(); // Bu etkiler `weekly...` deƒüi≈ükenlerine yazmalƒ±
            addLog(`[OLAY] ${randomEvent.desc}`, randomEvent.type);
        }
        function conductElections() { /* ... √ñncekiyle aynƒ± ... */ 
             if (governmentType !== 'Demokrasi' && governmentType !== 'Otoriter Demokrasi') return;
            addLog('Se√ßimler yapƒ±lƒ±yor... Oy verme i≈ülemi tamamlandƒ±, sonu√ßlar bekleniyor.', 'info');
            let electionOutcomeModifier = (politicalStability - 50) / 5; 
            if (cabinet.justice.efficiency < 0.4) electionOutcomeModifier -= 10; // Adaletsiz se√ßim algƒ±sƒ±
            
            const effectiveSatisfaction = satisfaction + electionOutcomeModifier;

            if (effectiveSatisfaction >= 50 + Math.random()*10) { 
                addLog('Halkƒ±n b√ºy√ºk √ßoƒüunluƒüunun desteƒüiyle se√ßimleri kazandƒ±nƒ±z! G√ºven tazelediniz.', 'success');
                parliamentSupport = Math.min(100, Math.max(50, parliamentSupport + 10 + Math.floor(Math.random()*15))); 
                satisfaction = Math.min(100, satisfaction + Math.floor(Math.random()*5)+2); 
                politicalStability = Math.min(100, politicalStability + 10 + Math.floor(Math.random()*10));
            } else if (effectiveSatisfaction >= 30 + Math.random()*10) {
                addLog('Se√ßim sonu√ßlarƒ± belirsiz. Koalisyon g√∂r√º≈ümeleri ba≈üladƒ± veya az farkla kazandƒ±nƒ±z. Meclis aritmetiƒüi zorlu olacak.', 'warning');
                parliamentSupport = Math.max(25, Math.min(75, parliamentSupport - 5 - Math.floor(Math.random()*10))); 
                 politicalStability = Math.max(0, politicalStability - 5 - Math.floor(Math.random()*5));
            } else {
                addLog('Aƒüƒ±r bir se√ßim yenilgisi aldƒ±nƒ±z. Halk deƒüi≈üim istedi ve iktidardan d√º≈üt√ºn√ºz!', 'danger');
                gameOver('Se√ßimleri kaybettiniz!');
                return;
            }
            updateGameStats();
        }
        function updateCabinetDisplay() { /* ... √ñncekiyle aynƒ± ... */ 
            if(!cabinetListEl) return; cabinetListEl.innerHTML = '';
            for (const type in cabinet) {
                const minister = cabinet[type];
                const listItem = document.createElement('li');
                listItem.innerHTML = `<strong>${capitalizeFirstLetter(type)} Bakanƒ±:</strong> ${minister.name} (V: ${minister.efficiency.toFixed(1)}, Y: ${minister.corruption.toFixed(1)})`;
                cabinetListEl.appendChild(listItem);
            }
        }
        function capitalizeFirstLetter(string) { /* ... √ñncekiyle aynƒ± ... */ return string.charAt(0).toUpperCase() + string.slice(1); }
        function updateParliamentDisplay() { /* ... governmentType kontrol√º eklendi ... */
            if(!parliamentSupportEl || !oppositionStrengthDisplayEl || !parliamentAgendaList) return;
            parliamentSupportEl.textContent = `${governmentType === 'Demokrasi' || governmentType === 'Otoriter Demokrasi' ? parliamentSupport.toFixed(0)+'%' : 'N/A'}`;
            oppositionStrengthDisplayEl.textContent = `${(governmentType === 'Demokrasi' ? (100 - parliamentSupport) : 'N/A').toFixed(0)}%`;
            parliamentAgendaList.innerHTML = '';

            if (parliamentAgenda.length === 0 && (governmentType === 'Demokrasi' || governmentType === 'Otoriter Demokrasi')) {
                parliamentAgendaList.innerHTML = '<li>G√ºndemde yeni bir yasa teklifi yok.</li>';
            } else if (governmentType === 'Diktat√∂rl√ºk') {
                parliamentAgendaList.innerHTML = '<li>Meclis etkisizle≈ütirildi. Yasalar kararname ile √ßƒ±karƒ±lƒ±r.</li>';
            }
            else {
                parliamentAgenda.forEach((item, index) => {
                    const listItem = document.createElement('li');
                    listItem.innerHTML = `<p>${item.description} (Red: <span class="math-inline">\{item\.rejectionCount \|\| 0\}/2\)</p\>
<div\>
<button class\="parliament\-action\-btn" data\-action\="approve" data\-index\="</span>{index}">Onayla</button>
                                          <button class="parliament-action-btn" data-action="reject" data-index="${index}">Reddet</button>
                                        </div>`;
                    parliamentAgendaList.appendChild(listItem);
                });
            }

            document.querySelectorAll('.parliament-action-btn').forEach(btn => {
                btn.onclick = handleParliamentAction;
            });
         }
        function handleParliamentAction(event) { /* ... √ñncekiyle aynƒ± ... */ 
            const index = parseInt(event.target.dataset.index);
            const action = event.target.dataset.action;
            const proposal = parliamentAgenda[index];

            if (!proposal || governmentType === 'Diktat√∂rl√ºk') return;

            let logMsg = "";
            if (action === 'approve') {
                const siyasiIrade = parliamentSupport + (politicalStability - 50)/5 - (proposal.rejectionCount * 15); 
                const roll = Math.random() * 100;
                if (roll < siyasiIrade) {
                    proposal.onApprove();
                    logMsg = `Meclis, "${proposal.description}" yasasƒ±nƒ± onayladƒ±.`; addLog(logMsg, 'success');
                    parliamentSupport = Math.min(100, parliamentSupport + 5); 
                    politicalStability = Math.min(100, politicalStability + 3);
                    parliamentAgenda.splice(index, 1); 
                } else {
                    logMsg = `Meclis, "${proposal.description}" yasasƒ±nƒ± onaylamadƒ±.`; addLog(logMsg, 'warning');
                    parliamentSupport = Math.max(0, parliamentSupport - 7); 
                    politicalStability = Math.max(0, politicalStability - 5);
                    proposal.rejectionCount = (proposal.rejectionCount || 0) + 1;
                    if (proposal.rejectionCount >= 2) {
                        addLog(`"${proposal.description}" yasasƒ± ikinci kez reddedildiƒüi i√ßin kesin olarak g√ºndemden d√º≈üt√º!`, 'danger');
                        parliamentAgenda.splice(index, 1);
                        weeklySatisfactionChange -=3; weeklyPoliticalStabilityChange -=5; 
                    }
                }
            } else { // Reject
                proposal.rejectionCount = (proposal.rejectionCount || 0) + 1;
                proposal.onReject();
                logMsg = `"${proposal.description}" yasasƒ± meclis tarafƒ±ndan reddedildi. Red Sayƒ±sƒ±: ${proposal.rejectionCount}.`; addLog(logMsg, 'info');
                parliamentSupport = Math.max(0, parliamentSupport - 4); 
                 politicalStability = Math.max(0, politicalStability - 2);
                if (proposal.rejectionCount >= 2) {
                     addLog(`"${proposal.description}" yasasƒ± ikinci kez reddedildiƒüi i√ßin kesin olarak g√ºndemden d√º≈üt√º!`, 'danger');
                     parliamentAgenda.splice(index, 1); 
                     weeklySatisfactionChange -=2; weeklyPoliticalStabilityChange -=4;
                }
            }
            updateParliamentDisplay();
            updateGameStats();
        }
        function handleOppositionMeeting(isPlayerInitiated, isClosed) { /* ... √ñncekiyle aynƒ± ... */ 
            if (governmentType === 'Diktat√∂rl√ºk') { addLog("Diktat√∂rl√ºkte muhalefetle g√∂r√º≈üme s√∂z konusu olamaz.", "danger"); return; }
            const cost = isClosed ? 500000 : 200000;
            if(budget < cost && isPlayerInitiated) { addLog("Muhalefetle g√∂r√º≈üme i√ßin yeterli b√ºt√ße yok.", "warning"); return;}
            if(isPlayerInitiated) { budget -= cost; } // Anlƒ±k maliyet

            let outcomeLog = `Muhalefet liderleriyle ${isClosed ? 'kapalƒ± kapƒ±lar ardƒ±nda' : 'kamuoyuna a√ßƒ±k bir ≈üekilde'} bir g√∂r√º≈üme ger√ßekle≈ütirdiniz. `;
            let satisfactionChange = 0; let supportChange = 0; let stabilityChange = 0;
            const rand = Math.random();
            if (politicalStability < 30 || satisfaction < 30) { 
                if (rand < 0.6) { outcomeLog += "Ancak kriz ortamƒ±nda g√∂r√º≈ümeden bir sonu√ß √ßƒ±kmadƒ±, tansiyon daha da y√ºkseldi."; satisfactionChange = isClosed ? -3 : -5; supportChange = isClosed ? -4 : -6; stabilityChange = -7;}
                else { outcomeLog += "Zorlu ko≈üullara raƒümen, bazƒ± konularda ge√ßici bir ate≈ükes saƒülandƒ±."; satisfactionChange = isClosed ? 1 : 0; supportChange = isClosed ? 2 : 1; stabilityChange = 2;}
            } else { 
                 if (rand < 0.2) { outcomeLog += "G√∂r√º≈üme beklenmedik bir ≈üekilde √ßok sert ge√ßti."; satisfactionChange = isClosed ? -2 : -3; supportChange = isClosed ? -3 : -5; stabilityChange = -4;}
                 else if (rand < 0.7) { outcomeLog += "Yapƒ±cƒ± bir diyalog kuruldu, ancak somut bir ilerleme kaydedilemedi."; satisfactionChange = isClosed ? 1 : 0; supportChange = isClosed ? 2 : 1; stabilityChange = isClosed ? 2 : 1;}
                 else { outcomeLog += "G√∂r√º≈üme son derece olumlu ge√ßti! Bazƒ± konularda uzla≈üƒ± saƒülandƒ±."; satisfactionChange = isClosed ? 3 : 5; supportChange = isClosed ? 6 : 8; stabilityChange = isClosed ? 4 : 6;}
            }
            if (isClosed) { outcomeLog += " Detaylar gizli tutuldu."; satisfactionChange -=1; } else { outcomeLog += " Ortak bir basƒ±n toplantƒ±sƒ± d√ºzenlendi.";}
            addLog(outcomeLog, satisfactionChange > 1 ? 'success' : (satisfactionChange < -1 ? 'danger' : 'info'));
            weeklySatisfactionChange += satisfactionChange; weeklyPoliticalStabilityChange += stabilityChange;
            parliamentSupport = Math.min(100, Math.max(0, parliamentSupport + supportChange));
            updateGameStats();
        }
        function updateForeignRelationsDisplay() { /* ... √ñncekiyle aynƒ± ... */ 
            if(!foreignRelationsDisplayEl || !countryRelationsList) return;
            foreignRelationsDisplayEl.textContent = foreignRelationsScore.toFixed(0);
            countryRelationsList.innerHTML = '';
            for (const countryName in countries) {
                const country = countries[countryName];
                const listItem = document.createElement('li');
                let status = ''; let color = '';
                if (country.relation >= 75) { status = 'M√ºttefik'; color = 'var(--success-color)'; }
                else if (country.relation >= 50) { status = 'Dostane'; color = 'var(--primary-color)'; }
                else if (country.relation >= 25) { status = 'N√∂tr'; color = 'var(--warning-color)'; }
                else { status = 'Gergin'; color = 'var(--danger-color)'; }

                listItem.innerHTML = `
                    <span title="Askeri G√º√ß: <span class="math-inline">\{country\.militaryPower\}"\></span>{countryName}: <span class="math-inline">\{status\} \(<span style\="color\:</span>{color};">${country.relation.toFixed(0)}</span>) <span class="math-inline">\{country\.tradeDeal ? '\[Tic\.Anl\.\]' \: ''\}</span\>
<div\>
<button class\="foreign\-action\-btn" data\-country\="</span>{countryName}" data-action="trade">Tic.Anl.</button>
                        <button class="foreign-action-btn" data-country="${countryName}" data-action="improve_specific" title="ƒ∞li≈üki Geli≈ütir (<span class="math-inline">1M\)"\>ƒ∞yi Niyet</button\>
<button class\="foreign\-action\-btn" data\-country\="</span>{countryName}" data-action="harm_specific" title="ƒ∞li≈üki Boz ($500K)">Nota Ver</button>
                        ${country.relation < 20 || (country.relation < 30 && militaryStrengthIndex > country.militaryPower + 20 && diplomaticApproachLevel < 4) ? `<button class="foreign-action-btn" style="background-color:var(--danger-color);" data-country="${countryName}" data-action="declare-war-specific">Sava≈ü ƒ∞lan Et</button>` : ''}
                    </div>`;
                countryRelationsList.appendChild(listItem);
            }
            document.querySelectorAll('.foreign-action-btn').forEach(btn => { btn.onclick = handleForeignAction; });
        }
        function handleForeignAction(event) { /* ... √ñncekiyle aynƒ±, anlƒ±k maliyet ve haftalƒ±k etki ... */
            const countryName = event.target.dataset.country;
            const action = event.target.dataset.action;
            const country = countries[countryName];
            if (!country) return;
            let cost = 0; let successChance = 0;

            if (action === 'trade') {
                if (country.tradeDeal) { addLog(`${countryName} ile zaten bir ticaret anla≈ümanƒ±z var.`, 'warning'); return; }
                cost = 3000000;
                if (country.relation < 25 && diplomaticApproachLevel < 5) { addLog(`${countryName} ile ili≈ükileriniz √ßok k√∂t√º. Ticaret anla≈ümasƒ± m√ºmk√ºn deƒüil.`, 'danger'); return; }
                successChance = country.relation + diplomaticApproachLevel * 5 + (cabinet.foreign.efficiency - 0.5)*20 - 20;
                if (budget >= cost) { budget -= cost; 
                    if (Math.random() * 100 < successChance) { country.relation = Math.min(100, country.relation + 10 + Math.floor(diplomaticApproachLevel/2)); country.tradeDeal = true; weeklyGdpChangeFactor *= 1.002; weeklyForeignRelationsChange += 3; addLog(`${countryName} ile yeni bir ticaret anla≈ümasƒ± imzalandƒ±!`, 'success');}
                    else { addLog(`${countryName} ile ticaret anla≈ümasƒ± m√ºzakereleri ba≈üarƒ±sƒ±z oldu.`, 'warning'); weeklyForeignRelationsChange -=1; country.relation = Math.max(0, country.relation -3); }
                } else { addLog(`Ticaret anla≈ümasƒ± i√ßin yeterli b√ºt√ße yok! ($${cost.toLocaleString()})`, 'warning'); }
            } else if (action === 'improve_specific') {
                cost = 1000000; if (budget >= cost) { budget -= cost; let improvement = Math.floor(Math.random()*3) + 3 + Math.floor(diplomaticApproachLevel/2) + Math.floor((cabinet.foreign.efficiency-0.5)*5); country.relation = Math.min(100, country.relation + improvement); weeklyForeignRelationsChange += Math.floor(improvement/3); addLog(`${countryName} ile ili≈ükileri geli≈ütirmek i√ßin diplomatik jest yapƒ±ldƒ±.`, 'info');}
                else { addLog('ƒ∞yi niyet jesti i√ßin yetersiz b√ºt√ße.', 'warning'); }
            } else if (action === 'harm_specific') { 
                 cost = 500000; if (budget >= cost) { budget -= cost; let harm = Math.floor(Math.random()*4) + 4 + Math.floor((10-diplomaticApproachLevel)/2) - Math.floor((cabinet.foreign.efficiency-0.5)*3); country.relation = Math.max(0, country.relation - harm); weeklyForeignRelationsChange -= Math.floor(harm/4); addLog(`${countryName}'ye sert bir diplomatik nota verdiniz.`, 'warning'); if(country.relation < 15 && country.tradeDeal){ country.tradeDeal = false; addLog(`${countryName} ile ticaret anla≈ümanƒ±z askƒ±ya alƒ±ndƒ±!`, 'danger'); weeklyGdpChangeFactor *= 0.998;}}
                 else { addLog('Diplomatik nota i√ßin yetersiz b√ºt√ße.', 'warning'); }
            } else if (action === 'declare-war-specific') { handleDeclareWar(countryName); }
            updateForeignRelationsDisplay(); updateGameStats();
         }
        function handleDeclareWar(targetCountryName) { /* ... √ñncekiyle aynƒ± ... */ 
            const target = countries[targetCountryName];
            addLog(`Sava≈ü Konseyi: ${targetCountryName}'e sava≈ü ilan etme kararƒ± deƒüerlendiriliyor...`, "event");
            let militaryAssessment = "Genelkurmay Ba≈ükanƒ±: ";
            const powerRatio = militaryStrengthIndex / target.militaryPower;
            if (powerRatio > 1.5 && armyLoyalty > 70) militaryAssessment += `"${targetCountryName} kar≈üƒ±sƒ±nda net √ºst√ºnl√ºƒü√ºm√ºz var. Hƒ±zlƒ± zafer muhtemel!"`;
            else if (powerRatio > 1.1 && armyLoyalty > 50) militaryAssessment += `"${targetCountryName} ile denk g√º√ßteyiz. ƒ∞yi stratejiyle kazanabiliriz."`;
            else if (armyLoyalty < 40) militaryAssessment += `"Ordu i√ßinde moral bozukluƒüu var. Sava≈üa girmek b√ºy√ºk risk!"`;
            else militaryAssessment += `"${targetCountryName} g√º√ßl√º bir rakip. Uzun ve yƒ±pratƒ±cƒ± olabilir."`;
            addLog(militaryAssessment, armyLoyalty < 40 || powerRatio < 1.1 ? 'warning' : 'info');
            addLog(`Savunma Bakanƒ±: "${cabinet.defense.efficiency > 0.6 ? 'Ordu emirlerinizi bekliyor!' : 'Sava≈ü i√ßin ek kaynak gerekebilir...'}"`, 'info');
            addLog(`Dƒ±≈üi≈üleri Bakanƒ±: "${cabinet.foreign.efficiency > 0.6 && diplomaticApproachLevel > 5 ? 'Diplomatik sonu√ßlarƒ± iyi hesaplamalƒ±yƒ±z.' : 'Bu sava≈üƒ±n uluslararasƒ± yankƒ±larƒ± aƒüƒ±r olabilir!'}"`, 'info');
            addLog(`Ekonomi Bakanƒ±: "Sava≈ü ekonomisi i√ßin ek b√ºt√ße planlanmalƒ±."`, 'warning');
            let initialPublicReaction = "Halk arasƒ±nda sava≈ü s√∂ylentileri endi≈üe yaratƒ±yor. ";
            if (target.relation < 10 && satisfaction > 60) initialPublicReaction += "Ancak bir kesim, bu √ºlkeye kar≈üƒ± sert duru≈üu destekliyor.";
            else if (satisfaction < 40) initialPublicReaction += "Halk, yeni bir maceraya kar≈üƒ±.";
            else initialPublicReaction += "Kamuoyu kararsƒ±z.";
            addLog(initialPublicReaction, 'info');
            if (!confirm(`${targetCountryName}'e sava≈ü ilan etmek istediƒüinize emin misiniz?`)) { addLog("Sava≈ü ilanƒ±ndan vazge√ßildi.", "info"); return; }
            const cost = 50000000 + (armySize * 120) + (target.militaryPower * 100000); 
            if (budget < cost) { addLog(`Sava≈ü ba≈ülatmak i√ßin b√ºt√ße yok! ($${cost.toLocaleString()})`, 'danger'); return; }
            budget -= cost; 
            addLog(`${targetCountryName} √ºlkesine resmen sava≈ü ilan edildi!`, 'danger');
            weeklySatisfactionChange -= (15 - Math.floor(satisfaction/10) + (diplomaticApproachLevel > 7 ? 5: 0)); 
            weeklyPoliticalStabilityChange -= (10 + Math.floor(Math.random()*10));
            weeklyForeignRelationsChange -= 25;
            weeklyArmyLoyaltyChange += 5; 
            Object.keys(countries).forEach(oCN => { if(oCN !== targetCountryName){ if(countries[oCN].relation > 60 && countries[targetCountryName].relation < 30){ countries[oCN].relation = Math.min(100, countries[oCN].relation + 5); addLog(`${oCN} kararƒ±nƒ±zƒ± destekledi.`, 'success'); } else if (countries[oCN].relation < 30 || countries[oCN].relation < countries[targetCountryName].relation + 20) { countries[oCN].relation = Math.max(0, countries[oCN].relation - 10); addLog(`${oCN} kararƒ±nƒ±zƒ± kƒ±nadƒ±.`, 'danger'); if(Math.random() < 0.2 && countries[oCN].militaryPower > 30) { countries[targetCountryName].militaryPower += Math.floor(countries[oCN].militaryPower * 0.1); addLog(`${oCN}, ${targetCountryName}'e askeri malzeme g√∂nderdi!`, 'danger');}} else { countries[oCN].relation = Math.max(0, countries[oCN].relation - 3); addLog(`${oCN} kararƒ±nƒ±zdan endi≈üe duydu.`, 'warning');}}});
            updateForeignRelationsDisplay();
            isAtWar = true; // Sava≈ü ba≈üladƒ±
            gamePausedForWar = true; // Diƒüer zaman ilerlemesini durdur
            enableAllActionButtons(); // Butonlarƒ± sava≈ü durumuna g√∂re ayarla
            simulateWar(targetCountryName, true, false); 
        }
        function simulateWar(targetCountry, isPlayerInitiated, isSurpriseAttack = false) { /* ... gamePausedForWar ve enableAllActionButtons eklendi ... */
            addLog(`${targetCountry} ile ${isSurpriseAttack ? 'ani bir saldƒ±rƒ± sonucu ' : ''}sava≈ü t√ºm ≈üiddetiyle devam ediyor...`, 'danger');
            gamePausedForWar = true; // Diƒüer i≈ülemler duraklatƒ±ldƒ±
            enableAllActionButtons(); // Sava≈ü sƒ±rasƒ±nda √ßoƒüu butonu devre dƒ±≈üƒ± bƒ±rak

            let playerEffectivePower = militaryStrengthIndex * (armySize / 10000) * (cabinet.defense.efficiency || 0.6) * (armyLoyalty/100);
            if(isSurpriseAttack && !isPlayerInitiated) playerEffectivePower *= 0.8; 
            if(isSurpriseAttack && isPlayerInitiated) playerEffectivePower *= 1.1; 

            let enemyMilitaryPower = countries[targetCountry].militaryPower * (Math.random() * 0.4 + 0.8); 
            Object.keys(countries).forEach(allyCand => { if (allyCand !== targetCountry && countries[allyCand].relation > 70 && countries[targetCountry].relation < 30 && countries[allyCand].relation > countries[targetCountry].relation + 30) { if(Math.random() < 0.3) { addLog(`${allyCand}, ${targetCountry} safƒ±nda sava≈üa katƒ±ldƒ±!`, "danger"); enemyMilitaryPower += countries[allyCand].militaryPower * 0.5; countries[allyCand].relation = Math.max(0, countries[allyCand].relation - 50); }}});

            const outcomeRoll = Math.random() * (isPlayerInitiated ? 1.05 : 0.95); 
            let resultDescription = "";
            let warDuration = Math.floor(Math.random() * 5) + 3; 
            addLog(`Sava≈üƒ±n ${warDuration} hafta s√ºrmesi bekleniyor.`, "event");

            let currentWarWeek = 0;
            const warInterval = setInterval(() => {
                if (isGameOver()) { clearInterval(warInterval); gamePausedForWar = false; enableAllActionButtons(); return; } // Oyun bittiyse intervali durdur

                currentWarWeek++;
                let weeklyPlayerCasualties = Math.floor(armySize * (0.005 + Math.random()*0.015) * (enemyMilitaryPower / (playerEffectivePower*2+1)));
                let weeklyEnemyCasualtiesReported = Math.floor(countries[targetCountry].militaryPower * (0.005 + Math.random()*0.015) * (playerEffectivePower / (enemyMilitaryPower*2+1))); 
                
                armySize = Math.max(5000, armySize - weeklyPlayerCasualties);
                playerEffectivePower *= (0.98 - weeklyPlayerCasualties / (armySize + weeklyPlayerCasualties + 1)); 
                enemyMilitaryPower *= (0.985 - weeklyEnemyCasualtiesReported / (countries[targetCountry].militaryPower + 1));
                budget -= armySize * 20; // Haftalƒ±k sava≈ü maliyeti (g√ºnl√ºk b√ºt√ßeden d√º≈üer gibi)
                satisfaction = Math.max(0, satisfaction - 0.5); 
                militaryStrengthIndex = Math.max(10, militaryStrengthIndex * 0.99); 
                addLog(`Sava≈üƒ±n ${currentWarWeek}. haftasƒ±: ${weeklyPlayerCasualties.toLocaleString()} kayƒ±p. D√º≈üman ${weeklyEnemyCasualtiesReported.toLocaleString()} kayƒ±p verdi.`, "warning");
                updateGameStats(); 

                if(currentWarWeek >= warDuration || budget < -50000000 || armySize < 5000 ) { 
                    clearInterval(warInterval);
                    isAtWar = false; 
                    gamePausedForWar = false;
                    if (playerEffectivePower * (outcomeRoll + 0.1) > enemyMilitaryPower * (1 - outcomeRoll + 0.1) ) { 
                        resultDescription = `ZAFER! ${targetCountry} dize getirildi.`;
                        gdp *= 1.01; satisfaction += (isPlayerInitiated ? 5 : 10) + Math.floor(armyLoyalty/20); budget += 50000000 + Math.floor(Math.random() * 80000000); 
                        countries[targetCountry].relation = Math.max(0, countries[targetCountry].relation - 40); countries[targetCountry].militaryPower = Math.max(10, countries[targetCountry].militaryPower * 0.6); 
                        if(isPlayerInitiated) foreignRelationsScore = Math.max(0, foreignRelationsScore -5); else foreignRelationsScore = Math.min(100, foreignRelationsScore + 8); 
                        militaryStrengthIndex = Math.max(10, militaryStrengthIndex - (5 + Math.floor(Math.random()*5))); armySize = Math.max(10000, armySize - Math.floor(armySize * (0.03 + Math.random()*0.08))); 
                        politicalStability = Math.min(100, politicalStability + 5); addLog(resultDescription, 'success');
                    } else if (playerEffectivePower * (outcomeRoll + 0.3) < enemyMilitaryPower * (1-outcomeRoll + 0.3) && (outcomeRoll < 0.4 || armyLoyalty < 30) ) { 
                        resultDescription = `YENƒ∞LGƒ∞! ${targetCountry} ordularƒ± ba≈ükente dayandƒ±. Aƒüƒ±r ≈üartlarda ate≈ükes.`;
                        gdp *= 0.92; satisfaction -= (isPlayerInitiated ? 30 : 20) - Math.floor(armyLoyalty/10); budget -= (30000000 + Math.floor(Math.random() * 40000000));
                        countries[targetCountry].relation = Math.min(100, countries[targetCountry].relation + 30); foreignRelationsScore = Math.max(0, foreignRelationsScore - (isPlayerInitiated ? 20 : 10));
                        militaryStrengthIndex = Math.max(5, militaryStrengthIndex - (15 + Math.floor(Math.random()*10))); armySize = Math.max(5000, armySize - Math.floor(armySize * (0.1 + Math.random()*0.15)));
                        politicalStability = Math.max(0, politicalStability - 20 - Math.floor(Math.random()*10));
                        if(politicalStability < 10 && !isGameOver()) { gameOver("Sava≈ü yenilgisi sonrasƒ± i√ß karƒ±≈üƒ±klƒ±klar nedeniyle h√ºk√ºmet devrildi!", "civil_war");}
                        else {addLog(resultDescription, 'danger');}
                    } else { 
                        resultDescription = `Sava≈ü ${targetCountry} ile kanlƒ± bir √ßƒ±kmaza girdi. ƒ∞ki taraf da aƒüƒ±r kayƒ±plar verdi. Ate≈ükes.`;
                        gdp *= 0.96; satisfaction -= (10 + Math.floor(Math.random()*5)); militaryStrengthIndex = Math.max(10, militaryStrengthIndex - (10 + Math.floor(Math.random()*8)));
                        armySize = Math.max(8000, armySize - Math.floor(armySize * (0.05 + Math.random()*0.1))); politicalStability = Math.max(0, politicalStability - 10);
                        addLog(resultDescription, 'warning');
                    }
                    updateGameStats(); updateForeignRelationsDisplay(); 
                    if (!isGameOver()) enableAllActionButtons(); // Oyun bitmediyse butonlarƒ± a√ß
                    return;
                }
            }, 3000); 
        }

        function updateSummitInvitationList() { /* ... √ñncekiyle aynƒ± ... */
            if(!summitInvitationListEl || !sendSummitInvitationsBtn) return;
            summitInvitationListEl.innerHTML = ''; let selectedCount = 0;
            for (const cN in countries) { if(countries[cN].summitInvited) selectedCount++;}
            for (const cN in countries) {
                const country = countries[cN]; const listItem = document.createElement('li');
                listItem.innerHTML = `<span>${cN} (ƒ∞li≈üki: <span class="math-inline">\{country\.relation\.toFixed\(0\)\}\)</span\> <input type\="checkbox" data\-country\="</span>{cN}" class="summit-invite-checkbox" ${country.summitInvited ? 'checked' : ''} ${summitInvitationsSent ? 'disabled' : ''} ${selectedCount >=5 && !country.summitInvited && summitPlanned ? 'disabled' : ''}> ${country.summitInvited && summitInvitationsSent ? (country.summitAccepted ? ' (Katƒ±lacak)' : ' (Reddetti)') : ''}`;
                summitInvitationListEl.appendChild(listItem);
            }
            document.querySelectorAll('.summit-invite-checkbox').forEach(cb => { cb.onchange = handleSummitInviteCheckbox; });
            sendSummitInvitationsBtn.disabled = !summitPlanned || summitInvitationsSent || getSelectedSummitInvitees().length === 0;
         }
        function handleSummitInviteCheckbox(event) { /* ... √ñncekiyle aynƒ± ... */
            if (summitInvitationsSent) return; 
            const countryName = event.target.dataset.country;
            countries[countryName].summitInvited = event.target.checked;
            updateSummitInvitationList(); 
         }
        function getSelectedSummitInvitees() { /* ... √ñncekiyle aynƒ± ... */
            const invitees = [];
            for (const cN in countries) { if (countries[cN].summitInvited) invitees.push(cN); }
            return invitees;
         }
        function updateReports() { /* ... √ñncekiyle aynƒ± ... */ 
            if(!educationQualityReportEl) return; // Rapor ekranƒ± DOM elementleri hazƒ±r mƒ± kontrol√º
            updateMinisterReports(); 
            drawReportChart();
        }


        // --- EVENT LISTENERS (setupAllEventListeners i√ßinde toplanacak) ---
        function setupAllEventListeners() {
            if(themeToggleBtn) themeToggleBtn.addEventListener('click', () => { 
                if (document.documentElement.classList.contains('dark')) { document.documentElement.classList.remove('dark'); themeToggleBtn.textContent = 'üåô'; localStorage.setItem('theme', 'light'); }
                else { document.documentElement.classList.add('dark'); themeToggleBtn.textContent = '‚òÄÔ∏è'; localStorage.setItem('theme', 'dark'); }
                drawCanvasStats(); drawReportChart();
            }); 

            if(tabButtons) tabButtons.forEach(button => { button.addEventListener('click', () => { showScreen(button.dataset.tab); }); });
            
            if(taxSlider) taxSlider.addEventListener('input', () => { if(taxSliderValue) taxSliderValue.textContent = taxSlider.value; });
            if(applyTaxBtn) applyTaxBtn.addEventListener('click', () => {
                const newTaxRate = parseFloat(taxSlider.value); const oldTaxes = taxes; taxes = newTaxRate; const change = newTaxRate - oldTaxes;
                if(taxRateEl) taxRateEl.textContent = taxes.toFixed(1); let taxMessage = "";
                if (change > 0) { taxMessage = `Vergileri %${taxes.toFixed(1)} oranƒ±na y√ºkselttiniz.`; weeklySatisfactionChange -= change * 2.8; weeklyPoliticalStabilityChange -= change * 0.5; if (taxes > 20) taxMessage += " Halk arasƒ±nda b√ºy√ºk ho≈ünutsuzluk var!"; addLog(taxMessage, 'warning');}
                else if (change < 0) { taxMessage = `Vergileri %${taxes.toFixed(1)} oranƒ±na d√º≈ü√ºrd√ºn√ºz.`; weeklySatisfactionChange -= change * 2.0; weeklyPoliticalStabilityChange -= change * 0.2; if (taxes < 8) taxMessage += " B√ºt√ße gelirlerinde ciddi d√º≈ü√º≈ü bekleniyor."; addLog(taxMessage, 'info');}
                updateGameStats();
            });

            setupInvestmentButtons('economy-investment', 'decrease-economy-investment', 'increase-economy-investment', 1, 100);
            setupInvestmentButtons('education-investment', 'decrease-education-investment', 'increase-education-investment', 1, 50);
            setupInvestmentButtons('health-investment', 'decrease-health-investment', 'increase-health-investment', 1, 50);
            setupInvestmentButtons('culture-investment', 'decrease-culture-investment', 'increase-culture-investment', 1, 30);
            setupInvestmentButtons('police-budget', 'decrease-police-budget', 'increase-police-budget', 1, 20);
            setupInvestmentButtons('recruit-soldiers-input', 'decrease-recruits', 'increase-recruits', 1, 50);

            if(investEconomyBtn) investEconomyBtn.addEventListener('click', () => { const amount = parseInt(economyInvestmentInput.value); makeInvestment('Ekonomi', amount, 0.12, 0.06, 0.15, cabinet.economy); updateGameStats(); });
            if(investEducationBtn) investEducationBtn.addEventListener('click', () => { const amount = parseInt(educationInvestmentInput.value); if(makeInvestment('Eƒüitim', amount, 0.01, 0.005, 0.6, cabinet.education)) educationSpending += amount * 1000000 * cabinet.education.efficiency; updateGameStats(); });
            if(investHealthBtn) investHealthBtn.addEventListener('click', () => { const amount = parseInt(healthInvestmentInput.value); if(makeInvestment('Saƒülƒ±k', amount, 0.015, 0.007, 0.75, cabinet.health)) healthSpending += amount*1000000*cabinet.health.efficiency; updateGameStats(); });
            if(promoteCultureBtn) promoteCultureBtn.addEventListener('click', () => { const amount = parseInt(cultureInvestmentInput.value); if(makeInvestment('K√ºlt√ºr', amount, 0.005, 0.002, 0.35, cabinet.economy)) cultureSpending += amount*1000000; updateGameStats(); });
            if(increasePoliceBudgetBtnApply) increasePoliceBudgetBtnApply.addEventListener('click', () => { const amount = parseInt(policeBudgetInput.value) * 1000000; if(budget >= amount) { budget -= amount; weeklyCrimeRateChange -= 0.3 * (amount / 3000000) * cabinet.interior.efficiency; weeklySecurityPerceptionChange += 1.5 * (amount / 3000000) * cabinet.interior.efficiency; addLog(`Polis b√ºt√ßesine $${(amount/1000000).toLocaleString()}M yatƒ±rƒ±m yapƒ±ldƒ±.`, 'info');} else { addLog(`Polis b√ºt√ßesi i√ßin yeterli kaynak yok!`, 'warning');} updateGameStats();});


            if(investGreenEnergyBtn) investGreenEnergyBtn.addEventListener('click', () => { const cost = 20000000; if (budget >= cost) { budget -= cost; addLog("Ye≈üil enerji i√ßin 20M$ yatƒ±rƒ±m paketi a√ßƒ±klandƒ±.", "success"); weeklySatisfactionChange += 3; weeklyForeignRelationsChange += 2; weeklyInflationChange -= 0.15; weeklyPoliticalStabilityChange +=1; if(Math.random() < cabinet.economy.efficiency - 0.3) { addLog("Ye≈üil enerji yatƒ±rƒ±mƒ± uluslararasƒ± takdir topladƒ±!", "success"); weeklyGdpChangeFactor *= 1.002;}} else { addLog("Ye≈üil enerji i√ßin b√ºt√ße yok.", "warning"); } updateGameStats(); });
            if(developDefenseIndustryBtn) developDefenseIndustryBtn.addEventListener('click', () => { const cost = 50000000; if (budget >= cost) { budget -= cost; addLog("Savunma sanayii geli≈ütirme projesi ba≈ülatƒ±ldƒ± (50M$).", "info"); let strGain = Math.max(1, 5 + Math.floor(cabinet.defense.efficiency * 5 - cabinet.defense.corruption * 8)); weeklyMilitaryStrengthChange += strGain; weeklyGdpChangeFactor *= (1 + 0.001 * cabinet.defense.efficiency); weeklyForeignRelationsChange -= (2 - diplomaticApproachLevel * 0.2); weeklyArmyLoyaltyChange += Math.max(0, Math.floor((cabinet.defense.efficiency - cabinet.defense.corruption - 0.3)*5)); if(strGain < 2) addLog("Ancak, yolsuzluk projeden beklenen faydayƒ± azalttƒ±.", "danger");} else { addLog("Savunma sanayii i√ßin b√ºt√ße yok.", "warning"); } updateGameStats(); });

            if(socialPolicySlider) socialPolicySlider.addEventListener('input', () => { if(socialPolicyValue) socialPolicyValue.textContent = socialPolicySlider.value; });
            if(applySocialPolicyBtn) applySocialPolicyBtn.addEventListener('click', () => { const newL = parseInt(socialPolicySlider.value); const chg = newL - socialPolicyLevel; socialPolicyLevel = newL; if (chg > 0) { addLog(`Sosyal politikalar ${newL}. seviyeye geni≈ületildi.`, 'info'); weeklySatisfactionChange += chg * 0.8; weeklyBudgetChange -= chg * 700000; weeklyPoliticalStabilityChange += chg * 0.2;} else if (chg < 0) { addLog(`Sosyal politikalar ${newL}. seviyeye daraltƒ±ldƒ±.`, 'warning'); weeklySatisfactionChange += chg * 1.5; weeklyBudgetChange -= chg * 700000; weeklyPoliticalStabilityChange += chg * 0.3;} updateGameStats(); });
            
            if(economicPolicySlider) economicPolicySlider.addEventListener('input', () => { if(economicPolicyValue) economicPolicyValue.textContent = economicPolicySlider.value; });
            if(applyEconomicPolicyBtn) applyEconomicPolicyBtn.addEventListener('click', () => { const newL = parseInt(economicPolicySlider.value); const chg = newL - economicPolicyLevel; economicPolicyLevel = newL; if (chg > 0) { addLog(`Ekonomi politikalarƒ± ${newL}. seviyeye getirildi (Geni≈ülemeci).`, 'info'); weeklyGdpChangeFactor *= (1 + (chg * 0.003 * cabinet.economy.efficiency)); weeklyInflationChange += chg * 0.15 * (1.5 - cabinet.economy.efficiency);} else if (chg < 0) { addLog(`Ekonomi politikalarƒ± ${newL}. seviyeye getirildi (Daraltƒ±cƒ±).`, 'warning'); weeklyGdpChangeFactor *= (1 + (chg * 0.002 / (cabinet.economy.efficiency || 0.1) )); weeklyInflationChange += chg * 0.12 * cabinet.economy.efficiency;} updateGameStats(); });

            if(diplomaticApproachSlider) diplomaticApproachSlider.addEventListener('input', () => { if(diplomaticApproachValue) diplomaticApproachValue.textContent = diplomaticApproachSlider.value; });
            if(applyDiplomaticApproachBtn) applyDiplomaticApproachBtn.addEventListener('click', () => { const newL = parseInt(diplomaticApproachSlider.value); const chg = newL - diplomaticApproachLevel; diplomaticApproachLevel = newL; let msg = `Diplomatik yakla≈üƒ±m ${newL}. seviyeye ayarlandƒ±. `; if (chg > 0) { msg += "ƒ∞li≈ükilerde iyile≈üme bekleniyor."; weeklyForeignRelationsChange += chg * 0.8; for (const cN in countries) { countries[cN].relation = Math.min(100, countries[cN].relation + (chg * (0.3 + Math.random()*0.4)));}} else if (chg < 0) { msg += "Gerginlikler artabilir."; weeklyForeignRelationsChange += chg * 1.2; for (const cN in countries) { countries[cN].relation = Math.max(0, countries[cN].relation + (chg * (0.4 + Math.random()*0.5)));} if(newL < 3 && Math.random() < 0.3) { let rC = Object.keys(countries)[Math.floor(Math.random()*Object.keys(countries).length)]; countries[rC].relation = Math.max(0, countries[rC].relation - 15); msg += ` ${rC} sert tutumunuzdan dolayƒ± b√ºy√ºkel√ßisini geri √ßaƒüƒ±rdƒ±!`; weeklyForeignRelationsChange -=5;}} addLog(msg, chg > 0 ? 'info' : 'warning'); updateForeignRelationsDisplay(); updateGameStats(); });
            
            if(securityLevelSlider) securityLevelSlider.addEventListener('input', () => { if(securityLevelValue) securityLevelValue.textContent = securityLevelSlider.value; });
            if(applySecurityLevelBtn) applySecurityLevelBtn.addEventListener('click', () => { const newL = parseInt(securityLevelSlider.value); const chg = newL - securityLevel; securityLevel = newL; let slMsg = `ƒ∞√ß g√ºvenlik (polisaj) seviyesi ${newL}. seviyeye ayarlandƒ±. `; if (chg > 0) { slMsg += "Su√ßlarda d√º≈ü√º≈ü bekleniyor."; weeklyCrimeRateChange -= chg * 0.3; weeklySecurityPerceptionChange += chg * 0.7; if (securityLevel > 8 && governmentType === 'Demokrasi') { slMsg += " Ancak bu durum √∂zg√ºrl√ºkleri kƒ±sƒ±tladƒ±ƒüƒ± i√ßin tepki √ßekebilir."; weeklySatisfactionChange -= (securityLevel - 8) * 0.6; weeklyPoliticalStabilityChange -= (securityLevel-8) * 0.3;}} else if (chg < 0) { slMsg += "√ñzg√ºrl√ºkler geni≈üleyebilir ancak su√ßlar artabilir."; weeklyCrimeRateChange -= chg * 0.4; weeklySecurityPerceptionChange += chg * 0.9; } addLog(slMsg, 'info'); updateGameStats(); });

            if(mediaFreedomSlider) mediaFreedomSlider.addEventListener('input', () => { if(mediaFreedomTargetValueEl) mediaFreedomTargetValueEl.textContent = mediaFreedomSlider.value; });
            if(applyMediaPolicyBtn) applyMediaPolicyBtn.addEventListener('click', () => { const targetF = parseFloat(mediaFreedomSlider.value); let chgDir = (targetF > mediaFreedom) ? "artƒ±rma" : "azaltma"; addLog(`Medya √∂zg√ºrl√ºƒü√º politikasƒ±nƒ± ${targetF}/10 seviyesine ${chgDir} y√∂n√ºnde deƒüi≈ütirdiniz.`, 'info'); weeklyMediaFreedomChange += (targetF - mediaFreedom) * 0.3; if(governmentType === 'Diktat√∂rl√ºk' && targetF > 3) { addLog("Diktat√∂rl√ºkte medya √∂zg√ºrl√ºƒü√ºn√º artƒ±rmak riskli olabilir!", "warning"); weeklyPoliticalStabilityChange -=2;} });
            if(startPropagandaBtn) startPropagandaBtn.addEventListener('click', () => { const cost = 5000000; if (budget < cost) { addLog("Propaganda i√ßin b√ºt√ße yetersiz.", "warning"); return; } if (propagandaEffectWeeks > 0) { addLog("Aktif propaganda kampanyasƒ± var.", "warning"); return; } budget -= cost; propagandaEffectWeeks = 4; mediaInfluence = Math.min(100, mediaInfluence + 5); addLog("Devlet propaganda kampanyasƒ± ba≈ülatƒ±ldƒ± (4 Hafta Etkili).", "success"); if (mediaFreedom > 6 && governmentType === 'Demokrasi'){ addLog("√ñzg√ºr basƒ±n kampanyayƒ± ele≈ütiriyor.", "warning"); weeklySatisfactionChange -=1; } updateGameStats(); });
            if(applyCensorshipBtn) applyCensorshipBtn.addEventListener('click', () => { let freedomRed = 0; if (governmentType === 'Demokrasi' && mediaFreedom > 4) { addLog("Demokratik √ºlkede aƒüƒ±r sans√ºr anayasal krize yol a√ßabilir!", "danger"); weeklyPoliticalStabilityChange -= 5; weeklySatisfactionChange -= 3; freedomRed = (Math.random() < 0.2) ? 0.5 : (1 + Math.random());} else { freedomRed = 1.5 + Math.random()*1.5;} weeklyMediaFreedomChange -= freedomRed; addLog(`Medya √ºzerinde sans√ºr artƒ±rƒ±ldƒ±.`, "danger"); weeklySatisfactionChange -= 2; weeklyForeignRelationsChange -= 1; weeklyPoliticalStabilityChange += (governmentType === 'Diktat√∂rl√ºk' ? 2 : 0.5); mediaInfluence = Math.max(30, mediaInfluence - 5); });

            if(declareHolidayBtn) declareHolidayBtn.addEventListener('click', () => { const cost = 2000000; if (budget >= cost) { budget -= cost; nationalHolidays++; weeklySatisfactionChange += (5 - nationalHolidays*0.5); weeklyGdpChangeFactor *= 0.998; addLog(`Yeni bir resmi tatil ilan edildi (${nationalHolidays}. tatil)!`, 'success');} else { addLog(`Tatil i√ßin b√ºt√ße yok!`, 'warning'); } updateGameStats();});
            if(callElectionsBtn) callElectionsBtn.addEventListener('click', () => { if (governmentType === 'Demokrasi' || governmentType === 'Otoriter Demokrasi') { if (politicalStability < 40 && satisfaction < 40 && governmentType === 'Demokrasi') { addLog('Erken se√ßim i√ßin ortam gergin!', 'danger'); weeklyPoliticalStabilityChange -=10; weeklySatisfactionChange -=5; if(Math.random() < 0.3) { gameOver("Erken se√ßim kaos yarattƒ±.", "civil_war"); return;}} const cost = 10000000; if (budget < cost) { addLog("Erken se√ßim i√ßin b√ºt√ße yok!", "warning"); return;} budget -= cost; addLog('Erken se√ßim kararƒ± aldƒ±nƒ±z!', 'event'); politicalStability = Math.max(0, politicalStability - 5 - Math.floor(Math.random()*5)); setTimeout(() => conductElections(), 2000 ); } else { addLog(`${governmentType} tipinde erken se√ßim olmaz!`, 'danger'); }});
            if(proposeLawBtn) proposeLawBtn.addEventListener('click', () => { const pText = proposalInput.value.trim(); if (pText === '') { addLog('Ge√ßerli yasa teklifi girin.', 'warning'); return; } if (governmentType === 'Diktat√∂rl√ºk') { addLog(`Kararname: "${pText}".`, 'info'); weeklySatisfactionChange += (Math.random()-0.5)*4; proposalInput.value = ''; updateGameStats(); return;} let pop = (Math.random() - 0.3) * 10; parliamentAgenda.push({ description: pText, rejectionCount: 0, onApprove: () => { addLog(`"${pText}" yasasƒ± onaylandƒ±!`, 'success'); weeklySatisfactionChange += 2 + pop/2; parliamentSupport = Math.min(100, parliamentSupport + 4 + pop/3); weeklyPoliticalStabilityChange += 1 + pop/5; }, onReject: () => { weeklySatisfactionChange -= (1 - pop/3); weeklyPoliticalStabilityChange -= (1 - pop/4); }}); addLog(`"${pText}" yasa teklifi meclise sunuldu.`, 'info'); proposalInput.value = ''; updateParliamentDisplay();});
            if(declareDictatorshipBtn) declareDictatorshipBtn.addEventListener('click', () => { if (governmentType === 'Demokrasi' || governmentType === 'Otoriter Demokrasi') { addLog("Diktat√∂rl√ºk ilan etme giri≈üimi...", "event"); if (armyLoyalty < 60 && politicalStability > 40 && governmentType === 'Demokrasi') { addLog('Ordu emre uymadƒ±! Giri≈üim ba≈üarƒ±sƒ±z oldu!', 'danger'); weeklySatisfactionChange -= 25; parliamentSupport = Math.max(0, parliamentSupport - 30); politicalStability = Math.max(0, politicalStability - 40); if(politicalStability < 10) gameOver("Ba≈üarƒ±sƒ±z diktat√∂rl√ºk giri≈üimi sonrasƒ± kaos.", "civil_war"); return;} if (satisfaction > 50 && politicalStability > 50 && governmentType === 'Demokrasi') { addLog('Halk demokrasiye baƒülƒ±. Giri≈üim tepki √ßekti!', 'danger'); weeklySatisfactionChange -= 20; weeklyPoliticalStabilityChange -= 30; return;} addLog('Diktat√∂rl√ºƒü√ºn√ºz√º ilan ettiniz!', 'danger'); governmentType = 'Diktat√∂rl√ºk'; weeklySatisfactionChange -= 35; weeklyForeignRelationsChange -= 50; parliamentSupport = 100; politicalStability = Math.min(60, politicalStability + 10); weeklyCrimeRateChange -= crimeRate * 0.6; weeklySecurityPerceptionChange += 30; weeklyArmyLoyaltyChange += 15; Object.keys(countries).forEach(cn => { if(countries[cn].relation > 40) countries[cn].relation = Math.max(0, countries[cn].relation - 20 - Math.floor(Math.random()*15)); }); updateForeignRelationsDisplay();} else { addLog('Zaten diktat√∂rs√ºn√ºz!', 'warning'); } updateGameStats(); enableAllActionButtons(); });
            if(dissolveParliamentBtn) dissolveParliamentBtn.addEventListener('click', () => { if (governmentType === 'Demokrasi' || governmentType === 'Otoriter Demokrasi') { addLog("Meclisi feshetme kararƒ±...", "event"); if (parliamentSupport > 30 && politicalStability > 40 && armyLoyalty > 50 && governmentType === 'Demokrasi') { addLog('Giri≈üim ordu ve yargƒ± tarafƒ±ndan engellendi!', 'danger'); weeklySatisfactionChange -= 15; parliamentSupport = Math.max(0, parliamentSupport - 20); politicalStability = Math.max(0, politicalStability - 25); if(politicalStability < 15) gameOver("Anayasal kriz.", "civil_war"); return;} addLog('Meclisi feshettiniz! √úlke otoriter y√∂netime kayƒ±yor.', 'danger'); weeklySatisfactionChange -= 30; governmentType = 'Diktat√∂rl√ºk'; parliamentSupport = 0; politicalStability = Math.max(10, politicalStability - 20 + (armyLoyalty > 70 ? 10 : -5)); parliamentAgenda.length = 0; updateParliamentDisplay();} else { addLog('Mevcut rejimde meclis feshedilemez.', 'warning'); } updateGameStats(); enableAllActionButtons();});
            if(meetOppositionClosedBtn) meetOppositionClosedBtn.addEventListener('click', () => { handleOppositionMeeting(true, true); });
            if(meetOppositionOpenBtn) meetOppositionOpenBtn.addEventListener('click', () => { handleOppositionMeeting(true, false); });
            
            if(recruitSoldiersBtn) recruitSoldiersBtn.addEventListener('click', () => { const numR = parseInt(recruitSoldiersInput.value) * 1000; const costPT = 1000000 + (population - armySize*100 < 5000000 ? 200000 : 0) ; const totalC = (numR / 1000) * costPT; if (population < armySize + numR + 2000000) { addLog("Yeterli gen√ß n√ºfus yok!", "warning"); return;} if (budget >= totalC) { budget -= totalC; armySize += numR; weeklyMilitaryStrengthChange += numR / 25000 * (cabinet.defense.efficiency*1.2); addLog(`${numR.toLocaleString()} asker orduya katƒ±ldƒ±.`, 'info'); weeklySatisfactionChange -= numR / population * 60; weeklyArmyLoyaltyChange -= numR / population * 30; } else { addLog(`Asker alƒ±mƒ± i√ßin b√ºt√ße yok.`, 'warning'); } updateGameStats(); });
            if(planWarBtn) planWarBtn.addEventListener('click', () => { const cost = 5000000; if (budget >= cost) { budget -= cost; let planQ = Math.floor(cabinet.defense.efficiency * 5) - Math.floor(cabinet.defense.corruption*3) + Math.floor(Math.random()*3); addLog(`Genelkurmay ${planQ} kalite puanƒ±nda operasyon planlarƒ± hazƒ±rladƒ±.`, "info"); weeklyMilitaryStrengthChange += Math.max(0, planQ/2); if (planQ < 2) addLog("Planlarƒ±n kalitesi d√º≈ü√ºk!", "danger");} else { addLog("Sava≈ü planlamasƒ± i√ßin b√ºt√ße yok.", "warning");} updateGameStats(); });
            if(militaryExerciseBtn) militaryExerciseBtn.addEventListener('click', () => { const cost = 10000000 + Math.floor(armySize / 8000 * 700000); if (budget >= cost) { budget -= cost; let exSuccess = Math.random() < (cabinet.defense.efficiency - cabinet.defense.corruption*1.5 + 0.2); if(exSuccess){ addLog("Askeri tatbikat ba≈üarƒ±yla tamamlandƒ±.", "success"); weeklyMilitaryStrengthChange += (4 + Math.floor(cabinet.defense.efficiency * 3)); weeklyArmyLoyaltyChange += (5 + Math.floor(cabinet.defense.efficiency * 5));} else { addLog("Tatbikatta kaza! Ekipman hasar g√∂rd√º.", "danger"); weeklyMilitaryStrengthChange -= 2; weeklyArmyLoyaltyChange -= 8; budget -= cost * 0.2;} Object.keys(countries).forEach(cN => { if(countries[cN].relation < 40 && diplomaticApproachLevel < 5 && Math.random() < 0.4){ countries[cN].relation = Math.max(0, countries[cN].relation - (6 - diplomaticApproachLevel)); addLog(`${cN}, tatbikatƒ± tehdit olarak algƒ±ladƒ±!`, 'warning'); weeklyForeignRelationsChange -=1;}}); updateForeignRelationsDisplay();} else { addLog("Askeri tatbikat i√ßin b√ºt√ße yok.", "warning");} updateGameStats(); });
            if(militaryCouncilMeetingBtn) militaryCouncilMeetingBtn.addEventListener('click', () => { const cost = 1000000; if (budget >= cost) { budget -= cost; let adv = "Askeri ≈ûura toplandƒ±: "; let advT = 'info'; if (armyLoyalty < 30) { adv += "Ordu i√ßinde huzursuzluk b√ºy√ºk! ACƒ∞L √ñNLEM ALINMAZSA DARBE KA√áINILMAZ!"; advT = 'danger'; weeklyPoliticalStabilityChange -=5;} else if (militaryStrengthIndex < 30 && foreignRelationsScore < 30) { adv += "Savunma kapasitemiz zayƒ±f ve dƒ±≈ü tehditler artƒ±yor!"; advT = 'danger';} else if (politicalStability < 30 && armyLoyalty < 50) { adv += "Siyasi istikrarsƒ±zlƒ±k orduya yansƒ±yor!"; advT = 'danger';} else if (cabinet.defense.corruption > 0.25) { adv += `Savunma Bakanlƒ±ƒüƒ±'ndaki yolsuzluklar moral bozuyor!`; advT = 'warning'; weeklyArmyLoyaltyChange -=3;} else { adv += "Durum kontrol altƒ±nda."; weeklyMilitaryStrengthChange +=1; weeklyArmyLoyaltyChange +=1;} addLog(adv, advT);} else { addLog("Askeri ≈ûura i√ßin b√ºt√ße yok.", "warning");} updateGameStats(); });
            
            if(reformJusticeBtn) reformJusticeBtn.addEventListener('click', () => { const cost = 5000000; if (budget >= cost) { budget -= cost; let reformImp = (cabinet.justice.efficiency - cabinet.justice.corruption - 0.2) * 10; if (reformImp > 0) { addLog(`Adalet reformlarƒ± ba≈ülatƒ±ldƒ± (${reformImp.toFixed(1)} etki).`, 'success'); weeklyCrimeRateChange -= reformImp * 0.05; weeklySecurityPerceptionChange += reformImp * 0.15; weeklySatisfactionChange += reformImp * 0.1; weeklyPoliticalStabilityChange += reformImp * 0.08;} else { addLog(`Adalet reformu giri≈üimi etki yaratamadƒ±.`, 'warning'); weeklySatisfactionChange -=1;}} else { addLog(`Adalet reformu i√ßin b√ºt√ße yok!`, 'warning'); } updateGameStats(); });
            if(surveillanceProgramBtn) surveillanceProgramBtn.addEventListener('click', () => { const cost = 4000000; if (budget >= cost) { budget -= cost; addLog(`Geni≈ü √ßaplƒ± g√∂zetim programƒ± devrede.`, 'info'); weeklyCrimeRateChange -= 1.5; weeklySecurityPerceptionChange += 2; if(governmentType === 'Demokrasi'){ addLog("Ancak √∂zel hayatƒ±n gizliliƒüi tartƒ±≈ümalarƒ± alevlendi.", "warning"); weeklySatisfactionChange -= 7; weeklyPoliticalStabilityChange -=4; weeklyForeignRelationsChange -=2;} else { addLog("Rejimin kontrol√º arttƒ±.", "info"); politicalStability = Math.min(100, politicalStability + 3);}} else { addLog(`G√∂zetim i√ßin b√ºt√ße yok!`, 'warning'); } updateGameStats(); });
            if(crackdownDissentBtn) crackdownDissentBtn.addEventListener('click', () => { if (governmentType === 'Diktat√∂rl√ºk') { const cost = 2000000 + Math.floor(population * 0.00002 * (100-politicalStability)/20); if (budget >= cost) { budget -= cost; addLog(`Muhalif sesler sert√ße bastƒ±rƒ±ldƒ±.`, 'danger'); weeklySatisfactionChange -= (15 - armyLoyalty/10); weeklySecurityPerceptionChange += (10 - satisfaction/20); weeklyForeignRelationsChange -= (10 - diplomaticApproachLevel); politicalStability = Math.min(100, politicalStability + 5 + armyLoyalty/15); weeklyCrimeRateChange -= crimeRate * 0.3; weeklyArmyLoyaltyChange +=2;} else { addLog(`Bastƒ±rma i√ßin kaynak yok.`, 'warning');}} else { addLog(`Demokratik √ºlkede muhalefet bastƒ±rƒ±lamaz!`, 'danger'); weeklySatisfactionChange -= 15; parliamentSupport = Math.max(0, parliamentSupport - 20); politicalStability = Math.max(0, politicalStability - 25); if(politicalStability < 20) { gameOver("Anayasayƒ± √ßiƒünediniz.", "civil_war");}} updateGameStats(); });
            
            if(globalSummitBtn) globalSummitBtn.addEventListener('click', () => { const cost = 10000000; if (budget >= cost) { budget -= cost; let success = Math.random() < (diplomaticApproachLevel/10 + foreignRelationsScore/150 + cabinet.foreign.efficiency/2 - 0.2); if(success){ addLog(`Uluslararasƒ± zirvede √∂nemli anla≈ümalar imzaladƒ±nƒ±z.`, 'success'); weeklyForeignRelationsChange += (10 + Math.floor(diplomaticApproachLevel*1.5)); weeklySatisfactionChange += 4; weeklyGdpChangeFactor *= 1.001; weeklyPoliticalStabilityChange +=2;} else { addLog("Zirve beklenen etkiyi yaratmadƒ±.", "warning"); weeklyForeignRelationsChange +=2; weeklySatisfactionChange +=1;}} else { addLog(`Zirve i√ßin b√ºt√ße yetersiz!`, 'warning'); } updateGameStats(); });
            if(createSummitBtn) createSummitBtn.addEventListener('click', () => { if (summitPlanned) { addLog("Zaten zirve planlƒ±yorsunuz.", "warning"); return; } const cost = 15000000; if (budget >= cost) { budget -= cost; summitPlanned = true; summitInvitationsSent = false; for(const cN in countries) { countries[cN].summitInvited = false; countries[cN].summitAccepted = false; } addLog(`Ev sahipliƒüinizde zirve d√ºzenlemeye karar verdiniz.`, 'info'); updateSummitInvitationList(); createSummitBtn.disabled = true; sendSummitInvitationsBtn.disabled = false; } else { addLog("Zirve i√ßin b√ºt√ße yok.", "warning"); } updateGameStats(); });
            if(sendSummitInvitationsBtn) sendSummitInvitationsBtn.addEventListener('click', () => { if (!summitPlanned || summitInvitationsSent) return; const selected = getSelectedSummitInvitees(); if (selected.length === 0) { addLog("Davet i√ßin √ºlke se√ßin.", "warning"); return; } addLog(`${selected.join(', ')} √ºlkelerine davet g√∂nderildi.`, "info"); summitInvitationsSent = true; sendSummitInvitationsBtn.disabled = true; selected.forEach(cN => { const c = countries[cN]; const chance = c.relation + (diplomaticApproachLevel * 6) + foreignRelationsScore/4 - (25 - cabinet.foreign.efficiency*10) - (governmentType === 'Diktat√∂rl√ºk' ? 15 : 0) ; c.summitAccepted = Math.random() * 100 < chance; }); updateSummitInvitationList(); });
            if(signTradeDealBtn) signTradeDealBtn.addEventListener('click', () => { const cost = 3000000; if (budget >= cost) { budget -= cost; let bestC = null; let bestP = -1; for (const cN in countries) { const c = countries[cN]; if (!c.tradeDeal && c.relation > 30 && c.relation + foreignRelationsScore > 80) { const pot = c.relation + Math.random() * 40 +
